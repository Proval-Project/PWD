{"ast":null,"code":"import _objectSpread from\"/Users/simjimin/Downloads/final_develop/projec/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect,useCallback,useRef,useMemo}from'react';import{useNavigate,useParams}from'react-router-dom';import{getEstimateDetail,assignEstimate}from'../../api/estimateRequest';import'./DashboardPages.css';import'./EstimateDetailPage.css';// ë‹¨ìœ„/ì‚¬ì´ì¦ˆ ë§ˆìŠ¤í„° ë°ì´í„° íƒ€ìž…\nimport{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";// í¬ë¡œìŠ¤í”Œëž«í¼ ê²½ë¡œ ì²˜ë¦¬ë¥¼ ìœ„í•œ ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜\nconst isManagerFile=filePath=>{if(!filePath)return false;// Windowsì™€ Unix ê²½ë¡œ ëª¨ë‘ ì§€ì›\nconst normalizedPath=filePath.replace(/\\\\/g,'/');// Windows ë°±ìŠ¬ëž˜ì‹œë¥¼ ìŠ¬ëž˜ì‹œë¡œ ë³€í™˜\n// ë‹¤ì–‘í•œ ê²½ë¡œ íŒ¨í„´ ì§€ì›\nconst managerFilePatterns=['/ResultFiles/','\\\\ResultFiles\\\\','ResultFiles/','ResultFiles\\\\'];return managerFilePatterns.some(pattern=>normalizedPath.includes(pattern));};// ê²½ë¡œì—ì„œ managerFileType ì¶”ì¶œí•˜ëŠ” í¬ë¡œìŠ¤í”Œëž«í¼ í•¨ìˆ˜\nconst extractManagerFileType=filePath=>{if(!filePath)return null;const normalizedPath=filePath.replace(/\\\\/g,'/');const pathParts=normalizedPath.split('/');const resultFilesIndex=pathParts.findIndex(part=>part==='ResultFiles');if(resultFilesIndex!==-1&&resultFilesIndex+1<pathParts.length){return pathParts[resultFilesIndex+1];}return null;};// CustomerRequest íŒŒì¼ì¸ì§€ í™•ì¸í•˜ëŠ” í¬ë¡œìŠ¤í”Œëž«í¼ í•¨ìˆ˜ (í•˜ìœ„ ê³ ê°ìš”ì²­ ì²¨ë¶€ ì˜ì—­ì— ì‚¬ìš©)\nconst isCustomerFile=filePath=>{if(!filePath)return false;const normalizedPath=filePath.replace(/\\\\/g,'/');const customerFilePatterns=['/CustomerRequest/','\\\\CustomerRequest\\\\','CustomerRequest/','CustomerRequest\\\\'];return customerFilePatterns.some(pattern=>normalizedPath.includes(pattern));};// ResultFiles/customer íŒŒì¸ì§€ í™•ì¸ (ìƒë‹¨ \"ê³ ê° ì œì¶œ ë¬¸ì„œ ì—…ë¡œë“œ\" ì „ìš©)\nconst isResultCustomerFile=filePath=>{if(!filePath)return false;const normalizedPath=filePath.replace(/\\\\/g,'/').toLowerCase();return normalizedPath.includes('/resultfiles/customer/');};// ðŸ”‘ íŒŒì¼ ê´€ë ¨ íƒ€ìž… ì¶”ê°€\nconst EstimateDetailPage=()=>{const navigate=useNavigate();const{tempEstimateNo}=useParams();// ìƒíƒœ ê´€ë¦¬\nconst[types,setTypes]=useState([]);const[valves,setValves]=useState([]);const[selectedValve,setSelectedValve]=useState(null);const[selectedType,setSelectedType]=useState('');// ë§ˆìŠ¤í„° ë°ì´í„°\nconst[bodyValveList,setBodyValveList]=useState([]);const[bodySizeList,setBodySizeList]=useState([]);const[bodyMatList,setBodyMatList]=useState([]);const[trimMatList,setTrimMatList]=useState([]);const[trimOptionList,setTrimOptionList]=useState([]);const[bodyRatingList,setBodyRatingList]=useState([]);// Step 3 ë§ˆìŠ¤í„° ë°ì´í„°\nconst[bodyBonnetList,setBodyBonnetList]=useState([]);const[bodyConnectionList,setBodyConnectionList]=useState([]);const[trimTypeList,setTrimTypeList]=useState([]);const[trimSeriesList,setTrimSeriesList]=useState([]);const[trimPortSizeList,setTrimPortSizeList]=useState([]);const[trimFormList,setTrimFormList]=useState([]);const[actTypeList,setActTypeList]=useState([]);const[actSeriesList,setActSeriesList]=useState([]);const[actSizeList,setActSizeList]=useState([]);const[actHWList,setActHWList]=useState([]);const[accMakerList,setAccMakerList]=useState([]);const[accModelList,setAccModelList]=useState([]);const[accMakerListByType,setAccMakerListByType]=useState({});const[accModelListByType,setAccModelListByType]=useState({});// ê¸°íƒ€ ë°ì´í„°\nconst[customerRequirement,setCustomerRequirement]=useState('');// ê³ ê° ìš”ì²­ì‚¬í•­\nconst[staffComment,setStaffComment]=useState('');// ê´€ë¦¬ìž ì½”ë©˜íŠ¸\nconst[attachments,setAttachments]=useState([]);const[customerAttachments,setCustomerAttachments]=useState([]);// ê³ ê° ìš”ì²­ ì²¨ë¶€íŒŒì¼\nconst[managerAttachments,setManagerAttachments]=useState([]);// ê´€ë¦¬ ì²¨ë¶€íŒŒì¼\nconst[currentStatus,setCurrentStatus]=useState('ê²¬ì ìš”ì²­');const[isReadOnly,setIsReadOnly]=useState(false);// ì½ê¸° ì „ìš© ìƒíƒœ \n// ðŸ”‘ íŒŒì¼ ê´€ë¦¬ ìƒíƒœ ì¶”ê°€\nconst[managerFiles,setManagerFiles]=useState([]);const[customerFiles,setCustomerFiles]=useState([]);const[isLoadingFiles,setIsLoadingFiles]=useState(false);// ðŸ”‘ PDF ì—…ë¡œë“œ ê´€ë ¨ state ì¶”ê°€\nconst[selectedPdfFiles,setSelectedPdfFiles]=useState({datasheet:null,cvlist:null,vllist:null,singlequote:null,multiquote:null});// ðŸ”‘ PDF ë·°ì–´ë¥¼ ìœ„í•œ state ì¶”ê°€\nconst[uploadedPdfUrls,setUploadedPdfUrls]=useState({datasheet:null,cvlist:null,vllist:null,singlequote:null,multiquote:null});// ê²¬ì  ì‹œìž‘ ì—¬ë¶€(UI í† ê¸€)\nconst[quoteStarted,setQuoteStarted]=useState(false);// ì„œë¥˜ ë°œê¸‰ ìƒì„±/ë‹¤ìš´ë¡œë“œ ì§„í–‰ ìƒíƒœ\nconst[docGenerating,setDocGenerating]=useState({});// ìš”ì•½ì¹´ë“œ í‘œì‹œê°’ ìƒíƒœ\nconst[summaryEstimateNo,setSummaryEstimateNo]=useState('-');const[summaryCompanyName,setSummaryCompanyName]=useState('-');const[summaryRequesterName,setSummaryRequesterName]=useState('-');const[summaryRequestDate,setSummaryRequestDate]=useState('-');const[summaryManager,setSummaryManager]=useState('-');const[summaryCompletedDate,setSummaryCompletedDate]=useState('-');// ðŸ”‘ íŒŒì¼ ìž…ë ¥ ref ì¶”ê°€\nconst fileInputRefs=useRef({datasheet:null,cvlist:null,vllist:null,singlequote:null,multiquote:null});// ê³ ê° ì²¨ë¶€ ë‹¤ì¤‘ ì—…ë¡œë“œìš© ìƒíƒœ\nconst[selectedCustomerFiles,setSelectedCustomerFiles]=useState([]);const customerAddInputRef=useRef(null);// ACC ì„¹ì…˜ ì„ íƒ ìƒíƒœ ê´€ë¦¬\nconst[accSelections,setAccSelections]=useState({// ê° ì•…ì„¸ì‚¬ë¦¬ì˜ typeCodeë¥¼ í•˜ë“œì½”ë”©ëœ ê°’ìœ¼ë¡œ ì´ˆê¸°í™”\npositioner:{typeCode:'A',makerCode:'',modelCode:'',specification:''},solenoid:{typeCode:'B',makerCode:'',modelCode:'',specification:''},limiter:{typeCode:'C',makerCode:'',modelCode:'',specification:''},airSupply:{typeCode:'D',makerCode:'',modelCode:'',specification:''},volumeBooster:{typeCode:'E',makerCode:'',modelCode:'',specification:''},airOperator:{typeCode:'F',makerCode:'',modelCode:'',specification:''},lockUp:{typeCode:'G',makerCode:'',modelCode:'',specification:''},snapActingRelay:{typeCode:'H',makerCode:'',modelCode:'',specification:''}});// ëª¨ë“  ìƒíƒœ ë³€ìˆ˜ ì„ ì–¸ í›„, ë Œë”ë§ ì‹œ accSelections ìƒíƒœ ë¡œê¹…\n//console.log('EstimateDetailPage render - accSelections:', accSelections);\n// TagNoë³„ ì‚¬ìš©ìž ì„ íƒê°’ ìž„ì‹œ ì €ìž¥ (TagNo ë³€ê²½ ì‹œ ë³µì›ìš©)\nconst[tempSelections,setTempSelections]=useState({});// íŒŒì¼ ë‚´ í•¨ìˆ˜ë“¤ ì‚¬ì´ ì•„ë¬´ ê³³ì— ì¶”ê°€\nconst buildSaveSpecFromSelections=sel=>{var _sel$body,_sel$body2,_sel$body3,_sel$body4,_sel$body5,_sel$body6,_sel$body7,_sel$trim,_sel$trim2,_sel$trim3,_sel$trim4,_sel$trim5,_sel$trim6,_sel$trim7,_sel$trim8,_sel$act,_sel$act2,_sel$act3,_sel$act4,_sel$acc,_sel$acc$positioner,_sel$acc2,_sel$acc2$positioner,_sel$acc3,_sel$acc3$solenoid,_sel$acc4,_sel$acc4$solenoid,_sel$acc5,_sel$acc5$limiter,_sel$acc6,_sel$acc6$limiter,_sel$acc7,_sel$acc7$airSupply,_sel$acc8,_sel$acc8$airSupply,_sel$acc9,_sel$acc9$volumeBoost,_sel$acc0,_sel$acc0$volumeBoost,_sel$acc1,_sel$acc1$airOperator,_sel$acc10,_sel$acc10$airOperato,_sel$acc11,_sel$acc11$lockUp,_sel$acc12,_sel$acc12$lockUp,_sel$acc13,_sel$acc13$snapActing,_sel$acc14,_sel$acc14$snapActing;return{valveId:sel.valveTypeCode||'',body:{bonnetType:((_sel$body=sel.body)===null||_sel$body===void 0?void 0:_sel$body.bonnetType)||'',materialBody:((_sel$body2=sel.body)===null||_sel$body2===void 0?void 0:_sel$body2.materialBody)||'',rating:((_sel$body3=sel.body)===null||_sel$body3===void 0?void 0:_sel$body3.ratingCode)||'',ratingUnit:((_sel$body4=sel.body)===null||_sel$body4===void 0?void 0:_sel$body4.ratingUnitCode)||'',connection:((_sel$body5=sel.body)===null||_sel$body5===void 0?void 0:_sel$body5.connection)||'',sizeUnit:((_sel$body6=sel.body)===null||_sel$body6===void 0?void 0:_sel$body6.sizeBodyUnitCode)||'',size:((_sel$body7=sel.body)===null||_sel$body7===void 0?void 0:_sel$body7.sizeBodyCode)||''},trim:{type:((_sel$trim=sel.trim)===null||_sel$trim===void 0?void 0:_sel$trim.trimType)||'',series:((_sel$trim2=sel.trim)===null||_sel$trim2===void 0?void 0:_sel$trim2.trimSeries)||'',portSize:((_sel$trim3=sel.trim)===null||_sel$trim3===void 0?void 0:_sel$trim3.sizePortCode)||'',portSizeUnit:((_sel$trim4=sel.trim)===null||_sel$trim4===void 0?void 0:_sel$trim4.sizePortUnitCode)||'',form:((_sel$trim5=sel.trim)===null||_sel$trim5===void 0?void 0:_sel$trim5.formCode)||((_sel$trim6=sel.trim)===null||_sel$trim6===void 0?void 0:_sel$trim6.form)||'',materialTrim:((_sel$trim7=sel.trim)===null||_sel$trim7===void 0?void 0:_sel$trim7.materialTrim)||'',option:((_sel$trim8=sel.trim)===null||_sel$trim8===void 0?void 0:_sel$trim8.option)||''},actuator:{type:((_sel$act=sel.act)===null||_sel$act===void 0?void 0:_sel$act.actionType)||'',series:((_sel$act2=sel.act)===null||_sel$act2===void 0?void 0:_sel$act2.series)||'',size:((_sel$act3=sel.act)===null||_sel$act3===void 0?void 0:_sel$act3.size)||'',hw:((_sel$act4=sel.act)===null||_sel$act4===void 0?void 0:_sel$act4.hw)||''},accessories:{PosCode:((_sel$acc=sel.acc)===null||_sel$acc===void 0?void 0:(_sel$acc$positioner=_sel$acc.positioner)===null||_sel$acc$positioner===void 0?void 0:_sel$acc$positioner.modelCode)||null,PosMakerCode:((_sel$acc2=sel.acc)===null||_sel$acc2===void 0?void 0:(_sel$acc2$positioner=_sel$acc2.positioner)===null||_sel$acc2$positioner===void 0?void 0:_sel$acc2$positioner.makerCode)||null,SolCode:((_sel$acc3=sel.acc)===null||_sel$acc3===void 0?void 0:(_sel$acc3$solenoid=_sel$acc3.solenoid)===null||_sel$acc3$solenoid===void 0?void 0:_sel$acc3$solenoid.modelCode)||null,SolMakerCode:((_sel$acc4=sel.acc)===null||_sel$acc4===void 0?void 0:(_sel$acc4$solenoid=_sel$acc4.solenoid)===null||_sel$acc4$solenoid===void 0?void 0:_sel$acc4$solenoid.makerCode)||null,LimCode:((_sel$acc5=sel.acc)===null||_sel$acc5===void 0?void 0:(_sel$acc5$limiter=_sel$acc5.limiter)===null||_sel$acc5$limiter===void 0?void 0:_sel$acc5$limiter.modelCode)||null,LimMakerCode:((_sel$acc6=sel.acc)===null||_sel$acc6===void 0?void 0:(_sel$acc6$limiter=_sel$acc6.limiter)===null||_sel$acc6$limiter===void 0?void 0:_sel$acc6$limiter.makerCode)||null,ASCode:((_sel$acc7=sel.acc)===null||_sel$acc7===void 0?void 0:(_sel$acc7$airSupply=_sel$acc7.airSupply)===null||_sel$acc7$airSupply===void 0?void 0:_sel$acc7$airSupply.modelCode)||null,ASMakerCode:((_sel$acc8=sel.acc)===null||_sel$acc8===void 0?void 0:(_sel$acc8$airSupply=_sel$acc8.airSupply)===null||_sel$acc8$airSupply===void 0?void 0:_sel$acc8$airSupply.makerCode)||null,VolCode:((_sel$acc9=sel.acc)===null||_sel$acc9===void 0?void 0:(_sel$acc9$volumeBoost=_sel$acc9.volumeBooster)===null||_sel$acc9$volumeBoost===void 0?void 0:_sel$acc9$volumeBoost.modelCode)||null,VolMakerCode:((_sel$acc0=sel.acc)===null||_sel$acc0===void 0?void 0:(_sel$acc0$volumeBoost=_sel$acc0.volumeBooster)===null||_sel$acc0$volumeBoost===void 0?void 0:_sel$acc0$volumeBoost.makerCode)||null,AirOpCode:((_sel$acc1=sel.acc)===null||_sel$acc1===void 0?void 0:(_sel$acc1$airOperator=_sel$acc1.airOperator)===null||_sel$acc1$airOperator===void 0?void 0:_sel$acc1$airOperator.modelCode)||null,AirOpMakerCode:((_sel$acc10=sel.acc)===null||_sel$acc10===void 0?void 0:(_sel$acc10$airOperato=_sel$acc10.airOperator)===null||_sel$acc10$airOperato===void 0?void 0:_sel$acc10$airOperato.makerCode)||null,LockupCode:((_sel$acc11=sel.acc)===null||_sel$acc11===void 0?void 0:(_sel$acc11$lockUp=_sel$acc11.lockUp)===null||_sel$acc11$lockUp===void 0?void 0:_sel$acc11$lockUp.modelCode)||null,LockupMakerCode:((_sel$acc12=sel.acc)===null||_sel$acc12===void 0?void 0:(_sel$acc12$lockUp=_sel$acc12.lockUp)===null||_sel$acc12$lockUp===void 0?void 0:_sel$acc12$lockUp.makerCode)||null,SnapActCode:((_sel$acc13=sel.acc)===null||_sel$acc13===void 0?void 0:(_sel$acc13$snapActing=_sel$acc13.snapActingRelay)===null||_sel$acc13$snapActing===void 0?void 0:_sel$acc13$snapActing.modelCode)||null,SnapActMakerCode:((_sel$acc14=sel.acc)===null||_sel$acc14===void 0?void 0:(_sel$acc14$snapActing=_sel$acc14.snapActingRelay)===null||_sel$acc14$snapActing===void 0?void 0:_sel$acc14$snapActing.makerCode)||null}};};// í˜„ìž¬ ì„ íƒê°’ì„ tempSelectionsì— ì €ìž¥í•˜ëŠ” í•¨ìˆ˜\nconst saveCurrentSelections=sheetID=>{if(sheetID){setTempSelections(prev=>_objectSpread(_objectSpread({},prev),{},{[sheetID]:{body:_objectSpread({},bodySelections),trim:_objectSpread({},trimSelections),act:_objectSpread({},actSelections),acc:_objectSpread({},accSelections)}}));//console.log(`${sheetID}ì˜ ì„ íƒê°’ë“¤ì„ ìž„ì‹œ ì €ìž¥í–ˆìŠµë‹ˆë‹¤.`);\n}};// valve ì„ íƒ ì‹œ í˜¸ì¶œë˜ëŠ” í•¨ìˆ˜\nconst handleValveSelection=valve=>{// í˜„ìž¬ íƒœê·¸ì—ì„œ ë– ë‚˜ê¸° ì „, í˜„ìž¬ ì„ íƒê°’ ìž„ì‹œ ì €ìž¥\nif(selectedValve){setTempSelections(prev=>_objectSpread(_objectSpread({},prev),{},{[selectedValve.sheetID]:{body:_objectSpread({},bodySelections),trim:_objectSpread({},trimSelections),act:_objectSpread({},actSelections),acc:_objectSpread({},accSelections)}}));}setSelectedValve(valve);// ìƒˆ íƒœê·¸ì— ëŒ€í•´: ìž„ì‹œê°’ ìžˆìœ¼ë©´ ê·¸ê±¸ ë³µì›, ì—†ìœ¼ë©´ ì„œë²„ ì´ˆê¸°ê°’ ë¡œë“œ\nif(tempSelections[valve.sheetID]){const saved=tempSelections[valve.sheetID];// ë³µì›(ê° selections set í•¨ìˆ˜ í˜¸ì¶œ)\nsetBodySelections(saved.body||{});setTrimSelections(saved.trim||{});setActSelections(saved.act||{});setAccSelections(saved.acc||{});}else{loadInitialSpecification(valve.sheetID);}};const handleTypeSelection=type=>{setSelectedType(type.id);setSelectedValve(null);// Typeì„ ë³€ê²½í•˜ë©´ ì„ íƒëœ ValveëŠ” ì´ˆê¸°í™”ë©ë‹ˆë‹¤.\n};// Body ì„¹ì…˜ ì„ íƒ ìƒíƒœ ê´€ë¦¬\nconst[bodySelections,setBodySelections]=useState({bonnetType:'',bonnetTypeCode:'',// Code ê°’ ì¶”ê°€\nmaterialBody:'',materialBodyCode:'',// Code ê°’ ì¶”ê°€\nsizeBodyUnit:'',sizeBody:'',sizeBodyUnitCode:'',// Code ê°’ ì¶”ê°€\nsizeBodyCode:'',// Code ê°’ ì¶”ê°€\nratingUnit:'',rating:'',ratingUnitCode:'',// Code ê°’ ì¶”ê°€\nratingCode:'',// Code ê°’ ì¶”ê°€\nconnection:'',connectionCode:''// Code ê°’ ì¶”ê°€\n});// Trim ì„¹ì…˜ ì„ íƒ ìƒíƒœ ê´€ë¦¬\nconst[trimSelections,setTrimSelections]=useState({trimType:'',trimTypeCode:'',// Code ê°’ ì¶”ê°€\ntrimSeries:'',trimSeriesCode:'',// Code ê°’ ì¶”ê°€\nmaterialTrim:'',materialTrimCode:'',// Code ê°’ ì¶”ê°€\nsizePortUnit:'',sizePort:'',sizePortUnitCode:'',// Code ê°’ ì¶”ê°€\nsizePortCode:'',// Code ê°’ ì¶”ê°€\nform:'',formCode:'',// Code ê°’ ì¶”ê°€\noption:''// Trim Option í•„ë“œ ì¶”ê°€\n});// ACT ì„¹ì…˜ ì„ íƒ ìƒíƒœ ê´€ë¦¬\nconst[actSelections,setActSelections]=useState({actionType:'',actionTypeCode:'',// Code ê°’ ì¶”ê°€\nseries:'',seriesCode:'',// Code ê°’ ì¶”ê°€\nsize:'',sizeCode:'',// Code ê°’ ì¶”ê°€\nhw:'',hwCode:''// Code ê°’ ì¶”ê°€\n});// íƒœê·¸ë³„ ìƒíƒœ ì´ˆê¸°ê°’ê³¼ ë§µ ìƒíƒœ\nconst INITIAL_BODY={bonnetType:'',bonnetTypeCode:'',materialBody:'',materialBodyCode:'',sizeBodyUnit:'',sizeBody:'',sizeBodyUnitCode:'',sizeBodyCode:'',ratingUnit:'',rating:'',ratingUnitCode:'',ratingCode:'',connection:'',connectionCode:''};const INITIAL_TRIM={trimType:'',trimTypeCode:'',trimSeries:'',trimSeriesCode:'',materialTrim:'',materialTrimCode:'',sizePortUnit:'',sizePort:'',sizePortUnitCode:'',sizePortCode:'',form:'',formCode:'',option:''};const INITIAL_ACT={actionType:'',actionTypeCode:'',series:'',seriesCode:'',size:'',sizeCode:'',hw:'',hwCode:''};const INITIAL_ACC={positioner:{typeCode:'',makerCode:'',modelCode:'',specification:''},solenoid:{typeCode:'',makerCode:'',modelCode:'',specification:''},limiter:{typeCode:'',makerCode:'',modelCode:'',specification:''},airSupply:{typeCode:'',makerCode:'',modelCode:'',specification:''},volumeBooster:{typeCode:'',makerCode:'',modelCode:'',specification:''},airOperator:{typeCode:'',makerCode:'',modelCode:'',specification:''},lockUp:{typeCode:'',makerCode:'',modelCode:'',specification:''},snapActingRelay:{typeCode:'',makerCode:'',modelCode:'',specification:''}};const[bodySelectionsBySheet,setBodySelectionsBySheet]=useState({});const[trimSelectionsBySheet,setTrimSelectionsBySheet]=useState({});const[actSelectionsBySheet,setActSelectionsBySheet]=useState({});const[accSelectionsBySheet,setAccSelectionsBySheet]=useState({});// íƒœê·¸ ì „í™˜ ì‹œ í•´ë‹¹ íƒœê·¸ì˜ ìƒíƒœë¥¼ ì‹±ê¸€ ìƒíƒœë¡œ ë™ê¸°í™”\nuseEffect(()=>{var _bodySelectionsByShee,_trimSelectionsByShee,_actSelectionsBySheet,_accSelectionsBySheet;const sid=selectedValve===null||selectedValve===void 0?void 0:selectedValve.sheetID;if(!sid)return;setBodySelections((_bodySelectionsByShee=bodySelectionsBySheet[sid])!==null&&_bodySelectionsByShee!==void 0?_bodySelectionsByShee:INITIAL_BODY);setTrimSelections((_trimSelectionsByShee=trimSelectionsBySheet[sid])!==null&&_trimSelectionsByShee!==void 0?_trimSelectionsByShee:INITIAL_TRIM);setActSelections((_actSelectionsBySheet=actSelectionsBySheet[sid])!==null&&_actSelectionsBySheet!==void 0?_actSelectionsBySheet:INITIAL_ACT);setAccSelections((_accSelectionsBySheet=accSelectionsBySheet[sid])!==null&&_accSelectionsBySheet!==void 0?_accSelectionsBySheet:INITIAL_ACC);},[selectedValve===null||selectedValve===void 0?void 0:selectedValve.sheetID,bodySelectionsBySheet,trimSelectionsBySheet,actSelectionsBySheet,accSelectionsBySheet]);// selectedValve ë³€ê²½ ì‹œ í•´ë‹¹ TAGì˜ ë°ì´í„° ë¡œë“œ\nuseEffect(()=>{var _bodySelectionsByShee2,_trimSelectionsByShee2,_actSelectionsBySheet2,_accSelectionsBySheet2;const sid=selectedValve===null||selectedValve===void 0?void 0:selectedValve.sheetID;if(!sid)return;// í•´ë‹¹ TAGì˜ ë°ì´í„° ë¡œë“œ\nsetBodySelections((_bodySelectionsByShee2=bodySelectionsBySheet[sid])!==null&&_bodySelectionsByShee2!==void 0?_bodySelectionsByShee2:INITIAL_BODY);setTrimSelections((_trimSelectionsByShee2=trimSelectionsBySheet[sid])!==null&&_trimSelectionsByShee2!==void 0?_trimSelectionsByShee2:INITIAL_TRIM);setActSelections((_actSelectionsBySheet2=actSelectionsBySheet[sid])!==null&&_actSelectionsBySheet2!==void 0?_actSelectionsBySheet2:INITIAL_ACT);setAccSelections((_accSelectionsBySheet2=accSelectionsBySheet[sid])!==null&&_accSelectionsBySheet2!==void 0?_accSelectionsBySheet2:INITIAL_ACC);// ì•¡íŠ¸ ì‹œë¦¬ì¦ˆê°€ ìžˆìœ¼ë©´ ì‚¬ì´ì¦ˆ ëª©ë¡ ê°€ì ¸ì˜¤ê¸°\nconst currentActSelections=actSelectionsBySheet[sid];if(currentActSelections!==null&&currentActSelections!==void 0&&currentActSelections.series){fetchActSizeList(currentActSelections.series);}else{setActSizeList([]);}},[selectedValve===null||selectedValve===void 0?void 0:selectedValve.sheetID,bodySelectionsBySheet,trimSelectionsBySheet,actSelectionsBySheet,accSelectionsBySheet]);// ìƒíƒœ ë° í”„ë¡œì íŠ¸ ì •ë³´\nconst[projectName,setProjectName]=useState('');// BodyValveList ê°€ì ¸ì˜¤ê¸°\nconst fetchBodyValveList=async()=>{try{const response=await fetch('http://192.168.0.14:5135/api/estimate/body-valve-list');if(!response.ok){console.error('body-valve-list ìš”ì²­ ì‹¤íŒ¨:',response.status,response.statusText);setBodyValveList([]);return;}const data=await response.json();setBodyValveList(data!==null&&data!==void 0?data:[]);}catch(error){console.error('BodyValveList ê°€ì ¸ì˜¤ê¸° ì‹¤íŒ¨:',error);}};// ACT Size ëª©ë¡ ê°€ì ¸ì˜¤ê¸°\nconst fetchActSizeList=async actSeriesCode=>{try{console.log('fetchActSizeList ì‹œìž‘:',actSeriesCode);const response=await fetch(\"http://192.168.0.14:5135/api/masterdata/act/size?actSeriesCode=\".concat(actSeriesCode));const data=await response.json();console.log('ACT Size API ì‘ë‹µ:',data);setActSizeList(data||[]);}catch(error){console.error('ACT Size ëª©ë¡ ê°€ì ¸ì˜¤ê¸° ì‹¤íŒ¨:',error);setActSizeList([]);}};// ðŸ”‘ íŒŒì¼ ê´€ë¦¬ í•¨ìˆ˜ë“¤ ì¶”ê°€\nconst fetchManagerFiles=async()=>{if(!tempEstimateNo)return[];try{setIsLoadingFiles(true);console.log('ðŸ”„ fetchManagerFiles ì‹œìž‘ - tempEstimateNo:',tempEstimateNo);const response=await fetch(\"http://192.168.0.14:5135/api/estimate/sheets/\".concat(tempEstimateNo,\"/attachments\"));console.log('ðŸ“¡ API ì‘ë‹µ ìƒíƒœ:',response.status,response.ok);if(response.ok){const attachments=await response.json();console.log('ðŸ“¥ API ì‘ë‹µ ë°ì´í„°:',attachments);console.log('ðŸ“¥ API ì‘ë‹µ ë°ì´í„° ê¸¸ì´:',attachments.length);// ðŸ”‘ ResultFiles ê²½ë¡œì˜ ëª¨ë“  íŒŒì¼ ê°€ì ¸ì˜¤ê¸° (ì—‘ì…€ + PDF)\nconst allManagerFiles=attachments.filter(att=>{const filePath=att.path||att.filePath;const isManagerFileResult=filePath&&isManagerFile(filePath);console.log('ðŸ” íŒŒì¼ í•„í„°ë§ ì²´í¬:',att.name||att.fileName,'ê²½ë¡œ:',filePath,'ê´€ë¦¬íŒŒì¼ì—¬ë¶€:',isManagerFileResult);return isManagerFileResult;}).map(att=>{// ê²½ë¡œì—ì„œ managerFileType ì¶”ì¶œ (í¬ë¡œìŠ¤í”Œëž«í¼)\nconst filePath=att.path||att.filePath;att.managerFileType=extractManagerFileType(filePath);console.log('ðŸ·ï¸ ì¶”ì¶œëœ managerFileType:',att.managerFileType);return att;});setManagerFiles(allManagerFiles);console.log('âœ… ê´€ë¦¬ìž íŒŒì¼ ëª©ë¡ ë¡œë“œ ì™„ë£Œ:',allManagerFiles.length,'ê°œ');console.log('ðŸ” í•„í„°ë§ëœ ê´€ë¦¬ íŒŒì¼ë“¤:',allManagerFiles);return allManagerFiles;}else{console.error('âŒ API ì‘ë‹µ ì‹¤íŒ¨:',response.status,response.statusText);return[];}}catch(error){console.error('ê´€ë¦¬ìž íŒŒì¼ ëª©ë¡ ì¡°íšŒ ì¤‘ ì˜¤ë¥˜:',error);return[];}finally{setIsLoadingFiles(false);}};const fetchCustomerFiles=async()=>{if(!tempEstimateNo)return;try{setIsLoadingFiles(true);console.log('ðŸ”„ fetchCustomerFiles ì‹œìž‘ - tempEstimateNo:',tempEstimateNo);const response=await fetch(\"http://192.168.0.14:5135/api/estimate/sheets/\".concat(tempEstimateNo,\"/attachments\"));console.log('ðŸ“¡ API ì‘ë‹µ ìƒíƒœ:',response.status,response.ok);if(response.ok){const files=await response.json();const onlyResultCustomer=(files||[]).filter(att=>isResultCustomerFile(att.filePath||att.path));setCustomerFiles(onlyResultCustomer);console.log('âœ… ê³ ê° íŒŒì¼ ëª©ë¡ ë¡œë“œ ì™„ë£Œ (ResultFiles/customer í•œì •):',onlyResultCustomer.length,'ê°œ');}else{console.error('âŒ API ì‘ë‹µ ì‹¤íŒ¨:',response.status,response.statusText);}}catch(error){console.error('ê³ ê° íŒŒì¼ ëª©ë¡ ì¡°íšŒ ì¤‘ ì˜¤ë¥˜:',error);}finally{setIsLoadingFiles(false);}};const deleteFile=async managerFileType=>{if(!tempEstimateNo)return;if(!window.confirm('ì •ë§ë¡œ ì´ íŒŒì¼ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')){return;}try{const response=await fetch(\"http://192.168.0.14:5135/api/estimate/sheets/\".concat(tempEstimateNo,\"/files/\").concat(managerFileType),{method:'DELETE'});if(response.ok){// íŒŒì¼ ëª©ë¡ ìƒˆë¡œê³ ì¹¨\nawait fetchManagerFiles();alert('íŒŒì¼ì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.');}else{alert('íŒŒì¼ ì‚­ì œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');}}catch(error){console.error('íŒŒì¼ ì‚­ì œ ì¤‘ ì˜¤ë¥˜:',error);alert('íŒŒì¼ ì‚­ì œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');}};// ê°œë³„ ì²¨ë¶€íŒŒì¼ ì‚­ì œ(attachmentID ê¸°ì¤€) - ê³ ê° ë‹¤ì¤‘ íŒŒì¼ ëŒ€ì‘\nconst deleteAttachmentById=async attachmentID=>{if(!tempEstimateNo)return;if(!window.confirm('ì •ë§ë¡œ ì´ íŒŒì¼ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?'))return;try{const response=await fetch(\"http://192.168.0.14:5135/api/estimate/attachments/\".concat(attachmentID),{method:'DELETE'});if(response.ok){await fetchCustomerFiles();await fetchManagerFiles();}else{alert('íŒŒì¼ ì‚­ì œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');}}catch(e){console.error('ì²¨ë¶€íŒŒì¼ ì‚­ì œ ì˜¤ë¥˜:',e);alert('íŒŒì¼ ì‚­ì œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');}};const downloadFile=async(filePath,fileName)=>{try{// ðŸ”‘ íŒŒì¼ ë‹¤ìš´ë¡œë“œ API ìˆ˜ì • - ìƒˆë¡œ ì¶”ê°€ëœ API ì‚¬ìš©\nconst response=await fetch(\"http://192.168.0.14:5135/api/estimate/attachments/download?filePath=\".concat(encodeURIComponent(filePath)));if(response.ok){const blob=await response.blob();const url=window.URL.createObjectURL(blob);const a=document.createElement('a');a.href=url;a.download=fileName;document.body.appendChild(a);a.click();window.URL.revokeObjectURL(url);document.body.removeChild(a);}else{// ðŸ”‘ ë‹¤ìš´ë¡œë“œ ì‹¤íŒ¨ ì‹œ ìƒì„¸ ì—ëŸ¬ ì •ë³´ í‘œì‹œ\nconst errorText=await response.text();console.error('íŒŒì¼ ë‹¤ìš´ë¡œë“œ ì‹¤íŒ¨:',response.status,errorText);alert(\"\\uD30C\\uC77C \\uB2E4\\uC6B4\\uB85C\\uB4DC\\uC5D0 \\uC2E4\\uD328\\uD588\\uC2B5\\uB2C8\\uB2E4. (\".concat(response.status,\")\\n\").concat(errorText));}}catch(error){console.error('íŒŒì¼ ë‹¤ìš´ë¡œë“œ ì¤‘ ì˜¤ë¥˜:',error);alert('íŒŒì¼ ë‹¤ìš´ë¡œë“œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');}};const getFileTypeDisplayName=managerFileType=>{const typeMap={'cvlist':'CV List','vllist':'VL List','datasheet':'DataSheet','singlequote':'ë‹¨í’ˆê²¬ì ì„œ','multiquote':'ë‹¤ìˆ˜ëŸ‰ê²¬ì ì„œ'};return typeMap[managerFileType]||managerFileType;};const formatFileSize=function(bytes){let decimals=arguments.length>1&&arguments[1]!==undefined?arguments[1]:2;if(bytes===0)return'0 Bytes';const k=1024;const sizes=['Bytes','KB','MB','GB'];const i=Math.floor(Math.log(bytes)/Math.log(k));return parseFloat((bytes/Math.pow(k,i)).toFixed(decimals))+' '+sizes[i];};const formatDate=dateString=>{return new Date(dateString).toLocaleString('ko-KR');};// ðŸ”‘ PDF ì—…ë¡œë“œ ê´€ë ¨ í•¨ìˆ˜ë“¤ ì¶”ê°€\nconst handlePdfUpload=(event,fileType)=>{var _event$target$files;// ðŸ”‘ í™”ë©´ ì´ë™ ë°©ì§€\nevent.preventDefault();const file=(_event$target$files=event.target.files)===null||_event$target$files===void 0?void 0:_event$target$files[0];if(file){if(file.type!=='application/pdf'){alert('PDF íŒŒì¼ë§Œ ì—…ë¡œë“œ ê°€ëŠ¥í•©ë‹ˆë‹¤.');return;}// ðŸ”‘ ìƒíƒœ ì—…ë°ì´íŠ¸ë¥¼ ë¹„ë™ê¸°ë¡œ ì²˜ë¦¬í•˜ì—¬ í™”ë©´ ì´ë™ ë°©ì§€\nsetTimeout(()=>{setSelectedPdfFiles(prev=>_objectSpread(_objectSpread({},prev),{},{[fileType]:file}));},0);}};// ðŸ”‘ íŒŒì¼ ì„ íƒì„ ìœ„í•œ ë³„ë„ í•¨ìˆ˜ ì¶”ê°€\nconst handleFileSelect=fileType=>{const input=document.createElement('input');input.type='file';// ê³ ê°/ê´€ë¦¬ìž ê³µí†µ ì„ íƒê¸°: ë¬¸ì„œ/ì••ì¶• í¬í•¨ ê´‘ë²”ìœ„ í—ˆìš©\ninput.accept='.pdf,.doc,.docx,.xls,.xlsx,.ppt,.pptx,.hwp,.txt,.zip,.rar,.7z,.csv,.json';input.style.display='none';input.onchange=e=>{const target=e.target;if(target.files&&target.files[0]){const file=target.files[0];// ê³ ê° ì—…ë¡œë“œ/ë²”ìš© ì„ íƒ: íŒŒì¼ íƒ€ìž… ì œí•œ ì™„í™” (ì„œë²„ì—ì„œ ìµœì¢… ê²€ì¦)\nsetSelectedPdfFiles(prev=>_objectSpread(_objectSpread({},prev),{},{[fileType]:file}));}};document.body.appendChild(input);input.click();document.body.removeChild(input);};// Body ì„¹ì…˜ ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ë“¤\nconst handleBodyChange=(field,value)=>{setBodySelections(prev=>{const newSelections=_objectSpread(_objectSpread({},prev),{},{[field]:value});// ê¸°ì¡´ ë™ê¸°í™” ë¡œì§ ìœ ì§€...\nif(field==='bonnetType'){const selectedItem=bodyBonnetList.find(item=>item.bonnetCode===value);if(selectedItem)newSelections.bonnetTypeCode=selectedItem.bonnetCode;}if(field==='materialBody'){const selectedItem=bodyMatList.find(item=>item.bodyMatCode===value);if(selectedItem)newSelections.materialBodyCode=selectedItem.bodyMatCode;}if(field==='connection'){const selectedItem=bodyConnectionList.find(item=>item.connectionCode===value);if(selectedItem)newSelections.connectionCode=selectedItem.connectionCode;}if(field==='sizeBodyUnit'){newSelections.sizeBody='';newSelections.sizeBodyCode='';}if(field==='ratingUnit'){newSelections.rating='';newSelections.ratingCode='';}// ë§µì— ë°˜ì˜\nconst sid=selectedValve===null||selectedValve===void 0?void 0:selectedValve.sheetID;if(sid)setBodySelectionsBySheet(prevMap=>_objectSpread(_objectSpread({},prevMap),{},{[sid]:newSelections}));return newSelections;});};// Trim ì„¹ì…˜ ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ë“¤\nconst handleTrimChange=(field,value)=>{setTrimSelections(prev=>{const newSelections=_objectSpread(_objectSpread({},prev),{},{[field]:value});const sid=selectedValve===null||selectedValve===void 0?void 0:selectedValve.sheetID;if(sid)setTrimSelectionsBySheet(prevMap=>_objectSpread(_objectSpread({},prevMap),{},{[sid]:newSelections}));return newSelections;});};// ACT ì„¹ì…˜ ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ë“¤\nconst handleActChange=(field,value)=>{setActSelections(prev=>{const newSelections=_objectSpread(_objectSpread({},prev),{},{[field]:value});// ì‹œë¦¬ì¦ˆê°€ ë³€ê²½ë˜ë©´ ì‚¬ì´ì¦ˆ ì´ˆê¸°í™” ë° ì‚¬ì´ì¦ˆ ëª©ë¡ ìƒˆë¡œ ê°€ì ¸ì˜¤ê¸°\nif(field==='series'){newSelections.size='';// ì•¡íŠ¸ ì‚¬ì´ì¦ˆ ëª©ë¡ ìƒˆë¡œ ê°€ì ¸ì˜¤ê¸°\nif(value){fetchActSizeList(value);}else{setActSizeList([]);}}const sid=selectedValve===null||selectedValve===void 0?void 0:selectedValve.sheetID;if(sid)setActSelectionsBySheet(prevMap=>_objectSpread(_objectSpread({},prevMap),{},{[sid]:newSelections}));return newSelections;});};// ì•…ì„¸ì‚¬ë¦¬ ë°ì´í„° ê°€ì ¸ì˜¤ê¸° (ìž¬ì‹œë„ ë¡œì§ í¬í•¨)\nconst fetchAccessoryData=async function(){let retryCount=arguments.length>0&&arguments[0]!==undefined?arguments[0]:0;const maxRetries=3;try{console.log(\"\\uC545\\uC138\\uC0AC\\uB9AC \\uB370\\uC774\\uD130 \\uB85C\\uB529 \\uC2DC\\uB3C4 \".concat(retryCount+1,\"/\").concat(maxRetries+1,\"...\"));const accSearchRes=await fetch('http://192.168.0.14:5135/api/masterdata/acc/search');if(accSearchRes.ok){const accSearchData=await accSearchRes.json();console.log('ì•…ì„¸ì‚¬ë¦¬ ê²€ìƒ‰ ë°ì´í„° ë¡œë”© ì„±ê³µ:',accSearchData.length,'ê°œ');// ë°±ì—”ë“œ ì‘ë‹µ ë°ì´í„° êµ¬ì¡° í™•ì¸\nif(accSearchData.length>0){console.log('ðŸ” ë°±ì—”ë“œ ì‘ë‹µ ë°ì´í„° ì²« ë²ˆì§¸ í•­ëª© êµ¬ì¡°:',accSearchData[0]);console.log('ðŸ” ë°±ì—”ë“œ ì‘ë‹µ ë°ì´í„° ì²« ë²ˆì§¸ í•­ëª©ì˜ ëª¨ë“  í‚¤:',Object.keys(accSearchData[0]));}// ë©”ì´ì»¤ì™€ ëª¨ë¸ ë°ì´í„° ë¶„ë¦¬ - ì•…ì„¸ì‚¬ë¦¬ íƒ€ìž…ë³„ë¡œ êµ¬ë¶„\nconst allAccMakerData=[];const allAccModelData=[];// ì•…ì„¸ì‚¬ë¦¬ íƒ€ìž…ë³„ë¡œ ë°ì´í„° ê·¸ë£¹í™”\nconst groupedByType=accSearchData.reduce((acc,item)=>{if(!acc[item.accTypeCode]){acc[item.accTypeCode]=[];}acc[item.accTypeCode].push(item);return acc;},{});// ê° íƒ€ìž…ë³„ë¡œ ë©”ì´ì»¤ì™€ ëª¨ë¸ ë°ì´í„° ì²˜ë¦¬\nObject.entries(groupedByType).forEach(_ref=>{let[typeCode,items]=_ref;const typeItems=items;// ë©”ì´ì»¤ ë°ì´í„° (íƒ€ìž…ë³„ë¡œ ì¤‘ë³µ ì œê±°)\ntypeItems.forEach(item=>{const existingMaker=allAccMakerData.find(maker=>maker.accMakerCode===item.accMakerCode&&maker.accTypeCode===typeCode);if(!existingMaker){allAccMakerData.push({accMakerCode:item.accMakerCode,accMakerName:item.accMakerName,accTypeCode:typeCode});}});// ëª¨ë¸ ë°ì´í„°\ntypeItems.forEach(item=>{console.log(\"\\uD83D\\uDD0D \".concat(typeCode,\" \\uD0C0\\uC785 \\uBAA8\\uB378 \\uB370\\uC774\\uD130:\"),{accMakerCode:item.accMakerCode,accModelCode:item.accModelCode,accModelName:item.accModelName,accSize:item.accSize,accTypeCode:typeCode});allAccModelData.push({accMakerCode:item.accMakerCode,accModelCode:item.accModelCode,accModelName:item.accModelName,accSize:item.accSize,accTypeCode:typeCode// item.accTypeCode ëŒ€ì‹  ê·¸ë£¹í™”ëœ typeCode ì‚¬ìš©\n});});});console.log('ðŸ” ì•…ì„¸ì‚¬ë¦¬ íƒ€ìž…ë³„ ë°ì´í„° ê·¸ë£¹í™” ê²°ê³¼:',groupedByType);console.log('ðŸ” ë¶„ë¦¬ëœ ë©”ì´ì»¤ ë°ì´í„°:',allAccMakerData);console.log('ðŸ” ë¶„ë¦¬ëœ ëª¨ë¸ ë°ì´í„°:',allAccModelData);// ê° íƒ€ìž…ë³„ ë°ì´í„° ê°œìˆ˜ í™•ì¸\nObject.entries(groupedByType).forEach(_ref2=>{let[typeCode,items]=_ref2;console.log(\"\\uD83D\\uDD0D \".concat(typeCode,\" \\uD0C0\\uC785: \").concat(items.length,\"\\uAC1C\"));const uniqueMakers=new Set(items.map(item=>item.accMakerCode));console.log(\"  - \\uACE0\\uC720 \\uBA54\\uC774\\uCEE4 \\uC218: \".concat(uniqueMakers.size));console.log(\"  - \\uBA54\\uC774\\uCEE4 \\uCF54\\uB4DC\\uB4E4:\",Array.from(uniqueMakers));// íƒ€ìž…ë³„ ë©”ì´ì»¤ ëª©ë¡ í™•ì¸\nconst typeMakers=allAccMakerData.filter(maker=>maker.accTypeCode===typeCode);console.log(\"  - \\uD0C0\\uC785\\uBCC4 \\uBA54\\uC774\\uCEE4 \\uBAA9\\uB85D:\",typeMakers);});// ì•…ì„¸ì‚¬ë¦¬ ë°ì´í„° ì„¤ì •\nsetAccMakerList(allAccMakerData);setAccModelList(allAccModelData);console.log('ì•…ì„¸ì‚¬ë¦¬ ë°ì´í„° ì„¤ì • ì™„ë£Œ - ë©”ì´ì»¤:',allAccMakerData.length,'ê°œ, ëª¨ë¸:',allAccModelData.length,'ê°œ');// accMakerList êµ¬ì¡° ìƒì„¸ í™•ì¸\nconsole.log('ðŸ” accMakerList ìƒì„¸ êµ¬ì¡°:');allAccMakerData.forEach((maker,index)=>{console.log(\"  [\".concat(index,\"] \").concat(maker.accTypeCode,\" - \").concat(maker.accMakerCode,\": \").concat(maker.accMakerName));});// íƒ€ìž…ë³„ ë©”ì´ì»¤ ê°œìˆ˜ í™•ì¸\nconst makerCountByType=allAccMakerData.reduce((acc,maker)=>{if(!acc[maker.accTypeCode])acc[maker.accTypeCode]=0;acc[maker.accTypeCode]++;return acc;},{});console.log('ðŸ” íƒ€ìž…ë³„ ë©”ì´ì»¤ ê°œìˆ˜:',makerCountByType);// íƒ€ìž…ë³„ë¡œ ë©”ì´ì»¤ì™€ ëª¨ë¸ ë°ì´í„° ë¶„ë¦¬\nconst makerDataByType={};const modelDataByType={};allAccMakerData.forEach(maker=>{if(!makerDataByType[maker.accTypeCode]){makerDataByType[maker.accTypeCode]=[];}makerDataByType[maker.accTypeCode].push(maker);});allAccModelData.forEach(model=>{if(!modelDataByType[model.accTypeCode]){modelDataByType[model.accTypeCode]=[];}modelDataByType[model.accTypeCode].push(model);});console.log('ðŸ” íƒ€ìž…ë³„ ë¶„ë¦¬ëœ ë°ì´í„°:',{makerDataByType:Object.keys(makerDataByType).reduce((acc,key)=>{acc[key]=makerDataByType[key].length;return acc;},{}),modelDataByType:Object.keys(modelDataByType).reduce((acc,key)=>{acc[key]=modelDataByType[key].length;return acc;},{})});// íƒ€ìž…ë³„ ë°ì´í„°ë¥¼ ìƒíƒœì— ì €ìž¥\nsetAccMakerListByType(makerDataByType);setAccModelListByType(modelDataByType);// ì•…ì„¸ì‚¬ë¦¬ ë°ì´í„° ë¡œë“œ ì™„ë£Œ í›„ accSelections ì´ˆê¸°í™”\nconst initialAccSelections={positioner:{typeCode:'Positioner',makerCode:'',modelCode:'',specification:''},solenoid:{typeCode:'Solenoid',makerCode:'',modelCode:'',specification:''},limiter:{typeCode:'Limit',makerCode:'',modelCode:'',specification:''},airSupply:{typeCode:'Airset',makerCode:'',modelCode:'',specification:''},volumeBooster:{typeCode:'Volume',makerCode:'',modelCode:'',specification:''},airOperator:{typeCode:'Airoperate',makerCode:'',modelCode:'',specification:''},lockUp:{typeCode:'Lockup',makerCode:'',modelCode:'',specification:''},snapActingRelay:{typeCode:'Snapacting',makerCode:'',modelCode:'',specification:''}};setAccSelections(initialAccSelections);return true;// ì„±ê³µ\n}else{console.error('ì•…ì„¸ì‚¬ë¦¬ ê²€ìƒ‰ API ì‘ë‹µ ì‹¤íŒ¨:',accSearchRes.status,accSearchRes.statusText);return false;// ì‹¤íŒ¨\n}}catch(error){console.error('ì•…ì„¸ì‚¬ë¦¬ ê²€ìƒ‰ ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨:',error);return false;// ì‹¤íŒ¨\n}};// ë§ˆìŠ¤í„° ë°ì´í„° ê°€ì ¸ì˜¤ê¸°\nconst fetchMasterData=async()=>{try{// Step 1, 2 ë§ˆìŠ¤í„° ë°ì´í„° (EstimateController)\nconst[sizeRes,matRes,trimMatRes,optionRes,ratingRes]=await Promise.all([fetch('http://192.168.0.14:5135/api/estimate/body-size-list'),fetch('http://192.168.0.14:5135/api/estimate/body-mat-list'),fetch('http://192.168.0.14:5135/api/estimate/trim-mat-list'),fetch('http://192.168.0.14:5135/api/estimate/trim-option-list'),fetch('http://192.168.0.14:5135/api/estimate/body-rating-list')]);const[sizeData,matData,trimMatData,optionData,ratingData]=await Promise.all([sizeRes.json(),matRes.json(),trimMatRes.json(),optionRes.json(),ratingRes.json()]);setBodySizeList(sizeData||[]);setBodyMatList(matData||[]);setTrimMatList(trimMatData||[]);setTrimOptionList(optionData||[]);setBodyRatingList(ratingData||[]);//console.log('BodyRatingList ë¡œë“œë¨:', ratingData); // ë””ë²„ê¹… ë¡œê·¸ ì¶”ê°€\n// Step 3 ë§ˆìŠ¤í„° ë°ì´í„° (MasterDataController)\nconst[bodyBonnetRes,bodyConnectionRes,trimTypeRes,trimSeriesRes,trimPortSizeRes,trimFormRes,actTypeRes,actSeriesRes,actHWRes]=await Promise.all([fetch('http://192.168.0.14:5135/api/masterdata/body/bonnet'),fetch('http://192.168.0.14:5135/api/masterdata/body/connection'),fetch('http://192.168.0.14:5135/api/masterdata/trim-type'),fetch('http://192.168.0.14:5135/api/masterdata/trim/series'),fetch('http://192.168.0.14:5135/api/masterdata/trim/port-size'),fetch('http://192.168.0.14:5135/api/masterdata/trim/form'),fetch('http://192.168.0.14:5135/api/masterdata/act/type'),fetch('http://192.168.0.14:5135/api/masterdata/act/series'),fetch('http://192.168.0.14:5135/api/masterdata/act/hw')]);// ë“œëž˜ê·¸ ì•¤ ë“œë¡­ í•¸ë“¤ëŸ¬ (ì¶”ê°€)\nconst onDragStart=(e,index,listKey)=>{e.dataTransfer.setData('text/plain',JSON.stringify({index,listKey}));};const onDragOver=e=>{e.preventDefault();};const onDrop=(e,dropIndex,listKey)=>{e.preventDefault();const{index}=JSON.parse(e.dataTransfer.getData('text/plain')||'{\"index\":-1}');if(index<0)return;if(listKey==='types'){setTypes(prev=>{const arr=[...prev];const[moved]=arr.splice(index,1);arr.splice(dropIndex,0,moved);return arr;});}else{setValves(prev=>{const arr=[...prev];const[moved]=arr.splice(index,1);arr.splice(dropIndex,0,moved);// ë³´ê¸°ìš© sheetNo ìž¬ë¶€ì—¬(1ë¶€í„°)\nreturn arr.map((it,i)=>_objectSpread(_objectSpread({},it),{},{sheetNo:i+1}));});}};// ê° API ì‘ë‹µì„ ê°œë³„ì ìœ¼ë¡œ ì²˜ë¦¬í•˜ì—¬ ì—ëŸ¬ ë°œìƒ ì‹œì—ë„ ë‹¤ë¥¸ ë°ì´í„°ëŠ” ë¡œë“œí•  ìˆ˜ ìžˆë„ë¡ í•¨\nlet bodyBonnetData=[],bodyConnectionData=[],trimTypeData=[],trimSeriesData=[],trimPortSizeData=[],trimFormData=[],actTypeData=[],actSeriesData=[],actHWData=[];try{bodyBonnetData=await bodyBonnetRes.json();//console.log('Body Bonnet ë°ì´í„° ë¡œë“œ ì„±ê³µ:', bodyBonnetData.length);\n}catch(e){console.error('Body Bonnet ë°ì´í„° íŒŒì‹± ì‹¤íŒ¨:',e);}try{bodyConnectionData=await bodyConnectionRes.json();//console.log('Body Connection ë°ì´í„° ë¡œë“œ ì„±ê³µ:', bodyConnectionData.length);\n}catch(e){console.error('Body Connection ë°ì´í„° íŒŒì‹± ì‹¤íŒ¨:',e);}try{trimTypeData=await trimTypeRes.json();//console.log('Trim Type ë°ì´í„° ë¡œë“œ ì„±ê³µ:', trimTypeData.length);\n}catch(e){console.error('Trim Type ë°ì´í„° íŒŒì‹± ì‹¤íŒ¨:',e);}try{trimSeriesData=await trimSeriesRes.json();//console.log('Trim Series ë°ì´í„° ë¡œë“œ ì„±ê³µ:', trimSeriesData.length);\n}catch(e){console.error('Trim Series ë°ì´í„° íŒŒì‹± ì‹¤íŒ¨:',e);}try{trimPortSizeData=await trimPortSizeRes.json();//console.log('Trim Port Size ë°ì´í„° ë¡œë“œ ì„±ê³µ:', trimPortSizeData.length);\n}catch(e){console.error('Trim Port Size ë°ì´í„° íŒŒì‹± ì‹¤íŒ¨:',e);}try{trimFormData=await trimFormRes.json();//console.log('Trim Form ë°ì´í„° ë¡œë“œ ì„±ê³µ:', trimFormData.length);\n}catch(e){console.error('Trim Form ë°ì´í„° íŒŒì‹± ì‹¤íŒ¨:',e);}try{actTypeData=await actTypeRes.json();//console.log('Act Type ë°ì´í„° ë¡œë“œ ì„±ê³µ:', actTypeData.length);\n}catch(e){console.error('Act Type ë°ì´í„° íŒŒì‹± ì‹¤íŒ¨:',e);}try{actSeriesData=await actSeriesRes.json();//console.log('Act Series ë°ì´í„° ë¡œë“œ ì„±ê³µ:', actSeriesData.length);\n}catch(e){console.error('Act Series ë°ì´í„° íŒŒì‹± ì‹¤íŒ¨:',e);}try{actHWData=await actHWRes.json();//console.log('Act HW ë°ì´í„° ë¡œë“œ ì„±ê³µ:', actHWData.length);\n}catch(e){console.error('Act HW ë°ì´í„° íŒŒì‹± ì‹¤íŒ¨:',e);}// ì•…ì„¸ì‚¬ë¦¬ ë°ì´í„° ë¡œë”©ì€ ë³„ë„ í•¨ìˆ˜ë¡œ ë¶„ë¦¬í•˜ì—¬ ìž¬ì‹œë„ ê°€ëŠ¥í•˜ë„ë¡ í•¨\nawait fetchAccessoryData();setBodyBonnetList(bodyBonnetData||[]);setBodyConnectionList(bodyConnectionData||[]);setTrimTypeList(trimTypeData||[]);setTrimSeriesList(trimSeriesData||[]);setTrimPortSizeList(trimPortSizeData||[]);setTrimFormList(trimFormData||[]);setActTypeList(actTypeData||[]);setActSeriesList(actSeriesData||[]);setActHWList(actHWData||[]);}catch(error){console.error('ë§ˆìŠ¤í„° ë°ì´í„° ê°€ì ¸ì˜¤ê¸° ì‹¤íŒ¨:',error);// ê°œë³„ API ì‘ë‹µ ìƒíƒœ í™•ì¸ì„ ìœ„í•œ ë¡œê¹… ì¶”ê°€\n//console.log('ë§ˆìŠ¤í„° ë°ì´í„° ë¡œë”© ìƒíƒœ:');\n//console.log('- Body Size:', bodySizeList.length);\n//console.log('- Body Material:', bodyMatList.length);\n//console.log('- Trim Material:', trimMatList.length);\n//\n// ì—ëŸ¬ ë°œìƒ ì‹œ ë¹ˆ ë°°ì—´ë¡œ ì„¤ì •\nsetBodySizeList([]);setBodyMatList([]);setTrimMatList([]);setTrimOptionList([]);setBodyRatingList([]);setBodyBonnetList([]);setBodyConnectionList([]);setTrimTypeList([]);setTrimSeriesList([]);setTrimPortSizeList([]);setTrimFormList([]);setActTypeList([]);setActSeriesList([]);setActHWList([]);setAccMakerList([]);setAccModelList([]);}};// í’ˆë²ˆ ìƒì„± í•¨ìˆ˜ - ì„¹ì…˜ë³„ë¡œ êµ¬ë¶„\nconst generatePartNumber=useCallback(()=>{try{// BODY ì„¹ì…˜ (6ìžë¦¬) - ì½”ë“œ ì‚¬ìš©\nconst bodySection=[bodySelections.bonnetTypeCode||'0','2',// valveSeries ê¸°ë³¸ê°’\nbodySelections.materialBodyCode||'0',bodySelections.sizeBodyCode||'0',bodySelections.ratingCode||'0',bodySelections.connectionCode||'0'].join('');// TRIM ì„¹ì…˜ (6ìžë¦¬) - ì½”ë“œ ì‚¬ìš©\nconst trimSection=[trimSelections.trimTypeCode||'0',trimSelections.trimSeriesCode||'0',trimSelections.materialTrimCode||'0',trimSelections.sizePortCode||'0',trimSelections.sizePortCode||'0',// ì¤‘ë³µ\ntrimSelections.formCode||'0'].join('');// ACT ì„¹ì…˜ (4ìžë¦¬) - ì½”ë“œ ì‚¬ìš©\nconst actSection=[actSelections.actionType||'0',actSelections.series||'0',actSelections.size||'0',actSelections.hw||'0'].join('');// ACC ì„¹ì…˜ (11ìžë¦¬)\nconst accSection=[accSelections.positioner.makerCode||'0',accSelections.positioner.modelCode||'0',accSelections.solenoid.makerCode||'0',accSelections.solenoid.modelCode||'0',accSelections.limiter.makerCode||'0',accSelections.limiter.modelCode||'0',accSelections.airSupply.modelCode||'0',accSelections.volumeBooster.modelCode||'0',accSelections.airOperator.modelCode||'0',accSelections.lockUp.modelCode||'0',accSelections.snapActingRelay.modelCode||'0'].join('');// ì„¹ì…˜ì„ '-'ë¡œ êµ¬ë¶„í•˜ì—¬ ë°˜í™˜\nreturn\"\".concat(bodySection,\"-\").concat(trimSection,\"-\").concat(actSection,\"-\").concat(accSection);}catch(error){console.error('í’ˆë²ˆ ìƒì„± ì¤‘ ì˜¤ë¥˜:',error);return'000000-000000-0000-00000000000';}},[bodySelections,trimSelections,actSelections,accSelections]);// ê¸°ì¡´ ë°ì´í„° ë¡œë“œ\nconst loadExistingData=useCallback(async()=>{if(!tempEstimateNo)return;//console.log('í˜„ìž¬ tempEstimateNo:', tempEstimateNo); // tempEstimateNo ë¡œê·¸ ì¶”ê°€\ntry{var _ref3,_es$curEstimateNo,_data$estimateSheet,_data$estimateSheet2;// í˜„ìž¬ ë¡œê·¸ì¸í•œ ì‚¬ìš©ìž ì •ë³´ ê°€ì ¸ì˜¤ê¸°\nconst userStr=localStorage.getItem('user');const currentUser=userStr?JSON.parse(userStr):null;// currentUserIdëŠ” ìž„ì‹œë¡œ 'admin' ì‚¬ìš© (ì‹¤ì œë¡œëŠ” ë¡œê·¸ì¸ëœ ì‚¬ìš©ìž IDë¥¼ ì‚¬ìš©í•´ì•¼ í•¨)\nconst response=await getEstimateDetail(tempEstimateNo,(currentUser===null||currentUser===void 0?void 0:currentUser.userId)||'admin');// ì‹¤ì œ ì‚¬ìš©ìž ID ì‚¬ìš©\nconst data=response;//console.log('ê²¬ì  ìƒì„¸ ë°ì´í„°:', data);\n// í”„ë¡œì íŠ¸ëª… ì„¤ì •\nif(data.estimateSheet&&data.estimateSheet.project){setProjectName(data.estimateSheet.project);}// í˜„ìž¬ ìƒíƒœ ì„¤ì • + ê²¬ì ì‹œìž‘ í† ê¸€\nif(data.estimateSheet&&data.estimateSheet.statusText){setCurrentStatus(data.estimateSheet.statusText);}// status === 3(ê²¬ì ì²˜ë¦¬ì¤‘) ì´ë©´ ë²„íŠ¼ì„ ë³´ë¼ìƒ‰ ìƒíƒœë¡œ í† ê¸€\nif(data.estimateSheet&&typeof data.estimateSheet.status==='number'){setQuoteStarted(data.estimateSheet.status===3);}// ìš”ì•½ ì¹´ë“œ í‘œì‹œê°’ ì„¤ì •\nconst es=data.estimateSheet||{};const tempNo=es.tempEstimateNo||es.TempEstimateNo||'';const curNo=(_ref3=(_es$curEstimateNo=es.curEstimateNo)!==null&&_es$curEstimateNo!==void 0?_es$curEstimateNo:es.CurEstimateNo)!==null&&_ref3!==void 0?_ref3:null;const customerName=es.customerName||es.CustomerName||'-';const customerUserName=es.customerUserName||es.CustomerUserName||customerName;const managerId=es.managerID||es.ManagerID||'-';const managerName=es.managerName||es.ManagerName||managerId;const parseFromTemp=no=>{const m=/TEMP(\\d{4})(\\d{2})(\\d{2})/.exec(no||'');return m?\"\".concat(m[1],\".\").concat(m[2],\".\").concat(m[3]):'-';};const parseFromCur=no=>{if(!no)return'-';const m=/YA(\\d{4})(\\d{2})(\\d{2})-(\\d{3})/.exec(no);return m?\"\".concat(m[1],\".\").concat(m[2],\".\").concat(m[3]):'-';};setSummaryEstimateNo(curNo!==null&&curNo!==void 0?curNo:tempNo||'-');setSummaryCompanyName(customerName);setSummaryRequesterName(customerUserName);// ìš”ì²­ìž = User.Name\nsetSummaryRequestDate(parseFromTemp(tempNo));setSummaryManager(managerName||managerId||'-');setSummaryCompletedDate(parseFromCur(curNo));// ì½ê¸° ì „ìš© ìƒíƒœ ì„¤ì •\nconst isStatusThree=((_data$estimateSheet=data.estimateSheet)===null||_data$estimateSheet===void 0?void 0:_data$estimateSheet.status)===3;// ìƒíƒœê°€ 3 (ê²¬ì ì²˜ë¦¬ì¤‘)ì¸ì§€\nconst isCurrentUserManager=(currentUser===null||currentUser===void 0?void 0:currentUser.userId)===((_data$estimateSheet2=data.estimateSheet)===null||_data$estimateSheet2===void 0?void 0:_data$estimateSheet2.managerID);// í˜„ìž¬ ì‚¬ìš©ìžê°€ ë‹´ë‹¹ìžì¸ì§€\nconst shouldBeReadOnly=!(isStatusThree&&isCurrentUserManager);// ë‘˜ ë‹¤ ì°¸ì¼ ë•Œë§Œ false (ìˆ˜ì • ê°€ëŠ¥)\nsetIsReadOnly(shouldBeReadOnly);//console.log('EstimateDetailPage isReadOnly ì„¤ì •ë¨:', shouldBeReadOnly);\n//console.log('  status:', data.estimateSheet?.status, '(3ì´ë©´ ê²¬ì ì²˜ë¦¬ì¤‘)');\n//console.log('  managerID:', data.estimateSheet?.managerID);\n//console.log('  currentUser.userId:', currentUser?.userId);\n// EstimateRequest ë°ì´í„°ë¥¼ ê¸°ë°˜ìœ¼ë¡œ typesì™€ valves ì„¤ì •\nif(data.estimateRequests&&data.estimateRequests.length>0){var _data$estimateRequest;// ë””ë²„ê¹…: ì‹¤ì œ ë°ì´í„° êµ¬ì¡° í™•ì¸\nconsole.log('ðŸ” EstimateDetailPage - API ì‘ë‹µ ë°ì´í„° êµ¬ì¡°:');console.log('data.estimateRequests:',data.estimateRequests);console.log('ì²« ë²ˆì§¸ estimateRequest:',data.estimateRequests[0]);if((_data$estimateRequest=data.estimateRequests[0])!==null&&_data$estimateRequest!==void 0&&_data$estimateRequest.tagNos){var _data$estimateRequest2,_data$estimateRequest3;console.log('ì²« ë²ˆì§¸ tagNos:',data.estimateRequests[0].tagNos);console.log('ì²« ë²ˆì§¸ tagNoì˜ í•„ë“œë“¤:',Object.keys(data.estimateRequests[0].tagNos[0]||{}));console.log('ì²« ë²ˆì§¸ tagNoì˜ sheetNo:',(_data$estimateRequest2=data.estimateRequests[0].tagNos[0])===null||_data$estimateRequest2===void 0?void 0:_data$estimateRequest2.sheetNo);console.log('ì²« ë²ˆì§¸ tagNoì˜ sheetID:',(_data$estimateRequest3=data.estimateRequests[0].tagNos[0])===null||_data$estimateRequest3===void 0?void 0:_data$estimateRequest3.sheetID);}// Type ì •ë³´ ì„¤ì •\nconst typeMap=new Map();data.estimateRequests.forEach(req=>{const valveType=req.valveType;if(typeMap.has(valveType)){typeMap.get(valveType).count+=req.tagNos.reduce((sum,tag)=>sum+tag.qty,0);}else{const totalQty=req.tagNos.reduce((sum,tag)=>sum+tag.qty,0);typeMap.set(valveType,{count:totalQty,order:typeMap.size+1});}});// typesDataë¥¼ SheetNo ê¸°ì¤€ìœ¼ë¡œ ì •ë ¬\nconst typesData=Array.from(typeMap.entries()).map(_ref4=>{let[code,info]=_ref4;// bodyValveListê°€ ë¡œë“œë˜ì§€ ì•Šì€ ê²½ìš°ë¥¼ ëŒ€ë¹„í•˜ì—¬ ê¸°ë³¸ê°’ ì„¤ì •\nconst valveInfo=bodyValveList.find(v=>v.valveSeriesCode===code);return{id:code,name:valveInfo?valveInfo.valveSeries:\"Valve Type \".concat(code),code:code,count:info.count,order:info.order};});// ë°¸ë¸Œ íƒ€ìž…ì„ SheetNo ìˆœì„œëŒ€ë¡œ ì •ë ¬\nconst sortedTypesData=typesData.sort((a,b)=>{var _data$estimateRequest4,_data$estimateRequest5,_data$estimateRequest6,_data$estimateRequest7;// ê° ë°¸ë¸Œ íƒ€ìž…ì˜ ì²« ë²ˆì§¸ TagNoì˜ SheetNoë¥¼ ê¸°ì¤€ìœ¼ë¡œ ì •ë ¬\nconst aFirstTag=(_data$estimateRequest4=data.estimateRequests.find(req=>req.valveType===a.code))===null||_data$estimateRequest4===void 0?void 0:(_data$estimateRequest5=_data$estimateRequest4.tagNos)===null||_data$estimateRequest5===void 0?void 0:_data$estimateRequest5[0];const bFirstTag=(_data$estimateRequest6=data.estimateRequests.find(req=>req.valveType===b.code))===null||_data$estimateRequest6===void 0?void 0:(_data$estimateRequest7=_data$estimateRequest6.tagNos)===null||_data$estimateRequest7===void 0?void 0:_data$estimateRequest7[0];// sheetNo ë˜ëŠ” sheetID ì‚¬ìš© (íƒ€ìž… ì•ˆì „ì„± í™•ë³´)\nconst aSheetNo=(aFirstTag===null||aFirstTag===void 0?void 0:aFirstTag.sheetNo)||(aFirstTag===null||aFirstTag===void 0?void 0:aFirstTag.sheetID)||999;const bSheetNo=(bFirstTag===null||bFirstTag===void 0?void 0:bFirstTag.sheetNo)||(bFirstTag===null||bFirstTag===void 0?void 0:bFirstTag.sheetID)||999;return aSheetNo-bSheetNo;});setTypes(sortedTypesData);// Valve ì •ë³´ ì„¤ì • - TagNoDetailDtoë¥¼ ê¸°ë°˜ìœ¼ë¡œ ë³€í™˜\nconst valvesData=[];data.estimateRequests.forEach(req=>{req.tagNos.forEach(tag=>{var _tag$sheetNo;// Body Type ì´ë¦„ ê°€ì ¸ì˜¤ê¸°\nconst valveInfo=bodyValveList.find(v=>v.valveSeriesCode===req.valveType);const bodyTypeName=valveInfo?valveInfo.valveSeries:\"Valve Type \".concat(req.valveType);// Rating Unit ê°€ì ¸ì˜¤ê¸° (bodyRatingListì—ì„œ ì°¾ê¸°)\nconst ratingInfo=bodyRatingList.find(r=>r.ratingCode===tag.bodyRating);const ratingUnit=ratingInfo?ratingInfo.ratingUnit:'';valvesData.push({id:\"\".concat(tag.sheetID),tagNo:tag.tagNo,qty:tag.qty,order:(_tag$sheetNo=tag.sheetNo)!==null&&_tag$sheetNo!==void 0?_tag$sheetNo:tag.sheetID,sheetID:tag.sheetID,typeId:req.valveType,fluid:{medium:tag.medium||'',fluid:tag.fluid||'',density:tag.density||'',molecular:tag.molecularWeight||'',t1:{max:tag.inletTemperatureQ||0,normal:tag.inletTemperatureNorQ||0,min:tag.inletTemperatureMinQ||0},p1:{max:tag.inletPressureMaxQ||0,normal:tag.inletPressureNorQ||0,min:tag.inletPressureMinQ||0},p2:{max:tag.outletPressureMaxQ||0,normal:tag.outletPressureNorQ||0,min:tag.outletPressureMinQ||0},dp:{max:tag.differentialPressureMaxQ||0,normal:tag.differentialPressureNorQ||0,min:tag.differentialPressureMinQ||0},qm:{max:tag.qmMax||0,normal:tag.qmNor||0,min:tag.qmMin||0,unit:tag.qmUnit||''},qn:{max:tag.qnMax||0,normal:tag.qnNor||0,min:tag.qnMin||0,unit:tag.qnUnit||''},pressureUnit:tag.pressureUnit||'',temperatureUnit:tag.temperatureUnit||''},body:{type:bodyTypeName,// Body Type ì´ë¦„ ì„¤ì •\ntypeCode:req.valveType||'',size:tag.bodySize||'',sizeUnit:tag.bodySizeUnit||'',materialBody:tag.bodyMat||'',materialTrim:tag.trimMat||'',option:tag.trimOption||'',rating:tag.bodyRating||'',ratingUnit:ratingUnit// Rating Unit ì„¤ì •\n},actuator:{type:tag.actType||'',hw:tag.isHW?'Yes':'No'},accessory:{positioner:{type:tag.positionerType||'',exists:tag.isPositioner||false},explosionProof:tag.explosionProof||'',transmitter:{type:tag.transmitterType||'',exists:!!tag.transmitterType},solenoidValve:tag.isSolenoid||false,limitSwitch:tag.isLimSwitch||false,airSet:tag.isAirSet||false,volumeBooster:tag.isVolumeBooster||false,airOperatedValve:tag.isAirOperated||false,lockupValve:tag.isLockUp||false,snapActingRelay:tag.isSnapActingRelay||false},isQM:tag.isQM||false,isP2:tag.isP2||false,isN1:false,// EstimateRequestDetailDtoì—ëŠ” isN1ì´ ì—†ìŒ\nisDensity:tag.isDensity||false,isHW:tag.isHW||false});});});// sheetNo ê¸°ì¤€ìœ¼ë¡œ ì˜¤ë¦„ì°¨ìˆœ ì •ë ¬\nvalvesData.sort((a,b)=>a.order-b.order);// ì •ë ¬ëœ ê²°ê³¼ë¡œ ìƒíƒœ ë°˜ì˜\nsetValves(valvesData);// ì²« ë²ˆì§¸ valveë¥¼ ê¸°ë³¸ ì„ íƒ\n// if (valvesData.length > 0) {\n//   setSelectedValve(valvesData[0]);\n// }\n}// ê¸°íƒ€ ìš”ì²­ì‚¬í•­ ì„¤ì •\nif(data.estimateSheet&&data.estimateSheet.customerRequirement){setCustomerRequirement(data.estimateSheet.customerRequirement);}// ê´€ë¦¬ìž ì½”ë©˜íŠ¸ ì„¤ì •\nif(data.estimateSheet&&data.estimateSheet.staffComment){setStaffComment(data.estimateSheet.staffComment);}// ì²¨ë¶€íŒŒì¼ ì„¤ì • - ê³ ê° ìš”ì²­ê³¼ ê´€ë¦¬ ì²¨ë¶€íŒŒì¼ ë¶„ë¦¬\nif(data.attachments&&data.attachments.length>0){const customerFiles=[];const managerFiles=[];data.attachments.forEach(att=>{if(att.filePath&&isCustomerFile(att.filePath)){customerFiles.push(att);}else if(att.filePath&&isManagerFile(att.filePath)){managerFiles.push(att);}});setCustomerAttachments(customerFiles);setManagerAttachments(managerFiles);// ê¸°ì¡´ í˜¸í™˜ì„± ìœ ì§€\nconst fileList=data.attachments.map(att=>({name:att.fileName||'Unknown',size:att.fileSize||0}));setAttachments(fileList);}}catch(error){console.error('ê¸°ì¡´ ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨:',error);}},[tempEstimateNo,bodyValveList,bodyRatingList]);// ìƒíƒœ ë³€ê²½ ì²˜ë¦¬\nconst handleStatusChange=async newStatus=>{try{// ìƒíƒœ í…ìŠ¤íŠ¸ë¥¼ ìˆ«ìž ì½”ë“œë¡œ ë³€í™˜í•˜ëŠ” í—¬í¼ í•¨ìˆ˜\nconst getStatusCodeFromText=statusText=>{switch(statusText){case'ìž„ì‹œì €ìž¥':return 1;case'ê²¬ì ìš”ì²­':return 2;case'ê²¬ì ì²˜ë¦¬ì¤‘':return 3;case'ê²¬ì ì™„ë£Œ':return 4;case'ì£¼ë¬¸':return 5;default:return-1;// ì•Œ ìˆ˜ ì—†ëŠ” ìƒíƒœ\n}};const newStatusCode=getStatusCodeFromText(newStatus);// í˜„ìž¬ ì‚¬ìš©ìž ì •ë³´ì™€ ê²¬ì  ì •ë³´ ê°€ì ¸ì˜¤ê¸°\nconst userStr=localStorage.getItem('user');const currentUser=userStr?JSON.parse(userStr):null;// ê²¬ì  ìƒì„¸ ì •ë³´ ê°€ì ¸ì˜¤ê¸° (isReadOnly ê³„ì‚°ì„ ìœ„í•´)\nif(!tempEstimateNo){throw new Error('tempEstimateNoê°€ ì—†ìŠµë‹ˆë‹¤.');}const estimateResponse=await getEstimateDetail(tempEstimateNo,(currentUser===null||currentUser===void 0?void 0:currentUser.userId)||'admin');const estimateData=estimateResponse;// ê²¬ì ìš”ì²­ ìƒíƒœ(2)ì—ì„œë§Œ ê²¬ì ì²˜ë¦¬ì¤‘(3)ìœ¼ë¡œ ë³€ê²½ ê°€ëŠ¥\n// if (currentStatusCode === 2 && newStatusCode === 3) {\n// ìƒíƒœ ë³€ê²½ API í˜¸ì¶œ\nconst response=await fetch(\"/api/estimate/sheets/\".concat(tempEstimateNo,\"/status\"),{// API ê²½ë¡œ ìˆ˜ì •\nmethod:'PUT',headers:{'Content-Type':'application/json'},body:JSON.stringify({status:newStatusCode})// ìˆ«ìž ìƒíƒœ ì½”ë“œë¡œ ì „ì†¡\n});if(response.ok){var _estimateData$estimat;setCurrentStatus(newStatus);// UI ìƒíƒœ ì—…ë°ì´íŠ¸ (ë¬¸ìžì—´ë¡œ ìœ ì§€)\n// ìƒíƒœ ë³€ê²½ í›„ isReadOnly ìž¬ê³„ì‚°\nconst newStatusCode=getStatusCodeFromText(newStatus);const isStatusThree=newStatusCode===3;// ìƒíƒœê°€ 3 (ê²¬ì ì²˜ë¦¬ì¤‘)ì¸ì§€\nconst isCurrentUserManager=(currentUser===null||currentUser===void 0?void 0:currentUser.userId)===((_estimateData$estimat=estimateData.estimateSheet)===null||_estimateData$estimat===void 0?void 0:_estimateData$estimat.managerID);// í˜„ìž¬ ì‚¬ìš©ìžê°€ ë‹´ë‹¹ìžì¸ì§€\nconst shouldBeReadOnly=!(isStatusThree&&isCurrentUserManager);// ë‘˜ ë‹¤ ì°¸ì¼ ë•Œë§Œ false (ìˆ˜ì • ê°€ëŠ¥)\nsetIsReadOnly(shouldBeReadOnly);alert('ìƒíƒœê°€ ì„±ê³µì ìœ¼ë¡œ ë³€ê²½ë˜ì—ˆìŠµë‹ˆë‹¤.');// ë©”ì‹œì§€ ì¼ë°˜í™”\n// ìƒíƒœ ë³€ê²½ í›„ ìƒì„¸ ì •ë³´ë¥¼ ë‹¤ì‹œ ë¶ˆëŸ¬ì˜¤ëŠ” ë¡œì§ì´ í•„ìš”í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤.\n// loadEstimateDetail(); // ìƒì„¸ ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” í•¨ìˆ˜ê°€ ìžˆë‹¤ë©´ í˜¸ì¶œ\n}else{// ì‘ë‹µ ë³¸ë¬¸ì„ ì½ì–´ì„œ ë” ìžì„¸í•œ ì˜¤ë¥˜ ë©”ì‹œì§€ í™•ì¸\nconst errorData=await response.json();throw new Error(errorData.message||'ìƒíƒœ ë³€ê²½ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');}// } else { // ì´ else ë¸”ë¡ë„ ì œê±°í•©ë‹ˆë‹¤.\n//   alert('ê²¬ì ìš”ì²­ ìƒíƒœì—ì„œë§Œ ê²¬ì ì²˜ë¦¬ì¤‘ìœ¼ë¡œ ë³€ê²½í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤.');\n// }\n}catch(error){console.error('ìƒíƒœ ë³€ê²½ ì‹¤íŒ¨:',error.message);alert(\"\\uC0C1\\uD0DC \\uBCC0\\uACBD\\uC5D0 \\uC2E4\\uD328\\uD588\\uC2B5\\uB2C8\\uB2E4: \".concat(error.message));}};// ì²¨ë¶€íŒŒì¼ ê´€ë ¨ í•¨ìˆ˜ë“¤\nconst handleDownloadFile=async(file,type)=>{try{if(type==='customer'&&!file.fileName.toLowerCase().endsWith('.pdf')){alert('ê³ ê°ì€ PDF íŒŒì¼ë§Œ ë‹¤ìš´ë¡œë“œí•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤.');return;}// íŒŒì¼ ë‹¤ìš´ë¡œë“œ API í˜¸ì¶œ\nconst response=await fetch(\"/api/estimate/attachments/\".concat(file.attachmentID,\"/download\"));if(response.ok){const blob=await response.blob();const url=window.URL.createObjectURL(blob);const a=document.createElement('a');a.href=url;a.download=file.fileName;document.body.appendChild(a);a.click();window.URL.revokeObjectURL(url);document.body.removeChild(a);}else{alert('íŒŒì¼ ë‹¤ìš´ë¡œë“œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');}}catch(error){console.error('íŒŒì¼ ë‹¤ìš´ë¡œë“œ ì˜¤ë¥˜:',error);alert('íŒŒì¼ ë‹¤ìš´ë¡œë“œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');}};const handleUploadManagerFile=async fileType=>{const file=selectedPdfFiles[fileType];if(!file){alert('ì—…ë¡œë“œí•  PDF íŒŒì¼ì„ ì„ íƒí•´ì£¼ì„¸ìš”.');return;}try{const formData=new FormData();formData.append('file',file);// ðŸ”‘ ì¿¼ë¦¬ íŒŒë¼ë¯¸í„°ë¡œ ì „ì†¡í•˜ë„ë¡ ìˆ˜ì •\nconst response=await fetch(\"http://192.168.0.14:5135/api/estimate/sheets/\".concat(tempEstimateNo,\"/attachments?uploadUserID=admin&fileType=manager&managerFileType=\").concat(fileType),{method:'POST',body:formData});if(response.ok){alert('PDF íŒŒì¼ì´ ì„±ê³µì ìœ¼ë¡œ ì—…ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤.');// ðŸ”‘ íŒŒì¼ ëª©ë¡ ìƒˆë¡œê³ ì¹¨ - ë” í™•ì‹¤í•˜ê²Œ ì²˜ë¦¬\nconsole.log('ðŸ”„ íŒŒì¼ ì—…ë¡œë“œ ì™„ë£Œ, ëª©ë¡ ìƒˆë¡œê³ ì¹¨ ì‹œìž‘');await fetchManagerFiles();await fetchCustomerFiles();// ðŸ”‘ ì¶”ê°€ë¡œ ìž ì‹œ í›„ í•œ ë²ˆ ë” ìƒˆë¡œê³ ì¹¨ (ë°±ì—”ë“œ ì²˜ë¦¬ ì§€ì—° ê³ ë ¤)\nsetTimeout(async()=>{console.log('ðŸ”„ ì§€ì—° ìƒˆë¡œê³ ì¹¨ ì‹¤í–‰');await fetchManagerFiles();await fetchCustomerFiles();},1000);// ðŸ”‘ ì—‘ì…€ íŒŒì¼ë„ í•¨ê»˜ ìƒˆë¡œê³ ì¹¨ (ë°±ì—”ë“œ êµì²´ ë¡œì§ ë¬¸ì œ í•´ê²°)\nsetTimeout(async()=>{console.log('ðŸ”„ ì—‘ì…€ íŒŒì¼ ìƒˆë¡œê³ ì¹¨ ì‹¤í–‰');await fetchManagerFiles();await fetchCustomerFiles();},2000);// ì„ íƒëœ íŒŒì¼ ì´ˆê¸°í™”\nsetSelectedPdfFiles(prev=>_objectSpread(_objectSpread({},prev),{},{[fileType]:null}));// íŒŒì¼ ìž…ë ¥ ì´ˆê¸°í™” - í•´ë‹¹ IDì˜ ìž…ë ¥ë§Œ ì´ˆê¸°í™”\nconst fileInput=document.getElementById(\"pdf-\".concat(fileType));if(fileInput)fileInput.value='';}else{const error=await response.json();alert(\"PDF \\uC5C5\\uB85C\\uB4DC \\uC2E4\\uD328: \".concat(error.message));}}catch(error){console.error('PDF ì—…ë¡œë“œ ì¤‘ ì˜¤ë¥˜:',error);alert('PDF ì—…ë¡œë“œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');}};// ê³ ê° ì²¨ë¶€ ë‹¤ì¤‘ ì„ íƒ\nconst handleCustomerFileSelect=async e=>{var _e$target$files;const files=Array.from((_e$target$files=e.target.files)!==null&&_e$target$files!==void 0?_e$target$files:[]);if(files.length===0)return;setSelectedCustomerFiles(files);await uploadCustomerFiles(files);if(customerAddInputRef.current)customerAddInputRef.current.value='';};// ê³ ê° ì²¨ë¶€ ë‹¤ì¤‘ ì—…ë¡œë“œ (ResultFiles/customerì— ì—…ë¡œë“œ)\nconst uploadCustomerFiles=async files=>{if(files.length===0){alert('ì—…ë¡œë“œí•  íŒŒì¼ì„ ì„ íƒí•´ì£¼ì„¸ìš”.');return;}try{for(const file of files){const formData=new FormData();formData.append('file',file);// manager ì—…ë¡œë“œ + managerFileType=customer ë¡œ ì—…ë¡œë“œ â†’ ResultFiles/customerì— ì €ìž¥ë˜ë„ë¡ ë°±ì—”ë“œ ê·œì•½ ì‚¬ìš©\nconst response=await fetch(\"http://192.168.0.14:5135/api/estimate/sheets/\".concat(tempEstimateNo,\"/attachments?uploadUserID=admin&fileType=manager&managerFileType=customer\"),{method:'POST',body:formData});if(!response.ok){let msg='ê³ ê° íŒŒì¼ ì—…ë¡œë“œ ì‹¤íŒ¨';try{const er=await response.json();msg=er.message||msg;}catch(_unused){}console.error(msg);}}alert('ê³ ê° íŒŒì¼ ì—…ë¡œë“œê°€ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.');await fetchCustomerFiles();setSelectedCustomerFiles([]);}catch(err){console.error('ê³ ê° íŒŒì¼ ì—…ë¡œë“œ ì¤‘ ì˜¤ë¥˜:',err);alert('ê³ ê° íŒŒì¼ ì—…ë¡œë“œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');}};const handleUploadCustomerFiles=async()=>uploadCustomerFiles(selectedCustomerFiles);const handleGenerateDatasheet=async()=>{try{// TODO: ì‚¬ìš©ìžê°€ ë‚˜ì¤‘ì— ì œê³µí•  Datasheet ìƒì„± ë¡œì§\nalert('Datasheet ìƒì„± ê¸°ëŠ¥ì€ ì¤€ë¹„ ì¤‘ìž…ë‹ˆë‹¤.');}catch(error){console.error('Datasheet ìƒì„± ì˜¤ë¥˜:',error);alert('Datasheet ìƒì„± ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');}};// ì„œë¥˜ ìƒì„± í›„ ë‹¤ìš´ë¡œë“œ (í”„ë¡ íŠ¸ë§Œìœ¼ë¡œ ì²˜ë¦¬)\nconst generateAndDownload=async(type,endpoint)=>{if(!tempEstimateNo)return;setDocGenerating(prev=>_objectSpread(_objectSpread({},prev),{},{[type]:true}));try{// ë‹¨í’ˆ ê²¬ì ì„œ ë²„íŠ¼ í´ë¦­ ì‹œ: ë‹¨í’ˆ + ë‹¤ìˆ˜ëŸ‰ ê²¬ì ì„œë¥¼ ëª¨ë‘ ìƒì„±\nif(type==='singlequote'){console.log('ðŸ” ê²¬ì ì„œ ìƒì„± ì‹œìž‘ - ë‹¨í’ˆ + ë‹¤ìˆ˜ëŸ‰');// 1) ë‹¨í’ˆê²¬ì ì„œ ìƒì„±\nconsole.log('ðŸ“„ ë‹¨í’ˆê²¬ì ì„œ ìƒì„± ì¤‘...');const singleQuoteResp=await fetch(\"http://192.168.0.14:5135/api/estimate/sheets/\".concat(tempEstimateNo,\"/generate-single-quote\"),{method:'POST'});if(!singleQuoteResp.ok){const er=await singleQuoteResp.json().catch(()=>({}));throw new Error(\"\\uB2E8\\uD488\\uACAC\\uC801\\uC11C \\uC0DD\\uC131 \\uC2E4\\uD328: \".concat(er.message||'ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜'));}console.log('âœ… ë‹¨í’ˆê²¬ì ì„œ ìƒì„± ì™„ë£Œ');// 2) ë‹¤ìˆ˜ëŸ‰ê²¬ì ì„œ ìƒì„±\nconsole.log('ðŸ“„ ë‹¤ìˆ˜ëŸ‰ê²¬ì ì„œ ìƒì„± ì¤‘...');const multiQuoteResp=await fetch(\"http://192.168.0.14:5135/api/estimate/sheets/\".concat(tempEstimateNo,\"/generate-multi-quote\"),{method:'POST'});if(!multiQuoteResp.ok){const er=await multiQuoteResp.json().catch(()=>({}));throw new Error(\"\\uB2E4\\uC218\\uB7C9\\uACAC\\uC801\\uC11C \\uC0DD\\uC131 \\uC2E4\\uD328: \".concat(er.message||'ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜'));}console.log('âœ… ë‹¤ìˆ˜ëŸ‰ê²¬ì ì„œ ìƒì„± ì™„ë£Œ');// ìƒì„±ëœ ë‘ íŒŒì¼ ë‹¤ìš´ë¡œë“œ\nconsole.log('ðŸ“¥ ìƒì„±ëœ ê²¬ì ì„œ íŒŒì¼ ë‹¤ìš´ë¡œë“œ ì¤‘...');await downloadQuoteFiles();alert('ê²¬ì ì„œê°€ ì„±ê³µì ìœ¼ë¡œ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤!\\n- ë‹¨í’ˆê²¬ì ì„œ\\n- ë‹¤ìˆ˜ëŸ‰ê²¬ì ì„œ');return;}// ê¸°ì¡´ ë¡œì§ (ë‹¨ì¼ íƒ€ìž… ìƒì„±: cvlist, vllist, datasheet ë“±)\nconst resp=await fetch(\"http://192.168.0.14:5135/api/estimate/sheets/\".concat(tempEstimateNo,\"/\").concat(endpoint),{method:'POST'});if(!resp.ok){const er=await resp.json().catch(()=>({}));throw new Error(er.message||'ìƒì„± ì‹¤íŒ¨');}const pickLatest=list=>list.filter(f=>f.managerFileType===type).sort((a,b)=>new Date(b.uploadDate).getTime()-new Date(a.uploadDate).getTime())[0];// ìµœì´ˆ ì‹œë„\nlet list=await fetchManagerFiles();let target=pickLatest(list);// ìƒì„± ì§í›„ ì¸ë±ì‹± ì§€ì—° ëŒ€ë¹„ í´ë§(ìµœëŒ€ 5íšŒ, 600ms ê°„ê²©)\nlet retries=5;while(!target&&retries-->0){await new Promise(r=>setTimeout(r,600));list=await fetchManagerFiles();target=pickLatest(list);}if(!target)throw new Error('ìƒì„±ëœ íŒŒì¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ìƒˆë¡œê³ ì¹¨ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.');await downloadFile(target.filePath,target.fileName);}catch(e){alert(e.message||'ìƒì„± ì¤‘ ì˜¤ë¥˜');}finally{setDocGenerating(prev=>_objectSpread(_objectSpread({},prev),{},{[type]:false}));}};// ìƒì„±ëœ ê²¬ì ì„œ íŒŒì¼(ë‹¨í’ˆ/ë‹¤ìˆ˜ëŸ‰) ë‹¤ìš´ë¡œë“œ\nconst downloadQuoteFiles=async()=>{try{const list=await fetchManagerFiles();const singleQuote=list.filter(f=>f.managerFileType==='singlequote').sort((a,b)=>new Date(b.uploadDate).getTime()-new Date(a.uploadDate).getTime())[0];if(singleQuote){await downloadFile(singleQuote.filePath,singleQuote.fileName);}const multiQuote=list.filter(f=>f.managerFileType==='multiquote').sort((a,b)=>new Date(b.uploadDate).getTime()-new Date(a.uploadDate).getTime())[0];if(multiQuote){await downloadFile(multiQuote.filePath,multiQuote.fileName);}console.log('âœ… ê²¬ì ì„œ íŒŒì¼ ë‹¤ìš´ë¡œë“œ ì™„ë£Œ');}catch(error){console.error('ê²¬ì ì„œ íŒŒì¼ ë‹¤ìš´ë¡œë“œ ì¤‘ ì˜¤ë¥˜:',error);alert('ì¼ë¶€ ê²¬ì ì„œ íŒŒì¼ ë‹¤ìš´ë¡œë“œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');}};// ê²¬ì  ì„¸ë¶€ ì •ë³´ ë¯¸ë‹ˆ ì¹´ë“œ\nconst EstimateSummaryCard=()=>{const totalQty=(valves||[]).reduce((sum,v)=>sum+(Number(v===null||v===void 0?void 0:v.qty)||0),0);return/*#__PURE__*/_jsxs(\"div\",{className:\"step-section-detail estimate-summary-card\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"step-header-detail\",style:{marginBottom:4},children:/*#__PURE__*/_jsx(\"h3\",{children:\"\\uACAC\\uC801 \\uC138\\uBD80 \\uC815\\uBCF4\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"summary-grid\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"summary-row\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"k\",children:\"\\uACAC\\uC801\\uBC88\\uD638\"}),/*#__PURE__*/_jsx(\"span\",{className:\"v\",children:summaryEstimateNo}),/*#__PURE__*/_jsx(\"span\",{className:\"k\",children:\"\\uC0C1\\uD0DC\"}),/*#__PURE__*/_jsx(\"span\",{className:\"v\",children:currentStatus||'-'})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"summary-row\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"k\",children:\"\\uD68C\\uC0AC\\uBA85\"}),/*#__PURE__*/_jsx(\"span\",{className:\"v\",children:summaryCompanyName}),/*#__PURE__*/_jsx(\"span\",{className:\"k\",children:\"\\uC218\\uB7C9\"}),/*#__PURE__*/_jsx(\"span\",{className:\"v\",children:totalQty||'-'})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"summary-row\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"k\",children:\"\\uC694\\uCCAD\\uC790\"}),/*#__PURE__*/_jsx(\"span\",{className:\"v\",children:summaryRequesterName}),/*#__PURE__*/_jsx(\"span\",{className:\"k\",children:\"\\uC694\\uCCAD\\uC77C\\uC790\"}),/*#__PURE__*/_jsx(\"span\",{className:\"v\",children:summaryRequestDate})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"summary-row\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"k\",children:\"\\uB2F4\\uB2F9\\uC790\"}),/*#__PURE__*/_jsx(\"span\",{className:\"v\",children:summaryManager}),/*#__PURE__*/_jsx(\"span\",{className:\"k\",children:\"\\uC644\\uB8CC\\uC77C\\uC790\"}),/*#__PURE__*/_jsx(\"span\",{className:\"v\",children:summaryCompletedDate})]})]})]});};const handleStartQuote=async()=>{try{const userStr=localStorage.getItem('user');const currentUser=userStr?JSON.parse(userStr):null;const currentUserId=currentUser===null||currentUser===void 0?void 0:currentUser.userId;if(!tempEstimateNo||!currentUserId){alert('ë¡œê·¸ì¸ ì •ë³´ ë˜ëŠ” ê²¬ì ë²ˆí˜¸ê°€ ì—†ìŠµë‹ˆë‹¤.');return;}const res=await assignEstimate(tempEstimateNo,currentUserId);if(res&&(res.message||'').includes('ì™„ë£Œ')){// ìƒíƒœ í…ìŠ¤íŠ¸ ê°±ì‹ \nsetCurrentStatus('ê²¬ì ì²˜ë¦¬ì¤‘');setQuoteStarted(true);// ìƒì„¸ ì •ë³´ ìž¬ì¡°íšŒë¡œ í™”ë©´ ìµœì‹ í™”\nawait loadExistingData();}else{alert('ê²¬ì  ì‹œìž‘ ì²˜ë¦¬ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');}}catch(e){console.error(e);alert('ê²¬ì  ì‹œìž‘ ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');}};const handleEndQuote=()=>{alert('ê²¬ì  ë§ˆê°');};// ê²¬ì ì™„ë£Œ: CurEstimateNo ìƒì„± + ìƒíƒœ ë³€ê²½\nconst handleCompleteQuote=async()=>{if(!tempEstimateNo)return;try{const resp=await fetch(\"http://192.168.0.14:5135/api/estimate/sheets/\".concat(tempEstimateNo,\"/complete\"),{method:'POST'});if(!resp.ok){const er=await resp.json().catch(()=>({message:'ì²˜ë¦¬ ì‹¤íŒ¨'}));alert(er.message||'ì²˜ë¦¬ ì‹¤íŒ¨');return;}const data=await resp.json();const curNo=data.curEstimateNo;setSummaryEstimateNo(curNo||'-');setSummaryCompletedDate((()=>{const m=/YA(\\d{4})(\\d{2})(\\d{2})-(\\d{3})/.exec(curNo||'');return m?\"\".concat(m[1],\".\").concat(m[2],\".\").concat(m[3]):'-';})());setCurrentStatus('ê²¬ì ì™„ë£Œ');}catch(e){alert('ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜');}};// ì™„ë£Œ ì·¨ì†Œ(ì§„í–‰ì¤‘ìœ¼ë¡œ ë˜ëŒë¦¬ê¸°)\nconst handleCancelComplete=async()=>{if(!tempEstimateNo)return;try{const resp=await fetch(\"http://192.168.0.14:5135/api/estimate/sheets/\".concat(tempEstimateNo,\"/complete/cancel\"),{method:'POST'});if(!resp.ok)throw new Error('ì™„ë£Œì·¨ì†Œ ì‹¤íŒ¨');setCurrentStatus('ê²¬ì ì²˜ë¦¬ì¤‘');}catch(e){alert('ì™„ë£Œì·¨ì†Œ ì¤‘ ì˜¤ë¥˜');}};// ì£¼ë¬¸ í™•ì •\nconst handleConfirmOrder=async()=>{if(!tempEstimateNo)return;try{const resp=await fetch(\"http://192.168.0.14:5135/api/estimate/sheets/\".concat(tempEstimateNo,\"/order/confirm\"),{method:'POST'});if(!resp.ok)throw new Error('ì£¼ë¬¸í™•ì • ì‹¤íŒ¨');setCurrentStatus('ì£¼ë¬¸');}catch(e){alert('ì£¼ë¬¸í™•ì • ì¤‘ ì˜¤ë¥˜');}};const handleGenerateFile=async managerFileType=>{try{let apiEndpoint='';let fileTypeName='';switch(managerFileType){case'cvlist':apiEndpoint=\"http://192.168.0.14:5135/api/estimate/sheets/\".concat(tempEstimateNo,\"/generate-cv\");fileTypeName='CV ë¦¬ìŠ¤íŠ¸';break;case'vllist':apiEndpoint=\"http://192.168.0.14:5135/api/estimate/sheets/\".concat(tempEstimateNo,\"/generate-vl\");fileTypeName='VL ë¦¬ìŠ¤íŠ¸';break;case'datasheet':apiEndpoint=\"http://192.168.0.14:5135/api/estimate/sheets/\".concat(tempEstimateNo,\"/generate-datasheet\");fileTypeName='DataSheet';break;case'singlequote':apiEndpoint=\"http://192.168.0.14:5135/api/estimate/sheets/\".concat(tempEstimateNo,\"/generate-single-quote\");fileTypeName='ë‹¨í’ˆê²¬ì ì„œ';break;case'multiquote':apiEndpoint=\"http://192.168.0.14:5135/api/estimate/sheets/\".concat(tempEstimateNo,\"/generate-multi-quote\");fileTypeName='ë‹¤ìˆ˜ëŸ‰ê²¬ì ì„œ';break;default:alert('ì§€ì›í•˜ì§€ ì•ŠëŠ” íŒŒì¼ íƒ€ìž…ìž…ë‹ˆë‹¤.');return;}console.log(\"\".concat(fileTypeName,\" \\uC0DD\\uC131 \\uC2DC\\uC791:\"),tempEstimateNo);const response=await fetch(apiEndpoint,{method:'POST'});if(response.ok){const result=await response.json();alert(\"\".concat(fileTypeName,\"\\uAC00 \\uC131\\uACF5\\uC801\\uC73C\\uB85C \\uC0DD\\uC131\\uB418\\uC5C8\\uC2B5\\uB2C8\\uB2E4!\\n\\n\\uC0DD\\uC131\\uB41C \\uD30C\\uC77C:\\n\").concat(result.fileName));console.log(\"\".concat(fileTypeName,\" \\uC0DD\\uC131 \\uC131\\uACF5:\"),result);// ðŸ”‘ íŒŒì¼ ìƒì„± ì™„ë£Œ í›„ ìžë™ ìƒˆë¡œê³ ì¹¨ ì¶”ê°€\nawait fetchManagerFiles();await fetchCustomerFiles();// ê¸°ì¡´ ì²¨ë¶€íŒŒì¼ ëª©ë¡ë„ ìƒˆë¡œê³ ì¹¨\nloadExistingData();}else{const error=await response.json();alert(\"\".concat(fileTypeName,\" \\uC0DD\\uC131 \\uC2E4\\uD328: \").concat(error.message));console.error(\"\".concat(fileTypeName,\" \\uC0DD\\uC131 \\uC2E4\\uD328:\"),error);}}catch(error){console.error('íŒŒì¼ ìƒì„± ì˜¤ë¥˜:',error);alert('íŒŒì¼ ìƒì„± ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');}};// ì„ íƒê°’ì´ ë°”ë€” ë•Œë§ˆë‹¤ í˜„ìž¬ íƒœê·¸(sheetID)ë¡œ ìž„ì‹œ ì €ìž¥\nuseEffect(()=>{if(!selectedValve)return;setTempSelections(prev=>_objectSpread(_objectSpread({},prev),{},{[selectedValve.sheetID]:{body:_objectSpread({},bodySelections),trim:_objectSpread({},trimSelections),act:_objectSpread({},actSelections),acc:_objectSpread({},accSelections)}}));},[selectedValve===null||selectedValve===void 0?void 0:selectedValve.sheetID,bodySelections,trimSelections,actSelections,accSelections]);useEffect(()=>{var _selectedValve$body,_accSelections$positi,_accSelections$positi2,_accSelections$soleno,_accSelections$soleno2,_accSelections$limite,_accSelections$limite2,_accSelections$airSup,_accSelections$airSup2,_accSelections$volume,_accSelections$volume2,_accSelections$airOpe,_accSelections$airOpe2,_accSelections$lockUp,_accSelections$lockUp2,_accSelections$snapAc,_accSelections$snapAc2;if(!selectedValve)return;const dto={valveId:(selectedValve===null||selectedValve===void 0?void 0:(_selectedValve$body=selectedValve.body)===null||_selectedValve$body===void 0?void 0:_selectedValve$body.typeCode)||'',body:{bonnetType:bodySelections.bonnetType||'',materialBody:bodySelections.materialBody||'',rating:bodySelections.ratingCode||'',ratingUnit:bodySelections.ratingUnitCode||'',connection:bodySelections.connection||'',sizeUnit:bodySelections.sizeBodyUnitCode||'',size:bodySelections.sizeBodyCode||''},trim:{type:trimSelections.trimType||'',series:trimSelections.trimSeries||'',portSize:trimSelections.sizePortCode||'',portSizeUnit:trimSelections.sizePortUnitCode||'',form:trimSelections.form||'',materialTrim:trimSelections.materialTrim||'',option:trimSelections.option||''},actuator:{type:actSelections.actionType||'',series:actSelections.series||'',size:actSelections.size||'',hw:actSelections.hw||''},accessories:{PosCode:((_accSelections$positi=accSelections.positioner)===null||_accSelections$positi===void 0?void 0:_accSelections$positi.modelCode)||null,PosMakerCode:((_accSelections$positi2=accSelections.positioner)===null||_accSelections$positi2===void 0?void 0:_accSelections$positi2.makerCode)||null,SolCode:((_accSelections$soleno=accSelections.solenoid)===null||_accSelections$soleno===void 0?void 0:_accSelections$soleno.modelCode)||null,SolMakerCode:((_accSelections$soleno2=accSelections.solenoid)===null||_accSelections$soleno2===void 0?void 0:_accSelections$soleno2.makerCode)||null,LimCode:((_accSelections$limite=accSelections.limiter)===null||_accSelections$limite===void 0?void 0:_accSelections$limite.modelCode)||null,LimMakerCode:((_accSelections$limite2=accSelections.limiter)===null||_accSelections$limite2===void 0?void 0:_accSelections$limite2.makerCode)||null,ASCode:((_accSelections$airSup=accSelections.airSupply)===null||_accSelections$airSup===void 0?void 0:_accSelections$airSup.modelCode)||null,ASMakerCode:((_accSelections$airSup2=accSelections.airSupply)===null||_accSelections$airSup2===void 0?void 0:_accSelections$airSup2.makerCode)||null,VolCode:((_accSelections$volume=accSelections.volumeBooster)===null||_accSelections$volume===void 0?void 0:_accSelections$volume.modelCode)||null,VolMakerCode:((_accSelections$volume2=accSelections.volumeBooster)===null||_accSelections$volume2===void 0?void 0:_accSelections$volume2.makerCode)||null,AirOpCode:((_accSelections$airOpe=accSelections.airOperator)===null||_accSelections$airOpe===void 0?void 0:_accSelections$airOpe.modelCode)||null,AirOpMakerCode:((_accSelections$airOpe2=accSelections.airOperator)===null||_accSelections$airOpe2===void 0?void 0:_accSelections$airOpe2.makerCode)||null,LockupCode:((_accSelections$lockUp=accSelections.lockUp)===null||_accSelections$lockUp===void 0?void 0:_accSelections$lockUp.modelCode)||null,LockupMakerCode:((_accSelections$lockUp2=accSelections.lockUp)===null||_accSelections$lockUp2===void 0?void 0:_accSelections$lockUp2.makerCode)||null,SnapActCode:((_accSelections$snapAc=accSelections.snapActingRelay)===null||_accSelections$snapAc===void 0?void 0:_accSelections$snapAc.modelCode)||null,SnapActMakerCode:((_accSelections$snapAc2=accSelections.snapActingRelay)===null||_accSelections$snapAc2===void 0?void 0:_accSelections$snapAc2.makerCode)||null}};setSpecBySheetId(prev=>_objectSpread(_objectSpread({},prev),{},{[selectedValve.sheetID]:dto}));},[selectedValve===null||selectedValve===void 0?void 0:selectedValve.sheetID,bodySelections,trimSelections,actSelections,accSelections]);const handleDeleteManagerFile=async file=>{try{if(window.confirm('ì •ë§ë¡œ ì´ íŒŒì¼ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')){const response=await fetch(\"/api/estimate/attachments/\".concat(file.attachmentID),{method:'DELETE'});if(response.ok){alert('íŒŒì¼ì´ ì„±ê³µì ìœ¼ë¡œ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.');loadExistingData();// ì²¨ë¶€íŒŒì¼ ëª©ë¡ ìƒˆë¡œê³ ì¹¨\n}else{alert('íŒŒì¼ ì‚­ì œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');}}}catch(error){console.error('íŒŒì¼ ì‚­ì œ ì˜¤ë¥˜:',error);alert('íŒŒì¼ ì‚­ì œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');}};// ì‚¬ì–‘ ì €ìž¥ í•¨ìˆ˜\n// íƒœê·¸ë³„ ì„œë¡œ ë‹¤ë¥¸ ìž…ë ¥ì„ ìˆ˜ì§‘í•˜ê¸° ìœ„í•œ ìƒíƒœ\nconst[specBySheetId,setSpecBySheetId]=useState({});// selectedValve, bodySelections, trimSelections, actSelections, accSelections ë³€ê²½ ì‹œ ì €ìž¥\nuseEffect(()=>{var _selectedValve$body2;if(!selectedValve)return;const dto=buildSaveSpecFromSelections({body:bodySelections,trim:trimSelections,act:actSelections,acc:accSelections,valveTypeCode:(selectedValve===null||selectedValve===void 0?void 0:(_selectedValve$body2=selectedValve.body)===null||_selectedValve$body2===void 0?void 0:_selectedValve$body2.typeCode)||''});setSpecBySheetId(prev=>_objectSpread(_objectSpread({},prev),{},{[selectedValve.sheetID]:dto}));},[selectedValve===null||selectedValve===void 0?void 0:selectedValve.sheetID,bodySelections,trimSelections,actSelections,accSelections]);const handleSaveValveOrder=async()=>{const sheetIDs=valves.map(v=>v.sheetID);// í˜„ìž¬ í™”ë©´ ìˆœì„œëŒ€ë¡œ\nconst resp=await fetch(\"http://192.168.0.14:5135/api/estimate/sheets/\".concat(tempEstimateNo,\"/requests/order\"),{method:'PUT',headers:{'Content-Type':'application/json'},body:JSON.stringify(sheetIDs)});if(resp.ok){// ë¡œì»¬ ë³´ê¸°ìš© sheetNo ì‹±í¬\nsetValves(prev=>prev.map((v,i)=>_objectSpread(_objectSpread({},v),{},{sheetNo:i+1})));alert('ìˆœì„œê°€ ì €ìž¥ë˜ì—ˆìŠµë‹ˆë‹¤.');}else{alert('ìˆœì„œ ì €ìž¥ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');}};// ìˆœì„œ ì €ìž¥: í™”ë©´ì˜ valves ìˆœì„œë¥¼ SheetNoë¡œ ë°˜ì˜\nconst saveValveOrder=async()=>{if(!tempEstimateNo)return;const sheetIDs=valves.map(v=>v.sheetID);// ì „ì²´ ëª©ë¡ì˜ í˜„ìž¬ ìˆœì„œ\nawait fetch(\"http://192.168.0.14:5135/api/estimate/sheets/\".concat(tempEstimateNo,\"/requests/order\"),{method:'PUT',headers:{'Content-Type':'application/json'},body:JSON.stringify(sheetIDs)});};const handleSaveSpecification=useCallback(async()=>{try{var _selectedValve$body3;// 0) ìˆœì„œ ë¨¼ì € ì €ìž¥ â†’ SheetNo DB ë°˜ì˜\nawait saveValveOrder();// 1) ì¼ê´„ ì €ìž¥ ëŒ€ìƒ ê²°ì •(ì „ì²´)\nconst template=buildSaveSpecFromSelections({body:bodySelections,trim:trimSelections,act:actSelections,acc:accSelections,valveTypeCode:(selectedValve===null||selectedValve===void 0?void 0:(_selectedValve$body3=selectedValve.body)===null||_selectedValve$body3===void 0?void 0:_selectedValve$body3.typeCode)||''});const items=valves.map(v=>{var _specBySheetId$v$shee;return{sheetID:v.sheetID,specification:(_specBySheetId$v$shee=specBySheetId[v.sheetID])!==null&&_specBySheetId$v$shee!==void 0?_specBySheetId$v$shee:tempSelections[v.sheetID]?buildSaveSpecFromSelections({body:tempSelections[v.sheetID].body,trim:tempSelections[v.sheetID].trim,act:tempSelections[v.sheetID].act,acc:tempSelections[v.sheetID].acc}):template};});// 2) ì¼ê´„ ì‚¬ì–‘ ì €ìž¥\nconst resp=await fetch(\"http://192.168.0.14:5135/api/estimate/sheets/\".concat(tempEstimateNo,\"/specification/bulk\"),{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({items})});if(resp.ok)alert('ëª¨ë“  íƒœê·¸ì— ì‚¬ì–‘ì´ ì¼ê´„ ì €ìž¥ë˜ì—ˆìŠµë‹ˆë‹¤.');else alert('ì‚¬ì–‘ ì¼ê´„ ì €ìž¥ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');}catch(e){console.error(e);alert('ì‚¬ì–‘ ì¼ê´„ ì €ìž¥ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');}// ì˜ì¡´ì„±: valves, specBySheetId, tempSelections, bodySelections, trimSelections, actSelections, accSelections, selectedValve, tempEstimateNo\n},[valves,specBySheetId,tempSelections,bodySelections,trimSelections,actSelections,accSelections,selectedValve,tempEstimateNo]);const AccessorySelector=_ref5=>{let{accTypeKey,typeCode,currentAcc,accMakerList,accModelList,onAccessoryChange,isReadOnly}=_ref5;const[makerSearchTerm,setMakerSearchTerm]=useState('');const[modelSearchTerm,setModelSearchTerm]=useState('');const[specSearchTerm,setSpecSearchTerm]=useState('');const[isDropdownOpen,setIsDropdownOpen]=useState(false);const[isSelected,setIsSelected]=useState(false);// ì„ íƒ ì—¬ë¶€ ìƒíƒœ ì¶”ê°€\nconst dropdownRef=useRef(null);// ì»´í¬ë„ŒíŠ¸ ë§ˆìš´íŠ¸ ì‹œ ë””ë²„ê¹… ë¡œê·¸\nuseEffect(()=>{console.log(\"\\uD83D\\uDD0D AccessorySelector \".concat(accTypeKey,\" \\uB9C8\\uC6B4\\uD2B8:\"),{accTypeKey,typeCode,currentAcc,accMakerListLength:accMakerList.length,accModelListLength:accModelList.length});// accMakerListì™€ accModelListì˜ ë‚´ìš© í™•ì¸\nconsole.log(\"\\uD83D\\uDD0D \".concat(accTypeKey,\" - accMakerList \\uB0B4\\uC6A9:\"),accMakerList);console.log(\"\\uD83D\\uDD0D \".concat(accTypeKey,\" - accModelList \\uB0B4\\uC6A9 (\\uD0C0\\uC785\\uBCC4 \\uD544\\uD130\\uB9C1):\"),accModelList.filter(item=>item.accTypeCode===typeCode));},[accTypeKey,typeCode,currentAcc,accMakerList.length,accModelList.length,accMakerList,accModelList]);// ì»´í¬ë„ŒíŠ¸ ë§ˆìš´íŠ¸ ì‹œ ë˜ëŠ” accSelections ë³€ê²½ ì‹œ ìž…ë ¥ í•„ë“œ ì´ˆê¸°í™” ë° ì„ íƒ ìƒíƒœ ì„¤ì •\nuseEffect(()=>{if(currentAcc!==null&&currentAcc!==void 0&&currentAcc.modelCode){var _accMakerList$find,_accModelList$find;const selectedMakerName=((_accMakerList$find=accMakerList.find(maker=>maker.accMakerCode===(currentAcc===null||currentAcc===void 0?void 0:currentAcc.makerCode)&&maker.accTypeCode===typeCode))===null||_accMakerList$find===void 0?void 0:_accMakerList$find.accMakerName)||'';const selectedModelName=((_accModelList$find=accModelList.find(model=>model.accModelCode===(currentAcc===null||currentAcc===void 0?void 0:currentAcc.modelCode)&&model.accTypeCode===typeCode))===null||_accModelList$find===void 0?void 0:_accModelList$find.accModelName)||'';setMakerSearchTerm(selectedMakerName);setModelSearchTerm(selectedModelName);setSpecSearchTerm(currentAcc.specification||'');setIsSelected(true);// ëª¨ë¸ì´ ì´ë¯¸ ì„ íƒë˜ì–´ ìžˆìœ¼ë©´ isSelectedë¥¼ trueë¡œ\n}else{setMakerSearchTerm('');setModelSearchTerm('');setSpecSearchTerm('');setIsSelected(false);// ëª¨ë¸ì´ ì—†ìœ¼ë©´ isSelectedë¥¼ falseë¡œ\n}},[currentAcc,accMakerList,accModelList,typeCode]);// í†µí•© ê²€ìƒ‰ í•„í„°ë§ ë¡œì§\nconst filteredModels=useMemo(()=>{const allSearchTerms=[makerSearchTerm,modelSearchTerm,specSearchTerm].filter(term=>term);console.log('ðŸ” AccessorySelector ë””ë²„ê¹…:');console.log('  - accTypeKey:',accTypeKey);console.log('  - typeCode:',typeCode);console.log('  - accModelList ê¸¸ì´:',accModelList.length);console.log('  - accMakerList ê¸¸ì´:',accMakerList.length);if(allSearchTerms.length===0){// ê²€ìƒ‰ì–´ê°€ ì—†ìœ¼ë©´ í•´ë‹¹ íƒ€ìž… ì½”ë“œì™€ ì¼ì¹˜í•˜ëŠ” ì „ì²´ ëª¨ë¸ ë°˜í™˜\nconst filtered=accModelList.filter(item=>item.accTypeCode===typeCode);console.log('  - í•„í„°ë§ëœ ëª¨ë¸ ìˆ˜ (ê²€ìƒ‰ì–´ ì—†ìŒ):',filtered.length);console.log('  - í•„í„°ë§ëœ ëª¨ë¸ë“¤:',filtered);return filtered;}const lowerCaseSearchWords=allSearchTerms.map(term=>term.toLowerCase().split(' ').filter(word=>word)).flat();const filtered=accModelList.filter(item=>{var _accMakerList$find2;if(!typeCode||item.accTypeCode!==typeCode){return false;}const makerName=(((_accMakerList$find2=accMakerList.find(maker=>maker.accMakerCode===item.accMakerCode&&maker.accTypeCode===item.accTypeCode))===null||_accMakerList$find2===void 0?void 0:_accMakerList$find2.accMakerName)||'').toLowerCase();const modelName=(item.accModelName||'').toLowerCase();const specification=(item.accSize||'').toLowerCase();// ëª¨ë“  ê²€ìƒ‰ ë‹¨ì–´ë¥¼ ëª¨ë“  í•„ë“œì—ì„œ AND ê²€ìƒ‰\nreturn lowerCaseSearchWords.every(word=>makerName.includes(word)||modelName.includes(word)||specification.includes(word));});console.log('  - í•„í„°ë§ëœ ëª¨ë¸ ìˆ˜ (ê²€ìƒ‰ì–´ ìžˆìŒ):',filtered.length);console.log('  - í•„í„°ë§ëœ ëª¨ë¸ë“¤:',filtered);return filtered;},[makerSearchTerm,modelSearchTerm,specSearchTerm,accModelList,accMakerList,typeCode]);// ì•…ì„¸ì‚¬ë¦¬ ì„ íƒ í•¸ë“¤ëŸ¬\nconst handleSelectAccessory=selectedModel=>{var _accMakerList$find3;onAccessoryChange(_objectSpread(_objectSpread({},selectedModel),{},{typeCode:selectedModel.accTypeCode,makerCode:selectedModel.accMakerCode,modelCode:selectedModel.accModelCode,specification:selectedModel.accSize||''}));// ì„ íƒ ì‹œ ì„¸ ìž…ë ¥ í•„ë“œë¥¼ ì„ íƒëœ ê°’ìœ¼ë¡œ ì±„ìš°ê¸°\nconst selectedMakerName=((_accMakerList$find3=accMakerList.find(maker=>maker.accMakerCode===selectedModel.accMakerCode&&maker.accTypeCode===selectedModel.accTypeCode))===null||_accMakerList$find3===void 0?void 0:_accMakerList$find3.accMakerName)||'';setMakerSearchTerm(selectedMakerName);setModelSearchTerm(selectedModel.accModelName||'');setSpecSearchTerm(selectedModel.accSize||'');setIsDropdownOpen(false);setIsSelected(true);// ì„ íƒ ì™„ë£Œ ì‹œ isSelectedë¥¼ trueë¡œ\n};// ì„ íƒ í•´ì œ í•¸ë“¤ëŸ¬\nconst handleReset=()=>{onAccessoryChange(_objectSpread(_objectSpread({},currentAcc),{},{typeCode:typeCode||'',// ê¸°ì¡´ typeCode ìœ ì§€\nmakerCode:'',modelCode:'',specification:''}));setMakerSearchTerm('');setModelSearchTerm('');setSpecSearchTerm('');setIsSelected(false);// ì„ íƒ í•´ì œ ì‹œ isSelectedë¥¼ falseë¡œ\nsetIsDropdownOpen(false);// ë“œë¡­ë‹¤ìš´ ë‹«ê¸°\n};// ì™¸ë¶€ í´ë¦­ ê°ì§€ (ë“œë¡­ë‹¤ìš´ ë‹«ê¸°)\nuseEffect(()=>{const handleClickOutside=event=>{if(dropdownRef.current&&!dropdownRef.current.contains(event.target)){setIsDropdownOpen(false);}};document.addEventListener('mousedown',handleClickOutside);return()=>{document.removeEventListener('mousedown',handleClickOutside);};},[]);return/*#__PURE__*/_jsxs(\"div\",{className:\"accessory-selector\",ref:dropdownRef,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"input-group-detail\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"\\uBA54\\uC774\\uCEE4\",value:makerSearchTerm,onChange:e=>{if(!isSelected){setMakerSearchTerm(e.target.value);setIsDropdownOpen(true);}},onFocus:()=>{if(!isSelected)setIsDropdownOpen(true);},readOnly:isSelected||isReadOnly// isReadOnly ìƒíƒœì— ë”°ë¼ ì½ê¸° ì „ìš©\n}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"\\uBAA8\\uB378\\uBA85\",value:modelSearchTerm,onChange:e=>{if(!isSelected){setModelSearchTerm(e.target.value);setIsDropdownOpen(true);}},onFocus:()=>{if(!isSelected)setIsDropdownOpen(true);},readOnly:isSelected||isReadOnly}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"\\uADDC\\uACA9\",value:specSearchTerm,onChange:e=>{if(!isSelected){setSpecSearchTerm(e.target.value);setIsDropdownOpen(true);}},onFocus:()=>{if(!isSelected)setIsDropdownOpen(true);},readOnly:isSelected||isReadOnly}),isSelected&&/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:handleReset,className:\"reset-button\",disabled:isReadOnly,children:\"\\uCD08\\uAE30\\uD654\"})]}),isDropdownOpen&&/*#__PURE__*/_jsx(\"ul\",{className:\"dropdown-list\",children:filteredModels.length>0?filteredModels.map(item=>{var _accMakerList$find4;return/*#__PURE__*/_jsxs(\"li\",{onClick:()=>{if(!isReadOnly)handleSelectAccessory(item);}// isReadOnlyì¼ ë•Œ í´ë¦­ ë¶ˆê°€\n,children:[/*#__PURE__*/_jsx(\"span\",{className:\"dropdown-maker\",children:((_accMakerList$find4=accMakerList.find(maker=>maker.accMakerCode===item.accMakerCode))===null||_accMakerList$find4===void 0?void 0:_accMakerList$find4.accMakerName)||''}),/*#__PURE__*/_jsx(\"span\",{className:\"dropdown-model\",children:item.accModelName}),/*#__PURE__*/_jsx(\"span\",{className:\"dropdown-spec\",children:item.accSize||''})]},\"\".concat(item.accTypeCode,\"-\").concat(item.accMakerCode,\"-\").concat(item.accModelCode));}):/*#__PURE__*/_jsx(\"li\",{children:\"\\uAC80\\uC0C9 \\uACB0\\uACFC\\uAC00 \\uC5C6\\uC2B5\\uB2C8\\uB2E4.\"})})]});};// ì´ˆê¸°í™”\nuseEffect(()=>{console.log('EstimateDetailPage ì´ˆê¸°í™” ì‹œìž‘');fetchBodyValveList();fetchMasterData();},[]);// ì˜ì¡´ì„± ë°°ì—´ ë¹„ì›€ - ì´ˆê¸° ë¡œë“œë§Œ í•„ìš”\n// bodyValveListì™€ bodyRatingListê°€ ë¡œë“œëœ í›„ ê¸°ì¡´ ë°ì´í„° ë¡œë“œ\nuseEffect(()=>{console.log('useEffect ì‹¤í–‰:',{bodyValveListLength:bodyValveList.length,bodyRatingListLength:bodyRatingList.length,tempEstimateNo});if(bodyValveList.length>0&&bodyRatingList.length>0&&tempEstimateNo){console.log('loadExistingData í˜¸ì¶œ ì‹œìž‘');loadExistingData();}},[bodyValveList.length,bodyRatingList.length,tempEstimateNo]);// loadExistingData ì˜ì¡´ì„± ì œê±°\n// bodyValveListê°€ ë¡œë“œëœ í›„ íƒ€ìž… ì´ë¦„ì„ ì½”ë“œâ†’ì‹œë¦¬ì¦ˆëª…ìœ¼ë¡œ ë™ê¸°í™”\nuseEffect(()=>{if(bodyValveList.length>0){setTypes(prevTypes=>{let changed=false;const next=prevTypes.map(type=>{var _code;const key=(_code=type.code)!==null&&_code!==void 0?_code:type.id;const valveInfo=bodyValveList.find(v=>v.valveSeriesCode===key);const newName=valveInfo?valveInfo.valveSeries:type.name;if(newName!==type.name){changed=true;return _objectSpread(_objectSpread({},type),{},{name:newName});}return type;});return changed?next:prevTypes;});}},[bodyValveList]);// selectedValveê°€ ë³€ê²½ë  ë•Œë§ˆë‹¤ ê¸°ì¡´ ì‚¬ì–‘ ë°ì´í„° ë¡œë“œ\nuseEffect(()=>{if(selectedValve){// ì´ˆê¸° ë¡œë“œë§Œ í•„ìš”í•˜ë¯€ë¡œ ì—¬ê¸°ì„œëŠ” ì•„ë¬´ê²ƒë„ í•˜ì§€ ì•ŠìŒ\n// handleValveSelectionì—ì„œ ì²˜ë¦¬ë¨\n}},[selectedValve]);// selectedTypeì´ ë³€ê²½ë˜ë©´ selectedValveë¥¼ ì´ˆê¸°í™”í•˜ì—¬ Step 3ë¥¼ ìˆ¨ê¹€\nuseEffect(()=>{setSelectedValve(null);},[selectedType]);// ì´ˆê¸° ì‚¬ì–‘ ë°ì´í„° ë¡œë“œ (DBì—ì„œ ë¶ˆëŸ¬ì˜¤ê¸°)\nconst loadInitialSpecification=async sheetID=>{// ì´ë¯¸ ìž„ì‹œ ì €ìž¥ëœ ê°’ì´ ìžˆìœ¼ë©´ ì„œë²„ê°’ìœ¼ë¡œ ë®ì–´ì“°ì§€ ì•ŠìŒ\nif(tempSelections[sheetID]){const saved=tempSelections[sheetID];setBodySelections(saved.body||{});setTrimSelections(saved.trim||{});setActSelections(saved.act||{});setAccSelections(saved.acc||{});return;}try{if(!tempEstimateNo){console.error(\"tempEstimateNoê°€ ì—†ìŠµë‹ˆë‹¤.\");return;}const response=await fetch(\"http://192.168.0.14:5135/api/estimate/sheets/\".concat(tempEstimateNo,\"/specification/\").concat(sheetID));if(response.ok){const specificationData=await response.json();console.log('--- ì‹¤ì œ Accessories ë°ì´í„° êµ¬ì¡° ---',specificationData.accessories);if(specificationData.accessories){console.log('ê°œë³„ ì•…ì„¸ì‚¬ë¦¬ ë°ì´í„° (Positioner):',specificationData.accessories.positioner);console.log('ê°œë³„ ì•…ì„¸ì‚¬ë¦¬ ë°ì´í„° (Solenoid):',specificationData.accessories.solenoid);console.log('ê°œë³„ ì•…ì„¸ì‚¬ë¦¬ ë°ì´í„° (AirOperator):',specificationData.accessories.airOperator);console.log('ê°œë³„ ì•…ì„¸ì‚¬ë¦¬ ë°ì´í„° (LockUp):',specificationData.accessories.lockUp);}// Body ì‚¬ì–‘ ë°ì´í„° ì„¤ì • (ì´ˆê¸°ê°’ë§Œ) - null ì²˜ë¦¬ ê°œì„ \nif(specificationData.body){console.log('Body ë°ì´í„°:',specificationData.body);// Body ë°ì´í„° ë¡œê·¸ ì¶”ê°€\nsetBodySelections(prev=>_objectSpread(_objectSpread({},prev),{},{bonnetType:specificationData.body.bonnetTypeCode||'',bonnetTypeCode:specificationData.body.bonnetTypeCode||'',materialBody:specificationData.body.materialBodyCode||'',materialBodyCode:specificationData.body.materialBodyCode||'',sizeBodyUnit:specificationData.body.sizeUnit||'',sizeBody:specificationData.body.sizeCode||'',sizeBodyUnitCode:specificationData.body.sizeUnit||'',// Code ê°’ ì¶”ê°€\nsizeBodyCode:specificationData.body.sizeCode||'',// Code ê°’ ì¶”ê°€\nratingUnit:(()=>{if(specificationData.body.ratingUnit&&bodyRatingList.length>0){const ratingItem=bodyRatingList.find(item=>item.ratingUnitCode===specificationData.body.ratingUnit);return ratingItem?ratingItem.ratingUnit:'';}return'';})(),// ratingUnitCodeì— í•´ë‹¹í•˜ëŠ” ratingUnit ì´ë¦„ ì°¾ê¸°\nrating:specificationData.body.ratingCode||'',ratingUnitCode:(()=>{if(specificationData.body.ratingUnit&&bodyRatingList.length>0){const ratingItem=bodyRatingList.find(item=>item.ratingUnitCode===specificationData.body.ratingUnit);return ratingItem?ratingItem.ratingUnitCode:'';}return'';})(),// ratingUnitCodeì— í•´ë‹¹í•˜ëŠ” ratingUnitCode ì°¾ê¸°\nratingCode:specificationData.body.ratingCode||'',// Code ê°’ ì¶”ê°€\nconnection:specificationData.body.connectionCode||'',connectionCode:specificationData.body.connectionCode||''}));}// Trim ì‚¬ì–‘ ë°ì´í„° ì„¤ì • (ì´ˆê¸°ê°’ë§Œ) - null ì²˜ë¦¬ ê°œì„ \nif(specificationData.trim){console.log('Trim ë°ì´í„°:',specificationData.trim);// Trim ë°ì´í„° ë¡œê·¸ ì¶”ê°€\nsetTrimSelections(prev=>{var _specificationData$bo,_specificationData$bo2,_specificationData$bo3;return _objectSpread(_objectSpread({},prev),{},{trimType:specificationData.trim.typeCode||'',trimTypeCode:specificationData.trim.typeCode||'',trimSeries:specificationData.trim.seriesCode||'',trimSeriesCode:specificationData.trim.seriesCode||'',materialTrim:((_specificationData$bo=specificationData.body)===null||_specificationData$bo===void 0?void 0:_specificationData$bo.materialTrimCode)||'',materialTrimCode:((_specificationData$bo2=specificationData.body)===null||_specificationData$bo2===void 0?void 0:_specificationData$bo2.materialTrimCode)||'',sizePortUnit:specificationData.trim.portSizeUnit||'',sizePort:specificationData.trim.portSizeCode||'',sizePortUnitCode:specificationData.trim.portSizeUnit||'',// Code ê°’ ì¶”ê°€\nsizePortCode:specificationData.trim.portSizeCode||'',// Code ê°’ ì¶”ê°€\nform:specificationData.trim.formCode||'',formCode:specificationData.trim.formCode||'',option:((_specificationData$bo3=specificationData.body)===null||_specificationData$bo3===void 0?void 0:_specificationData$bo3.optionCode)||''// Bodyì—ì„œ Option ê°’ì„ ê°€ì ¸ì˜´\n});});}// Actuator ì‚¬ì–‘ ë°ì´í„° ì„¤ì • (ì´ˆê¸°ê°’ë§Œ) - null ì²˜ë¦¬ ê°œì„ \nif(specificationData.actuator){console.log('Actuator ë°ì´í„°:',specificationData.actuator);// Actuator ë°ì´í„° ë¡œê·¸ ì¶”ê°€\nconst seriesCode=specificationData.actuator.seriesCode||'';setActSelections(prev=>_objectSpread(_objectSpread({},prev),{},{actionType:specificationData.actuator.typeCode||'',actionTypeCode:specificationData.actuator.typeCode||'',series:seriesCode,seriesCode:seriesCode,size:specificationData.actuator.sizeCode||'',sizeCode:specificationData.actuator.sizeCode||'',hw:specificationData.actuator.hwCode||'',hwCode:specificationData.actuator.hwCode||''}));// Series ì½”ë“œê°€ ìžˆìœ¼ë©´ í•´ë‹¹ Size ëª©ë¡ì„ ê°€ì ¸ì˜´\nif(seriesCode){fetchActSizeList(seriesCode);}}// Accessory ì‚¬ì–‘ ë°ì´í„° ì„¤ì • - ê¸°ì¡´ ë°ì´í„°ê°€ ìžˆìœ¼ë©´ ë¡œë“œ, ì—†ìœ¼ë©´ fetchMasterDataì—ì„œ ì´ˆê¸°í™”ë¨\nif(specificationData.accessories){const newAccSelections={positioner:{typeCode:'Positioner',makerCode:'',modelCode:'',specification:''},solenoid:{typeCode:'Solenoid',makerCode:'',modelCode:'',specification:''},limiter:{typeCode:'Limit',makerCode:'',modelCode:'',specification:''},airSupply:{typeCode:'Airset',makerCode:'',modelCode:'',specification:''},volumeBooster:{typeCode:'Volume',makerCode:'',modelCode:'',specification:''},airOperator:{typeCode:'Airoperate',makerCode:'',modelCode:'',specification:''},lockUp:{typeCode:'Lockup',makerCode:'',modelCode:'',specification:''},snapActingRelay:{typeCode:'Snapacting',makerCode:'',modelCode:'',specification:''}};const accKeys=['positioner','solenoid','limiter','airSupply','volumeBooster','airOperator','lockUp','snapActingRelay'];accKeys.forEach(key=>{const accObj=specificationData.accessories[key];console.log(\"\\uB85C\\uB529\\uB420 \\uC545\\uC138\\uC0AC\\uB9AC \\uB370\\uC774\\uD130 (\".concat(String(key),\"):\"),accObj);// 1. ë°ì´í„° ê°œìˆ˜ í™•ì¸\nconsole.log('accModelList ê¸¸ì´:',accModelList.length);console.log('accMakerList ê¸¸ì´:',accMakerList.length);// 2. Positioner ë°ì´í„° í™•ì¸\nconsole.log('Positioner ëª¨ë¸ë“¤:',accModelList.filter(item=>item.accTypeCode==='Positioner'));console.log('Positioner ë©”ì´ì»¤ë“¤:',accMakerList.filter(item=>item.accTypeCode==='Positioner'));// 3. ë°ì´í„° êµ¬ì¡° í™•ì¸\nconsole.log('ì²« ë²ˆì§¸ ëª¨ë¸:',accModelList[0]);console.log('ì²« ë²ˆì§¸ ë©”ì´ì»¤:',accMakerList[0]);if(accObj&&accObj.makerCode&&accObj.modelCode){// ì‹¤ì œ ë°ì´í„°ê°€ ìžˆëŠ” ê²½ìš°ì—ë§Œ ì„¤ì •\nnewAccSelections[key]={typeCode:accObj.typeCode||newAccSelections[key].typeCode,makerCode:accObj.makerCode||'',modelCode:accObj.modelCode||'',specification:accObj.specification||''};console.log(\"\\uC0C8\\uB85C\\uC6B4 AccSelections (\".concat(String(key),\") \\uB370\\uC774\\uD130 \\uC124\\uC815\\uB428:\"),newAccSelections[key]);}// ë°ì´í„°ê°€ ì—†ìœ¼ë©´ ê¸°ë³¸ê°’ ìœ ì§€ (fetchMasterDataì—ì„œ ì„¤ì •ë¨)\n});console.log('ìµœì¢… ì—…ë°ì´íŠ¸ë  AccSelections:',newAccSelections);setAccSelections(newAccSelections);}// ì•¡ì„¸ì„œë¦¬ ë°ì´í„°ê°€ ì—†ëŠ” ê²½ìš° fetchMasterDataì—ì„œ ì´ˆê¸°í™”ë¨\n}else{console.log('API ì‘ë‹µ ì‹¤íŒ¨:',response.status,response.statusText);}}catch(error){console.log('ì´ˆê¸° ì‚¬ì–‘ ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨:',error);}};const saveOrder=async()=>{const sheetIDs=valves.map(v=>v.sheetID);const resp=await fetch(\"http://192.168.0.14:5135/api/estimate/sheets/\".concat(tempEstimateNo,\"/requests/order\"),{method:'PUT',headers:{'Content-Type':'application/json'},body:JSON.stringify(sheetIDs)});if(resp.ok){alert('ìˆœì„œê°€ ì €ìž¥ë˜ì—ˆìŠµë‹ˆë‹¤.');}else{alert('ìˆœì„œ ì €ìž¥ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');}};const handleDragStart=(e,index)=>{e.dataTransfer.setData('text/plain',String(index));};const handleDragOver=e=>{e.preventDefault();};const handleDrop=(e,dropIndex)=>{e.preventDefault();const dragIndex=Number(e.dataTransfer.getData('text/plain'));if(Number.isNaN(dragIndex))return;setValves(prev=>{const arr=[...prev];const[moved]=arr.splice(dragIndex,1);arr.splice(dropIndex,0,moved);return arr.map((it,i)=>_objectSpread(_objectSpread({},it),{},{sheetNo:i+1}));});};// TagNo ë³€ê²½ ì‹œ ìž„ì‹œ ì €ìž¥ëœ ì„ íƒê°’ ë³µì›\nconst restoreTempSelections=sheetID=>{const tempData=tempSelections[sheetID];if(tempData){console.log(\"\".concat(sheetID,\"\\uC758 \\uC784\\uC2DC \\uC800\\uC7A5\\uB41C \\uC120\\uD0DD\\uAC12\\uB4E4\\uC744 \\uBCF5\\uC6D0\\uD569\\uB2C8\\uB2E4:\"),tempData);// Body ì„ íƒê°’ ë³µì›\nif(tempData.body){setBodySelections(prev=>_objectSpread(_objectSpread({},prev),tempData.body));}// Trim ì„ íƒê°’ ë³µì›\nif(tempData.trim){setTrimSelections(prev=>_objectSpread(_objectSpread({},prev),tempData.trim));}// Actuator ì„ íƒê°’ ë³µì›\nif(tempData.act){setActSelections(prev=>_objectSpread(_objectSpread({},prev),tempData.act));}// Accessory ì„ íƒê°’ ë³µì›\nif(tempData.acc){setAccSelections(prev=>_objectSpread(_objectSpread({},prev),tempData.acc));}}else{console.log(\"\".concat(sheetID,\"\\uC758 \\uC784\\uC2DC \\uC800\\uC7A5\\uB41C \\uC120\\uD0DD\\uAC12\\uC774 \\uC5C6\\uC2B5\\uB2C8\\uB2E4.\"));}};// Step 1, 2, 3 í†µí•© ì„¹ì…˜\nconst StepsSection=()=>/*#__PURE__*/_jsxs(\"div\",{className:\"step-section-detail\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"step-header-detail\",children:/*#__PURE__*/_jsx(\"h3\",{children:\"\\uACAC\\uC801 \\uC0C1\\uC138 \\uC815\\uBCF4\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"steps-horizontal-container\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"step-col-detail\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"step-subsection-detail\",children:[/*#__PURE__*/_jsx(\"h4\",{children:\"Step 1: Type \\uC120\\uC815\"}),/*#__PURE__*/_jsx(\"div\",{className:\"type-list-detail\",children:types.map(type=>{var _bodyValveList$find;return/*#__PURE__*/_jsxs(\"div\",{className:\"type-item-detail \".concat(selectedType===type.id?'selected':''),onClick:()=>handleTypeSelection(type),children:[/*#__PURE__*/_jsx(\"span\",{className:\"type-name-detail\",children:((_bodyValveList$find=bodyValveList.find(v=>v.valveSeriesCode===type.id))===null||_bodyValveList$find===void 0?void 0:_bodyValveList$find.valveSeries)||type.name}),/*#__PURE__*/_jsxs(\"span\",{className:\"type-count\",children:[\"(\",type.count,\")\"]})]},type.id);})})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"step-col-detail\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"step-subsection-detail\",children:[/*#__PURE__*/_jsx(\"h4\",{children:\"Step 2: TagNo \\uC120\\uD0DD\"}),selectedType?/*#__PURE__*/_jsx(\"div\",{className:\"valve-list-detail\",children:valves.filter(valve=>valve.typeId===selectedType).map(valve=>{var _valve$sheetID2;const originalIndex=valves.findIndex(v=>{var _v$sheetID,_valve$sheetID;return((_v$sheetID=v.sheetID)!==null&&_v$sheetID!==void 0?_v$sheetID:v.id)===((_valve$sheetID=valve.sheetID)!==null&&_valve$sheetID!==void 0?_valve$sheetID:valve.id);});return/*#__PURE__*/_jsxs(\"div\",{className:\"valve-item-detail \".concat((selectedValve===null||selectedValve===void 0?void 0:selectedValve.id)===valve.id?'selected':''),onClick:()=>handleValveSelection(valve),children:[/*#__PURE__*/_jsx(\"span\",{className:\"valve-tag-detail\",children:valve.tagNo}),/*#__PURE__*/_jsxs(\"span\",{className:\"valve-qty-detail\",children:[\"(\",valve.qty,\")\"]})]},(_valve$sheetID2=valve.sheetID)!==null&&_valve$sheetID2!==void 0?_valve$sheetID2:valve.id);})}):/*#__PURE__*/_jsx(\"div\",{className:\"no-type-selected\",children:\"Step 1\\uC5D0\\uC11C Type\\uC744 \\uC120\\uD0DD\\uD558\\uC138\\uC694.\"})]})}),selectedValve&&/*#__PURE__*/_jsx(\"div\",{className:\"step-col-detail\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"step-subsection-detail\",children:[/*#__PURE__*/_jsx(\"h4\",{children:\"Step 3: \\uC0C1\\uC138\\uC0AC\\uC591 \\uC785\\uB825\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"specification-grid-detail\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"spec-section-detail\",children:[/*#__PURE__*/_jsx(\"h4\",{children:\"BODY\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"spec-grid-detail\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"spec-item-detail\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Bonnet Type:\"}),/*#__PURE__*/_jsxs(\"select\",{value:bodySelections.bonnetType,onChange:e=>handleBodyChange('bonnetType',e.target.value),disabled:isReadOnly,children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"\\uC120\\uD0DD\\uD558\\uC138\\uC694\"}),bodyBonnetList&&bodyBonnetList.length>0&&bodyBonnetList.map(item=>/*#__PURE__*/_jsx(\"option\",{value:item.bonnetCode,children:item.bonnet},item.bonnetCode))]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"spec-item-detail\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Material Body:\"}),/*#__PURE__*/_jsxs(\"select\",{value:bodySelections.materialBody,onChange:e=>handleBodyChange('materialBody',e.target.value),disabled:isReadOnly,children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"\\uC120\\uD0DD\\uD558\\uC138\\uC694\"}),bodyMatList&&bodyMatList.length>0&&bodyMatList.map(item=>/*#__PURE__*/_jsx(\"option\",{value:item.bodyMatCode,children:item.bodyMat},item.bodyMatCode))]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"spec-item-detail\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Size Body:\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"size-input-group-detail\",children:[/*#__PURE__*/_jsxs(\"select\",{value:bodySelections.sizeBodyUnitCode,onChange:e=>{handleBodyChange('sizeBodyUnit',e.target.value);handleBodyChange('sizeBodyUnitCode',e.target.value);},disabled:isReadOnly,children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Unit \\uC120\\uD0DD\"}),bodySizeList&&bodySizeList.length>0&&bodySizeList.map(item=>item.sizeUnitCode).filter((unit,index,arr)=>arr.indexOf(unit)===index).map(unit=>{// Unit ì½”ë“œë¥¼ ì‚¬ìš©ìž ì¹œí™”ì ì¸ ì´ë¦„ìœ¼ë¡œ ë³€í™˜\nlet displayName=unit;if(unit==='A')displayName='DN';if(unit==='I')displayName='inch';if(unit==='N')displayName='None';if(unit==='Z')displayName='SPECIAL';return/*#__PURE__*/_jsx(\"option\",{value:unit,children:displayName},unit);})]}),/*#__PURE__*/_jsxs(\"select\",{value:bodySelections.sizeBodyCode,onChange:e=>{const selectedItem=bodySizeList.find(item=>item.bodySizeCode===e.target.value);if(selectedItem){handleBodyChange('sizeBody',selectedItem.bodySize);handleBodyChange('sizeBodyCode',selectedItem.bodySizeCode);}},disabled:!bodySelections.sizeBodyUnit||isReadOnly,children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"\\uAC12 \\uC120\\uD0DD\"}),bodySelections.sizeBodyUnit&&bodySizeList&&bodySizeList.length>0&&bodySizeList.filter(item=>item.sizeUnitCode===bodySelections.sizeBodyUnit).map(item=>/*#__PURE__*/_jsxs(\"option\",{value:item.bodySizeCode,children:[item.bodySize,\" (\",item.sizeUnit,\")\"]},item.bodySizeCode))]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"spec-item-detail\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Rating:\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"rating-input-group-detail\",children:[/*#__PURE__*/_jsxs(\"select\",{value:bodySelections.ratingUnit,onChange:e=>{const selectedUnit=bodyRatingList.find(item=>item.ratingUnit===e.target.value);if(selectedUnit){handleBodyChange('ratingUnit',selectedUnit.ratingUnit);handleBodyChange('ratingUnitCode',selectedUnit.ratingUnitCode);}},disabled:isReadOnly,children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Unit \\uC120\\uD0DD\"}),bodyRatingList&&bodyRatingList.length>0&&bodyRatingList.map(item=>item.ratingUnit).filter((unit,index,arr)=>arr.indexOf(unit)===index).map(unit=>/*#__PURE__*/_jsx(\"option\",{value:unit,children:unit},unit))]}),/*#__PURE__*/_jsxs(\"select\",{value:bodySelections.ratingCode,onChange:e=>{const selectedItem=bodyRatingList.find(item=>item.ratingCode===e.target.value);if(selectedItem){handleBodyChange('rating',selectedItem.ratingName);handleBodyChange('ratingCode',selectedItem.ratingCode);}},disabled:!bodySelections.ratingUnitCode||isReadOnly,children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"\\uAC12 \\uC120\\uD0DD\"}),bodySelections.ratingUnit&&bodyRatingList&&bodyRatingList.length>0&&bodyRatingList.filter(item=>item.ratingUnit===bodySelections.ratingUnit).map(item=>/*#__PURE__*/_jsx(\"option\",{value:item.ratingCode,children:item.ratingName},item.ratingCode))]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"spec-item-detail\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Connection:\"}),/*#__PURE__*/_jsxs(\"select\",{value:bodySelections.connection,onChange:e=>handleBodyChange('connection',e.target.value),disabled:isReadOnly,children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"\\uC120\\uD0DD\\uD558\\uC138\\uC694\"}),bodyConnectionList&&bodyConnectionList.length>0&&bodyConnectionList.map(item=>/*#__PURE__*/_jsx(\"option\",{value:item.connectionCode,children:item.connection},item.connectionCode))]})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"spec-section-detail\",children:[/*#__PURE__*/_jsx(\"h4\",{children:\"Trim\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"spec-grid-detail\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"spec-item-detail\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Trim Type:\"}),/*#__PURE__*/_jsxs(\"select\",{value:trimSelections.trimType,onChange:e=>handleTrimChange('trimType',e.target.value),disabled:isReadOnly,children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"\\uC120\\uD0DD\\uD558\\uC138\\uC694\"}),trimTypeList&&trimTypeList.length>0&&trimTypeList.map(item=>/*#__PURE__*/_jsx(\"option\",{value:item.trimTypeCode,children:item.trimType},item.trimTypeCode))]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"spec-item-detail\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Trim Series:\"}),/*#__PURE__*/_jsxs(\"select\",{value:trimSelections.trimSeries,onChange:e=>handleTrimChange('trimSeries',e.target.value),disabled:isReadOnly,children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"\\uC120\\uD0DD\\uD558\\uC138\\uC694\"}),trimSeriesList&&trimSeriesList.length>0&&trimSeriesList.map(item=>/*#__PURE__*/_jsx(\"option\",{value:item.trimSeriesCode,children:item.trimSeries},item.trimSeriesCode))]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"spec-item-detail\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Material Trim:\"}),/*#__PURE__*/_jsxs(\"select\",{value:trimSelections.materialTrim,onChange:e=>handleTrimChange('materialTrim',e.target.value),disabled:isReadOnly,children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"\\uC120\\uD0DD\\uD558\\uC138\\uC694\"}),trimMatList&&trimMatList.length>0&&trimMatList.map(item=>/*#__PURE__*/_jsx(\"option\",{value:item.trimMatCode,children:item.trimMat},item.trimMatCode))]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"spec-item-detail\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Option:\"}),/*#__PURE__*/_jsxs(\"select\",{value:trimSelections.option,onChange:e=>handleTrimChange('option',e.target.value),disabled:isReadOnly,children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"\\uC120\\uD0DD\\uD558\\uC138\\uC694\"}),trimOptionList&&trimOptionList.length>0&&trimOptionList.map(item=>/*#__PURE__*/_jsx(\"option\",{value:item.trimOptionCode,children:item.trimOption},item.trimOptionCode))]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"spec-item-detail\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Size Port:\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"size-input-group-detail\",children:[/*#__PURE__*/_jsxs(\"select\",{value:trimSelections.sizePortUnitCode,onChange:e=>{handleTrimChange('sizePortUnit',e.target.value);handleTrimChange('sizePortUnitCode',e.target.value);},disabled:isReadOnly,children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Unit \\uC120\\uD0DD\"}),trimPortSizeList&&trimPortSizeList.length>0&&trimPortSizeList.map(item=>({unitCode:item.unitCode,unitName:item.unitName})).filter((item,index,arr)=>arr.findIndex(x=>x.unitCode===item.unitCode)===index).map(item=>/*#__PURE__*/_jsx(\"option\",{value:item.unitCode,children:item.unitName},item.unitCode))]}),/*#__PURE__*/_jsxs(\"select\",{value:trimSelections.sizePortCode,onChange:e=>{const selectedItem=trimPortSizeList.find(item=>item.portSizeCode===e.target.value);if(selectedItem){handleTrimChange('sizePort',selectedItem.portSize);handleTrimChange('sizePortCode',selectedItem.portSizeCode);}},disabled:!trimSelections.sizePortUnit||isReadOnly,children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"\\uAC12 \\uC120\\uD0DD\"}),trimSelections.sizePortUnit&&trimPortSizeList&&trimPortSizeList.length>0&&trimPortSizeList.filter(item=>item.unitCode===trimSelections.sizePortUnit).map(item=>/*#__PURE__*/_jsxs(\"option\",{value:item.portSizeCode,children:[item.portSize,\" (\",item.unitName,\")\"]},item.portSizeCode))]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"spec-item-detail\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Form:\"}),/*#__PURE__*/_jsxs(\"select\",{value:trimSelections.form,onChange:e=>handleTrimChange('form',e.target.value),disabled:isReadOnly,children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"\\uC120\\uD0DD\\uD558\\uC138\\uC694\"}),trimFormList&&trimFormList.length>0&&trimFormList.map(item=>/*#__PURE__*/_jsx(\"option\",{value:item.trimFormCode,children:item.trimForm},item.trimFormCode))]})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"spec-section-detail\",children:[/*#__PURE__*/_jsx(\"h4\",{children:\"ACT\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"spec-grid-detail\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"spec-item-detail\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Action Type:\"}),/*#__PURE__*/_jsxs(\"select\",{value:actSelections.actionType,onChange:e=>handleActChange('actionType',e.target.value),disabled:isReadOnly,children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"\\uC120\\uD0DD\\uD558\\uC138\\uC694\"}),actTypeList&&actTypeList.length>0&&actTypeList.map(item=>/*#__PURE__*/_jsx(\"option\",{value:item.actTypeCode,children:item.actType},item.actTypeCode))]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"spec-item-detail\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Series:\"}),/*#__PURE__*/_jsxs(\"select\",{value:actSelections.series,onChange:e=>handleActChange('series',e.target.value),disabled:isReadOnly,children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"\\uC120\\uD0DD\\uD558\\uC138\\uC694\"}),actSeriesList&&actSeriesList.length>0&&actSeriesList.map(item=>/*#__PURE__*/_jsx(\"option\",{value:item.actSeriesCode,children:item.actSeries},item.actSeriesCode))]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"spec-item-detail\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Size:\"}),/*#__PURE__*/_jsxs(\"select\",{value:actSelections.size,onChange:e=>handleActChange('size',e.target.value),disabled:!actSelections.series||isReadOnly,children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"\\uC120\\uD0DD\\uD558\\uC138\\uC694\"}),actSizeList&&actSizeList.length>0&&actSizeList.map(item=>/*#__PURE__*/_jsxs(\"option\",{value:item.actSizeCode,children:[item.actSize,\" \"]},item.actSizeCode))]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"spec-item-detail\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"H.W:\"}),/*#__PURE__*/_jsxs(\"select\",{value:actSelections.hw,onChange:e=>handleActChange('hw',e.target.value),disabled:isReadOnly,children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"\\uC120\\uD0DD\\uD558\\uC138\\uC694\"}),actHWList&&actHWList.length>0&&actHWList.map(item=>/*#__PURE__*/_jsx(\"option\",{value:item.hwCode,children:item.hw},item.hwCode))]})]})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"acc-section-detail\",children:[/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',justifyContent:'space-between',alignItems:'center',marginBottom:'10px'},children:[/*#__PURE__*/_jsx(\"h4\",{children:\"ACC\"}),/*#__PURE__*/_jsx(\"button\",{onClick:async()=>{console.log('ì•…ì„¸ì‚¬ë¦¬ ë°ì´í„° ê°•ì œ ë¦¬ë¡œë“œ ì‹œìž‘...');const success=await fetchAccessoryData();if(success){alert('ì•…ì„¸ì‚¬ë¦¬ ë°ì´í„°ê°€ ì„±ê³µì ìœ¼ë¡œ ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤!');}else{alert('ì•…ì„¸ì‚¬ë¦¬ ë°ì´í„° ë¡œë“œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.');}},style:{padding:'8px 16px',backgroundColor:'#007bff',color:'white',border:'none',borderRadius:'4px',cursor:'pointer',fontSize:'12px'},title:\"\\uC545\\uC138\\uC0AC\\uB9AC \\uB370\\uC774\\uD130 \\uAC15\\uC81C \\uB9AC\\uB85C\\uB4DC\",children:\"\\uD83D\\uDD04 \\uC545\\uC138\\uC0AC\\uB9AC \\uB9AC\\uB85C\\uB4DC\"}),/*#__PURE__*/_jsxs(\"span\",{style:{fontSize:'11px',color:'#666',marginLeft:'10px'},children:[\"\\uBA54\\uC774\\uCEE4: \",accMakerList.length,\"\\uAC1C, \\uBAA8\\uB378: \",accModelList.length,\"\\uAC1C\"]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"acc-table-detail\",children:/*#__PURE__*/_jsxs(\"table\",{children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"\\uC120\\uD0DD\\uBAA9\\uB85D\"}),/*#__PURE__*/_jsx(\"th\",{children:\"\\uBA54\\uC774\\uCEE4\"}),/*#__PURE__*/_jsx(\"th\",{children:\"\\uBAA8\\uB378\\uBA85\"}),/*#__PURE__*/_jsx(\"th\",{children:\"\\uADDC\\uACA9\"})]})}),/*#__PURE__*/_jsxs(\"tbody\",{children:[/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:\"Positioner\"}),/*#__PURE__*/_jsx(\"td\",{className:\"acc-options-group-detail\",colSpan:3,children:/*#__PURE__*/_jsx(AccessorySelector,{accTypeKey:\"positioner\",typeCode:\"Positioner\",currentAcc:accSelections.positioner,accMakerList:accMakerListByType.Positioner||[],accModelList:accModelListByType.Positioner||[],onAccessoryChange:accessory=>handleAccessoryChange('positioner',accessory),isReadOnly:isReadOnly})})]}),/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:\"Solenoid Valve\"}),/*#__PURE__*/_jsx(\"td\",{className:\"acc-options-group-detail\",colSpan:3,children:/*#__PURE__*/_jsx(AccessorySelector,{accTypeKey:\"solenoid\",typeCode:\"Solenoid\",currentAcc:accSelections.solenoid,accMakerList:accMakerListByType.Solenoid||[],accModelList:accModelListByType.Solenoid||[],onAccessoryChange:accessory=>handleAccessoryChange('solenoid',accessory),isReadOnly:isReadOnly})})]}),/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:\"Limit Switch\"}),/*#__PURE__*/_jsx(\"td\",{className:\"acc-options-group-detail\",colSpan:3,children:/*#__PURE__*/_jsx(AccessorySelector,{accTypeKey:\"limiter\",typeCode:\"Limit\",currentAcc:accSelections.limiter,accMakerList:accMakerListByType.Limit||[],accModelList:accModelListByType.Limit||[],onAccessoryChange:accessory=>handleAccessoryChange('limiter',accessory),isReadOnly:isReadOnly})})]}),/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:\"Air Set\"}),/*#__PURE__*/_jsx(\"td\",{className:\"acc-options-group-detail\",colSpan:3,children:/*#__PURE__*/_jsx(AccessorySelector,{accTypeKey:\"airSupply\",typeCode:\"Airset\",currentAcc:accSelections.airSupply,accMakerList:accMakerListByType.Airset||[],accModelList:accModelListByType.Airset||[],onAccessoryChange:accessory=>handleAccessoryChange('airSupply',accessory),isReadOnly:isReadOnly})})]}),/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:\"Volume Booster\"}),/*#__PURE__*/_jsx(\"td\",{className:\"acc-options-group-detail\",colSpan:3,children:/*#__PURE__*/_jsx(AccessorySelector,{accTypeKey:\"volumeBooster\",typeCode:\"Volume\",currentAcc:accSelections.volumeBooster,accMakerList:accMakerListByType.Volume||[],accModelList:accModelListByType.Volume||[],onAccessoryChange:accessory=>handleAccessoryChange('volumeBooster',accessory),isReadOnly:isReadOnly})})]}),/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:\"Air Operated Valve\"}),/*#__PURE__*/_jsx(\"td\",{className:\"acc-options-group-detail\",colSpan:3,children:/*#__PURE__*/_jsx(AccessorySelector,{accTypeKey:\"airOperator\",typeCode:\"Airoperate\",currentAcc:accSelections.airOperator,accMakerList:accMakerListByType.Airoperate||[],accModelList:accModelListByType.Airoperate||[],onAccessoryChange:accessory=>handleAccessoryChange('airOperator',accessory),isReadOnly:isReadOnly})})]}),/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:\"Lock-Up Valve\"}),/*#__PURE__*/_jsx(\"td\",{className:\"acc-options-group-detail\",colSpan:3,children:/*#__PURE__*/_jsx(AccessorySelector,{accTypeKey:\"lockUp\",typeCode:\"Lockup\",currentAcc:accSelections.lockUp,accMakerList:accMakerListByType.Lockup||[],accModelList:accModelListByType.Lockup||[],onAccessoryChange:accessory=>handleAccessoryChange('lockUp',accessory),isReadOnly:isReadOnly})})]}),/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:\"Snap Acting Relay\"}),/*#__PURE__*/_jsx(\"td\",{className:\"acc-options-group-detail\",colSpan:3,children:/*#__PURE__*/_jsx(AccessorySelector,{accTypeKey:\"snapActingRelay\",typeCode:\"Snapacting\",currentAcc:accSelections.snapActingRelay,accMakerList:accMakerListByType.Snapacting||[],accModelList:accModelListByType.Snapacting||[],onAccessoryChange:accessory=>handleAccessoryChange('snapActingRelay',accessory),isReadOnly:isReadOnly})})]})]})]})})]})]})})]})]});// ê³ ê° ìš”ì²­ì‚¬í•­ ì„¹ì…˜ (í•­ìƒ readonly)\nconst CustomerRequirementSection=()=>/*#__PURE__*/_jsxs(\"div\",{className:\"step-section-detail\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"step-header-detail\",children:/*#__PURE__*/_jsx(\"h3\",{children:\"\\uACE0\\uAC1D \\uC694\\uCCAD\\uC0AC\\uD56D\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"customer-requirement-content-detail\",children:/*#__PURE__*/_jsx(\"textarea\",{value:customerRequirement,onChange:()=>{}// ë³€ê²½ ë¶ˆê°€\n,readOnly:true// í•­ìƒ readonly\n,placeholder:\"\\uACE0\\uAC1D \\uC694\\uCCAD\\uC0AC\\uD56D\\uC774 \\uC5C6\\uC2B5\\uB2C8\\uB2E4.\",className:\"customer-requirement-textarea-detail\"})})]});// ê´€ë¦¬ìž ì½”ë©˜íŠ¸ ì„¹ì…˜\nconst StaffCommentSection=()=>/*#__PURE__*/_jsxs(\"div\",{className:\"step-section-detail\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"step-header-detail\",children:/*#__PURE__*/_jsx(\"h3\",{children:\"\\uAD00\\uB9AC\\uC790 \\uCF54\\uBA58\\uD2B8\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"staff-comment-content-detail\",children:/*#__PURE__*/_jsx(\"textarea\",{value:staffComment,onChange:e=>!isReadOnly&&setStaffComment(e.target.value),readOnly:isReadOnly,placeholder:\"\\uAD00\\uB9AC\\uC790 \\uCF54\\uBA58\\uD2B8\\uAC00 \\uC5C6\\uC2B5\\uB2C8\\uB2E4.\",className:\"staff-comment-textarea-detail\"})})]});// ê³ ê° ìš”ì²­ ì²¨ë¶€íŒŒì¼ ì„¹ì…˜ (ë‹¤ìš´ë¡œë“œë§Œ ê°€ëŠ¥)\nconst CustomerAttachmentsSection=()=>/*#__PURE__*/_jsxs(\"div\",{className:\"step-section-detail\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"step-header-detail\",children:/*#__PURE__*/_jsx(\"h3\",{children:\"\\uACE0\\uAC1D \\uC694\\uCCAD \\uCCA8\\uBD80\\uD30C\\uC77C\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"attachments-content\",children:customerAttachments.length>0?/*#__PURE__*/_jsx(\"div\",{className:\"attachment-list-detail\",children:customerAttachments.map((file,index)=>/*#__PURE__*/_jsxs(\"div\",{className:\"attachment-item-detail\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"file-name-detail\",children:file.fileName}),/*#__PURE__*/_jsxs(\"span\",{className:\"file-size-detail\",children:[\"(\",(file.fileSize/1024).toFixed(2),\" KB)\"]}),/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-primary btn-sm\",onClick:()=>handleDownloadFile(file,'customer'),disabled:!file.fileName.toLowerCase().endsWith('.pdf'),children:\"PDF \\uB2E4\\uC6B4\\uB85C\\uB4DC\"})]},index))}):/*#__PURE__*/_jsx(\"div\",{className:\"no-attachments\",children:\"\\uACE0\\uAC1D \\uC694\\uCCAD \\uCCA8\\uBD80\\uD30C\\uC77C\\uC774 \\uC5C6\\uC2B5\\uB2C8\\uB2E4.\"})})]});// ê´€ë¦¬ ì²¨ë¶€íŒŒì¼ ì„¹ì…˜ (ì—…ë¡œë“œ, ë‹¤ìš´ë¡œë“œ, ìƒì„± ê°€ëŠ¥)\nconst ManagerAttachmentsSection=()=>/*#__PURE__*/_jsxs(\"div\",{className:\"step-section-detail\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"step-header-detail\",children:/*#__PURE__*/_jsx(\"h3\",{children:\"\\uACAC\\uC801 \\uC11C\\uB958 \\uBC1C\\uAE09\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"doc-issue-list\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"doc-item\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"doc-label\",children:\"CV LIST\"}),/*#__PURE__*/_jsx(\"button\",{className:\"icon-download \".concat(docGenerating['cvlist']?'loading':''),title:\"\\uC0DD\\uC131 \\uD6C4 \\uB2E4\\uC6B4\\uB85C\\uB4DC\",onClick:()=>generateAndDownload('cvlist','generate-cv'),disabled:!!docGenerating['cvlist'],children:docGenerating['cvlist']?'â³':'â¬‡ï¸'})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"doc-item\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"doc-label\",children:\"VALVE LIST\"}),/*#__PURE__*/_jsx(\"button\",{className:\"icon-download \".concat(docGenerating['vllist']?'loading':''),title:\"\\uC0DD\\uC131 \\uD6C4 \\uB2E4\\uC6B4\\uB85C\\uB4DC\",onClick:()=>generateAndDownload('vllist','generate-vl'),disabled:!!docGenerating['vllist'],children:docGenerating['vllist']?'â³':'â¬‡ï¸'})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"doc-item\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"doc-label\",children:\"DATA SHEET\"}),/*#__PURE__*/_jsx(\"button\",{className:\"icon-download \".concat(docGenerating['datasheet']?'loading':''),title:\"\\uC0DD\\uC131 \\uD6C4 \\uB2E4\\uC6B4\\uB85C\\uB4DC\",onClick:()=>generateAndDownload('datasheet','generate-datasheet'),disabled:!!docGenerating['datasheet'],children:docGenerating['datasheet']?'â³':'â¬‡ï¸'})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"doc-item\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"doc-label\",children:\"\\uACAC\\uC801\\uC11C\"}),/*#__PURE__*/_jsx(\"button\",{className:\"icon-download \".concat(docGenerating['singlequote']?'loading':''),title:\"\\uC0DD\\uC131 \\uD6C4 \\uB2E4\\uC6B4\\uB85C\\uB4DC\",onClick:()=>generateAndDownload('singlequote','generate-single-quote'),disabled:!!docGenerating['singlequote'],children:docGenerating['singlequote']?'â³':'â¬‡ï¸'})]})]})]});useEffect(()=>{if(tempEstimateNo){loadExistingData();// ðŸ”‘ íŒŒì¼ ëª©ë¡ ì¡°íšŒ ì¶”ê°€\nfetchManagerFiles();fetchCustomerFiles();}},[tempEstimateNo,loadExistingData]);// loadExistingData ì¶”ê°€\nuseEffect(()=>{// typesì™€ accModelListê°€ ëª¨ë‘ ë¡œë“œëœ í›„ì—ë§Œ loadInitialSpecificationì„ í˜¸ì¶œ\nif(tempEstimateNo&&types.length>0&&accModelList.length>0){if(selectedValve&&selectedValve.sheetID>0){loadInitialSpecification(selectedValve.sheetID);}}},[selectedValve===null||selectedValve===void 0?void 0:selectedValve.sheetID,tempEstimateNo,types,accModelList]);// typesì™€ accModelList ì¶”ê°€\n// ì‹œìž‘ ì·¨ì†Œ í•¸ë“¤ëŸ¬\nconst handleCancelStart=async()=>{if(!tempEstimateNo)return;if(window.confirm('ê²¬ì  ì‹œìž‘ì„ ì·¨ì†Œí•˜ì‹œê² ìŠµë‹ˆê¹Œ? ë‹´ë‹¹ìž ë°°ì •ì´ í•´ì œë˜ê³  \"ê²¬ì ìš”ì²­\" ìƒíƒœë¡œ ëŒì•„ê°‘ë‹ˆë‹¤.')){try{const response=await fetch(\"http://192.168.0.14:5135/api/estimate/sheets/\".concat(tempEstimateNo,\"/cancel-start\"),{method:'POST'});if(response.ok){alert('ê²¬ì  ì‹œìž‘ì´ ì·¨ì†Œë˜ì—ˆìŠµë‹ˆë‹¤.');setCurrentStatus('ê²¬ì ìš”ì²­');loadExistingData();// ë°ì´í„° ìƒˆë¡œê³ ì¹¨\n}else{const errorText=await response.text();alert(\"\\uC2DC\\uC791 \\uCDE8\\uC18C\\uC5D0 \\uC2E4\\uD328\\uD588\\uC2B5\\uB2C8\\uB2E4: \".concat(errorText));}}catch(error){console.error('ì‹œìž‘ ì·¨ì†Œ ì¤‘ ì˜¤ë¥˜ ë°œìƒ:',error);alert('ì‹œìž‘ ì·¨ì†Œ ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');}}};// ì£¼ë¬¸ ì·¨ì†Œ í•¸ë“¤ëŸ¬\nconst handleCancelOrder=async()=>{if(!tempEstimateNo)return;if(window.confirm('ì •ë§ë¡œ ì£¼ë¬¸ì„ ì·¨ì†Œí•˜ì‹œê² ìŠµë‹ˆê¹Œ? \"ê²¬ì ì™„ë£Œ\" ìƒíƒœë¡œ ëŒì•„ê°‘ë‹ˆë‹¤.')){try{const response=await fetch(\"http://192.168.0.14:5135/api/estimate/sheets/\".concat(tempEstimateNo,\"/order/cancel\"),{method:'POST'});if(response.ok){alert('ì£¼ë¬¸ì´ ì·¨ì†Œë˜ì—ˆìŠµë‹ˆë‹¤.');setCurrentStatus('ê²¬ì ì™„ë£Œ');loadExistingData();// ë°ì´í„° ìƒˆë¡œê³ ì¹¨\n}else{const errorText=await response.text();alert(\"\\uC8FC\\uBB38 \\uCDE8\\uC18C\\uC5D0 \\uC2E4\\uD328\\uD588\\uC2B5\\uB2C8\\uB2E4: \".concat(errorText));}}catch(error){console.error('ì£¼ë¬¸ ì·¨ì†Œ ì¤‘ ì˜¤ë¥˜ ë°œìƒ:',error);alert('ì£¼ë¬¸ ì·¨ì†Œ ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');}}};// ì•…ì„¸ì‚¬ë¦¬ ë³€ê²½ í•¸ë“¤ëŸ¬\nconst handleAccessoryChange=(accTypeKey,accessory)=>{setAccSelections(prev=>_objectSpread(_objectSpread({},prev),{},{[accTypeKey]:accessory}));const sid=selectedValve===null||selectedValve===void 0?void 0:selectedValve.sheetID;if(sid)setAccSelectionsBySheet(prevMap=>{var _prevMap$sid;return _objectSpread(_objectSpread({},prevMap),{},{[sid]:_objectSpread(_objectSpread({},(_prevMap$sid=prevMap===null||prevMap===void 0?void 0:prevMap[sid])!==null&&_prevMap$sid!==void 0?_prevMap$sid:accSelections),{},{[accTypeKey]:accessory})});});};// ì•¡ì¶”ì—ì´í„° ë³€ê²½ í•¸ë“¤ëŸ¬\nif(isLoadingFiles){return/*#__PURE__*/_jsx(\"div\",{className:\"loading\",children:\"\\uB85C\\uB529 \\uC911...\"});}return/*#__PURE__*/_jsxs(\"div\",{className:\"estimate-detail-page dashboard-page\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"page-header-detail\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"back-button-detail\",onClick:()=>navigate(-1),children:\"\\u2190 \\uACAC\\uC801\\uC694\\uCCAD\"}),/*#__PURE__*/_jsx(\"h1\",{children:\"\\uC0AC\\uC591 \\uC120\\uC815\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mini-tools-panel\",children:[/*#__PURE__*/_jsx(EstimateSummaryCard,{}),/*#__PURE__*/_jsx(ManagerAttachmentsSection,{}),/*#__PURE__*/_jsxs(\"div\",{className:\"step-section-detail customer-uploader\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"uploader-header\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"\\uACE0\\uAC1D \\uC81C\\uCD9C \\uBB38\\uC11C \\uC5C5\\uB85C\\uB4DC\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"header-actions-detail\",children:[/*#__PURE__*/_jsx(\"input\",{ref:customerAddInputRef,type:\"file\",multiple:true,onChange:handleCustomerFileSelect,accept:\".pdf,.doc,.docx,.xls,.xlsx,.ppt,.pptx,.hwp,.txt,.zip,.rar,.7z,.csv,.json\",style:{display:'none'}}),/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-light btn-xs\",onClick:()=>{var _customerAddInputRef$;return(_customerAddInputRef$=customerAddInputRef.current)===null||_customerAddInputRef$===void 0?void 0:_customerAddInputRef$.click();},children:\"\\uCD94\\uAC00\"})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"uploader-list\",children:isLoadingFiles?/*#__PURE__*/_jsx(\"div\",{className:\"loading\",style:{padding:8},children:\"\\uB85C\\uB529 \\uC911\\u2026\"}):customerFiles.length===0?/*#__PURE__*/_jsx(\"div\",{className:\"no-files\",style:{padding:8,color:'#6c757d'},children:\"\\uC5C5\\uB85C\\uB4DC\\uB41C \\uD30C\\uC77C\\uC774 \\uC5C6\\uC2B5\\uB2C8\\uB2E4.\"}):customerFiles.map(file=>{const name=file.fileName||'';const ext=(name.split('.').pop()||'').toLowerCase();return/*#__PURE__*/_jsxs(\"div\",{className:\"uploader-item\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"file-icon ext-\".concat(ext),\"aria-hidden\":true}),/*#__PURE__*/_jsx(\"span\",{className:\"file-name-detail\",title:name,children:name}),/*#__PURE__*/_jsx(\"button\",{className:\"remove-btn\",onClick:()=>deleteAttachmentById(file.attachmentID),children:\"\\u2715\"})]},file.attachmentID);})})]}),/*#__PURE__*/_jsx(\"div\",{className:\"quote-actions\",children:(()=>{// ëª…í™•í•œ ìƒíƒœ ê¸°ë°˜ ë¶„ê¸° ì²˜ë¦¬\nif(currentStatus==='ê²¬ì ìš”ì²­'){return/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-success\",onClick:handleStartQuote,children:\"\\uACAC\\uC801\\uC2DC\\uC791\"});}if(currentStatus==='ê²¬ì ì²˜ë¦¬ì¤‘'){return/*#__PURE__*/_jsxs(\"div\",{className:\"button-column\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-primary\",onClick:handleCompleteQuote,children:\"\\uACAC\\uC801\\uC644\\uB8CC\"}),/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-danger\",onClick:handleCancelStart,children:\"\\uC2DC\\uC791\\uCDE8\\uC18C\"})]});}if(currentStatus==='ê²¬ì ì™„ë£Œ'){return/*#__PURE__*/_jsxs(\"div\",{className:\"button-column\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-success\",onClick:handleConfirmOrder,children:\"\\uC8FC\\uBB38\\uD655\\uC815\"}),/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-danger\",onClick:handleCancelComplete,children:\"\\uC644\\uB8CC\\uCDE8\\uC18C\"})]});}if(currentStatus==='ì£¼ë¬¸'){return/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-danger\",onClick:handleCancelOrder,children:\"\\uC8FC\\uBB38\\uCDE8\\uC18C\"});}// ê·¸ ì™¸ì˜ ê²½ìš° (ë¡œë”© ì¤‘ ë“±)ëŠ” ë²„íŠ¼ì„ í‘œì‹œí•˜ì§€ ì•ŠìŒ\nreturn null;})()})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"status-section-detail\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"project-group-detail\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"\\uD504\\uB85C\\uC81D\\uD2B8\\uBA85:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:projectName,readOnly:isReadOnly,className:\"project-input-detail\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"save-section\",children:/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-primary save-specification-btn\",onClick:handleSaveSpecification,disabled:isReadOnly// isReadOnly ìƒíƒœì— ë”°ë¼ ë¹„í™œì„±í™”\n,children:\"\\uC0AC\\uC591 \\uC800\\uC7A5\"})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"main-content-detail\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"steps-container-detail\",children:[/*#__PURE__*/_jsx(StepsSection,{}),/*#__PURE__*/_jsxs(\"div\",{className:\"customer-request-block-detail\",children:[/*#__PURE__*/_jsx(CustomerRequirementSection,{}),/*#__PURE__*/_jsx(CustomerAttachmentsSection,{})]}),/*#__PURE__*/_jsx(StaffCommentSection,{})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"part-number-section\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-semibold text-gray-800 mb-4\",children:\"\\uC0DD\\uC131\\uB41C \\uD488\\uBC88\"}),/*#__PURE__*/_jsx(\"div\",{className:\"part-number-single-line\",children:generatePartNumber().split('').map((char,index)=>/*#__PURE__*/_jsx(\"div\",{className:\"char-box \".concat(char==='0'?'empty-char':'filled-char'),title:\"\\uC704\\uCE58 \".concat(index,\": \").concat(char),children:char},index))})]})]})]});};export default EstimateDetailPage;","map":{"version":3,"names":["React","useState","useEffect","useCallback","useRef","useMemo","useNavigate","useParams","getEstimateDetail","assignEstimate","jsx","_jsx","jsxs","_jsxs","isManagerFile","filePath","normalizedPath","replace","managerFilePatterns","some","pattern","includes","extractManagerFileType","pathParts","split","resultFilesIndex","findIndex","part","length","isCustomerFile","customerFilePatterns","isResultCustomerFile","toLowerCase","EstimateDetailPage","navigate","tempEstimateNo","types","setTypes","valves","setValves","selectedValve","setSelectedValve","selectedType","setSelectedType","bodyValveList","setBodyValveList","bodySizeList","setBodySizeList","bodyMatList","setBodyMatList","trimMatList","setTrimMatList","trimOptionList","setTrimOptionList","bodyRatingList","setBodyRatingList","bodyBonnetList","setBodyBonnetList","bodyConnectionList","setBodyConnectionList","trimTypeList","setTrimTypeList","trimSeriesList","setTrimSeriesList","trimPortSizeList","setTrimPortSizeList","trimFormList","setTrimFormList","actTypeList","setActTypeList","actSeriesList","setActSeriesList","actSizeList","setActSizeList","actHWList","setActHWList","accMakerList","setAccMakerList","accModelList","setAccModelList","accMakerListByType","setAccMakerListByType","accModelListByType","setAccModelListByType","customerRequirement","setCustomerRequirement","staffComment","setStaffComment","attachments","setAttachments","customerAttachments","setCustomerAttachments","managerAttachments","setManagerAttachments","currentStatus","setCurrentStatus","isReadOnly","setIsReadOnly","managerFiles","setManagerFiles","customerFiles","setCustomerFiles","isLoadingFiles","setIsLoadingFiles","selectedPdfFiles","setSelectedPdfFiles","datasheet","cvlist","vllist","singlequote","multiquote","uploadedPdfUrls","setUploadedPdfUrls","quoteStarted","setQuoteStarted","docGenerating","setDocGenerating","summaryEstimateNo","setSummaryEstimateNo","summaryCompanyName","setSummaryCompanyName","summaryRequesterName","setSummaryRequesterName","summaryRequestDate","setSummaryRequestDate","summaryManager","setSummaryManager","summaryCompletedDate","setSummaryCompletedDate","fileInputRefs","selectedCustomerFiles","setSelectedCustomerFiles","customerAddInputRef","accSelections","setAccSelections","positioner","typeCode","makerCode","modelCode","specification","solenoid","limiter","airSupply","volumeBooster","airOperator","lockUp","snapActingRelay","tempSelections","setTempSelections","buildSaveSpecFromSelections","sel","_sel$body","_sel$body2","_sel$body3","_sel$body4","_sel$body5","_sel$body6","_sel$body7","_sel$trim","_sel$trim2","_sel$trim3","_sel$trim4","_sel$trim5","_sel$trim6","_sel$trim7","_sel$trim8","_sel$act","_sel$act2","_sel$act3","_sel$act4","_sel$acc","_sel$acc$positioner","_sel$acc2","_sel$acc2$positioner","_sel$acc3","_sel$acc3$solenoid","_sel$acc4","_sel$acc4$solenoid","_sel$acc5","_sel$acc5$limiter","_sel$acc6","_sel$acc6$limiter","_sel$acc7","_sel$acc7$airSupply","_sel$acc8","_sel$acc8$airSupply","_sel$acc9","_sel$acc9$volumeBoost","_sel$acc0","_sel$acc0$volumeBoost","_sel$acc1","_sel$acc1$airOperator","_sel$acc10","_sel$acc10$airOperato","_sel$acc11","_sel$acc11$lockUp","_sel$acc12","_sel$acc12$lockUp","_sel$acc13","_sel$acc13$snapActing","_sel$acc14","_sel$acc14$snapActing","valveId","valveTypeCode","body","bonnetType","materialBody","rating","ratingCode","ratingUnit","ratingUnitCode","connection","sizeUnit","sizeBodyUnitCode","size","sizeBodyCode","trim","type","trimType","series","trimSeries","portSize","sizePortCode","portSizeUnit","sizePortUnitCode","form","formCode","materialTrim","option","actuator","act","actionType","hw","accessories","PosCode","acc","PosMakerCode","SolCode","SolMakerCode","LimCode","LimMakerCode","ASCode","ASMakerCode","VolCode","VolMakerCode","AirOpCode","AirOpMakerCode","LockupCode","LockupMakerCode","SnapActCode","SnapActMakerCode","saveCurrentSelections","sheetID","prev","_objectSpread","bodySelections","trimSelections","actSelections","handleValveSelection","valve","saved","setBodySelections","setTrimSelections","setActSelections","loadInitialSpecification","handleTypeSelection","id","bonnetTypeCode","materialBodyCode","sizeBodyUnit","sizeBody","connectionCode","trimTypeCode","trimSeriesCode","materialTrimCode","sizePortUnit","sizePort","actionTypeCode","seriesCode","sizeCode","hwCode","INITIAL_BODY","INITIAL_TRIM","INITIAL_ACT","INITIAL_ACC","bodySelectionsBySheet","setBodySelectionsBySheet","trimSelectionsBySheet","setTrimSelectionsBySheet","actSelectionsBySheet","setActSelectionsBySheet","accSelectionsBySheet","setAccSelectionsBySheet","_bodySelectionsByShee","_trimSelectionsByShee","_actSelectionsBySheet","_accSelectionsBySheet","sid","_bodySelectionsByShee2","_trimSelectionsByShee2","_actSelectionsBySheet2","_accSelectionsBySheet2","currentActSelections","fetchActSizeList","projectName","setProjectName","fetchBodyValveList","response","fetch","ok","console","error","status","statusText","data","json","actSeriesCode","log","concat","fetchManagerFiles","allManagerFiles","filter","att","path","isManagerFileResult","name","fileName","map","managerFileType","fetchCustomerFiles","files","onlyResultCustomer","deleteFile","window","confirm","method","alert","deleteAttachmentById","attachmentID","e","downloadFile","encodeURIComponent","blob","url","URL","createObjectURL","a","document","createElement","href","download","appendChild","click","revokeObjectURL","removeChild","errorText","text","getFileTypeDisplayName","typeMap","formatFileSize","bytes","decimals","arguments","undefined","k","sizes","i","Math","floor","parseFloat","pow","toFixed","formatDate","dateString","Date","toLocaleString","handlePdfUpload","event","fileType","_event$target$files","preventDefault","file","target","setTimeout","handleFileSelect","input","accept","style","display","onchange","handleBodyChange","field","value","newSelections","selectedItem","find","item","bonnetCode","bodyMatCode","prevMap","handleTrimChange","handleActChange","fetchAccessoryData","retryCount","maxRetries","accSearchRes","accSearchData","Object","keys","allAccMakerData","allAccModelData","groupedByType","reduce","accTypeCode","push","entries","forEach","_ref","items","typeItems","existingMaker","maker","accMakerCode","accMakerName","accModelCode","accModelName","accSize","_ref2","uniqueMakers","Set","Array","from","typeMakers","index","makerCountByType","makerDataByType","modelDataByType","model","key","initialAccSelections","fetchMasterData","sizeRes","matRes","trimMatRes","optionRes","ratingRes","Promise","all","sizeData","matData","trimMatData","optionData","ratingData","bodyBonnetRes","bodyConnectionRes","trimTypeRes","trimSeriesRes","trimPortSizeRes","trimFormRes","actTypeRes","actSeriesRes","actHWRes","onDragStart","listKey","dataTransfer","setData","JSON","stringify","onDragOver","onDrop","dropIndex","parse","getData","arr","moved","splice","it","sheetNo","bodyBonnetData","bodyConnectionData","trimTypeData","trimSeriesData","trimPortSizeData","trimFormData","actTypeData","actSeriesData","actHWData","generatePartNumber","bodySection","join","trimSection","actSection","accSection","loadExistingData","_ref3","_es$curEstimateNo","_data$estimateSheet","_data$estimateSheet2","userStr","localStorage","getItem","currentUser","userId","estimateSheet","project","es","tempNo","TempEstimateNo","curNo","curEstimateNo","CurEstimateNo","customerName","CustomerName","customerUserName","CustomerUserName","managerId","managerID","ManagerID","managerName","ManagerName","parseFromTemp","no","m","exec","parseFromCur","isStatusThree","isCurrentUserManager","shouldBeReadOnly","estimateRequests","_data$estimateRequest","tagNos","_data$estimateRequest2","_data$estimateRequest3","Map","req","valveType","has","get","count","sum","tag","qty","totalQty","set","order","typesData","_ref4","code","info","valveInfo","v","valveSeriesCode","valveSeries","sortedTypesData","sort","b","_data$estimateRequest4","_data$estimateRequest5","_data$estimateRequest6","_data$estimateRequest7","aFirstTag","bFirstTag","aSheetNo","bSheetNo","valvesData","_tag$sheetNo","bodyTypeName","ratingInfo","r","bodyRating","tagNo","typeId","fluid","medium","density","molecular","molecularWeight","t1","max","inletTemperatureQ","normal","inletTemperatureNorQ","min","inletTemperatureMinQ","p1","inletPressureMaxQ","inletPressureNorQ","inletPressureMinQ","p2","outletPressureMaxQ","outletPressureNorQ","outletPressureMinQ","dp","differentialPressureMaxQ","differentialPressureNorQ","differentialPressureMinQ","qm","qmMax","qmNor","qmMin","unit","qmUnit","qn","qnMax","qnNor","qnMin","qnUnit","pressureUnit","temperatureUnit","bodySize","bodySizeUnit","bodyMat","trimMat","trimOption","actType","isHW","accessory","positionerType","exists","isPositioner","explosionProof","transmitter","transmitterType","solenoidValve","isSolenoid","limitSwitch","isLimSwitch","airSet","isAirSet","isVolumeBooster","airOperatedValve","isAirOperated","lockupValve","isLockUp","isSnapActingRelay","isQM","isP2","isN1","isDensity","fileList","fileSize","handleStatusChange","newStatus","getStatusCodeFromText","newStatusCode","Error","estimateResponse","estimateData","headers","_estimateData$estimat","errorData","message","handleDownloadFile","endsWith","handleUploadManagerFile","formData","FormData","append","fileInput","getElementById","handleCustomerFileSelect","_e$target$files","uploadCustomerFiles","current","msg","er","_unused","err","handleUploadCustomerFiles","handleGenerateDatasheet","generateAndDownload","endpoint","singleQuoteResp","catch","multiQuoteResp","downloadQuoteFiles","resp","pickLatest","list","f","uploadDate","getTime","retries","singleQuote","multiQuote","EstimateSummaryCard","Number","className","children","marginBottom","handleStartQuote","currentUserId","res","handleEndQuote","handleCompleteQuote","handleCancelComplete","handleConfirmOrder","handleGenerateFile","apiEndpoint","fileTypeName","result","_selectedValve$body","_accSelections$positi","_accSelections$positi2","_accSelections$soleno","_accSelections$soleno2","_accSelections$limite","_accSelections$limite2","_accSelections$airSup","_accSelections$airSup2","_accSelections$volume","_accSelections$volume2","_accSelections$airOpe","_accSelections$airOpe2","_accSelections$lockUp","_accSelections$lockUp2","_accSelections$snapAc","_accSelections$snapAc2","dto","setSpecBySheetId","handleDeleteManagerFile","specBySheetId","_selectedValve$body2","handleSaveValveOrder","sheetIDs","saveValveOrder","handleSaveSpecification","_selectedValve$body3","template","_specBySheetId$v$shee","AccessorySelector","_ref5","accTypeKey","currentAcc","onAccessoryChange","makerSearchTerm","setMakerSearchTerm","modelSearchTerm","setModelSearchTerm","specSearchTerm","setSpecSearchTerm","isDropdownOpen","setIsDropdownOpen","isSelected","setIsSelected","dropdownRef","accMakerListLength","accModelListLength","_accMakerList$find","_accModelList$find","selectedMakerName","selectedModelName","filteredModels","allSearchTerms","term","filtered","lowerCaseSearchWords","word","flat","_accMakerList$find2","makerName","modelName","every","handleSelectAccessory","selectedModel","_accMakerList$find3","handleReset","handleClickOutside","contains","addEventListener","removeEventListener","ref","placeholder","onChange","onFocus","readOnly","onClick","disabled","_accMakerList$find4","bodyValveListLength","bodyRatingListLength","prevTypes","changed","next","_code","newName","specificationData","ratingItem","_specificationData$bo","_specificationData$bo2","_specificationData$bo3","portSizeCode","optionCode","newAccSelections","accKeys","accObj","String","saveOrder","handleDragStart","handleDragOver","handleDrop","dragIndex","isNaN","restoreTempSelections","tempData","StepsSection","_bodyValveList$find","_valve$sheetID2","originalIndex","_v$sheetID","_valve$sheetID","bonnet","sizeUnitCode","indexOf","displayName","bodySizeCode","selectedUnit","ratingName","trimMatCode","trimOptionCode","unitCode","unitName","x","trimFormCode","trimForm","actTypeCode","actSeries","actSizeCode","actSize","justifyContent","alignItems","success","padding","backgroundColor","color","border","borderRadius","cursor","fontSize","title","marginLeft","colSpan","Positioner","handleAccessoryChange","Solenoid","Limit","Airset","Volume","Airoperate","Lockup","Snapacting","CustomerRequirementSection","StaffCommentSection","CustomerAttachmentsSection","ManagerAttachmentsSection","handleCancelStart","handleCancelOrder","_prevMap$sid","multiple","_customerAddInputRef$","ext","pop","char"],"sources":["/Users/simjimin/Downloads/final_develop/projec/frontend/src/pages/Dashboard/EstimateDetailPage.tsx"],"sourcesContent":["import React, { useState, useEffect, useCallback, useRef, useMemo } from 'react';\nimport { useNavigate, useParams } from 'react-router-dom';\nimport { getEstimateDetail, assignEstimate } from '../../api/estimateRequest';\nimport './DashboardPages.css';\nimport './EstimateDetailPage.css';\n\n// ë‹¨ìœ„/ì‚¬ì´ì¦ˆ ë§ˆìŠ¤í„° ë°ì´í„° íƒ€ìž…\ninterface BodySizeListDto {\n  sizeUnitCode: string;  // RatingUnitCodeì™€ ë™ì¼í•œ íŒ¨í„´\n  bodySizeCode: string;\n  bodySize: string;\n  sizeUnit: string;      // RatingUnitê³¼ ë™ì¼í•œ íŒ¨í„´\n}\n\ninterface TrimPortSizeListDto {\n  portSizeCode: string;\n  unitCode: string;\n  portSize: string;\n  unitName: string;  // ë‹¨ìœ„ëª… (inch, mm ë“±)\n}\n\n// í¬ë¡œìŠ¤í”Œëž«í¼ ê²½ë¡œ ì²˜ë¦¬ë¥¼ ìœ„í•œ ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜\nconst isManagerFile = (filePath: string): boolean => {\n  if (!filePath) return false;\n  \n  // Windowsì™€ Unix ê²½ë¡œ ëª¨ë‘ ì§€ì›\n  const normalizedPath = filePath.replace(/\\\\/g, '/'); // Windows ë°±ìŠ¬ëž˜ì‹œë¥¼ ìŠ¬ëž˜ì‹œë¡œ ë³€í™˜\n  \n  // ë‹¤ì–‘í•œ ê²½ë¡œ íŒ¨í„´ ì§€ì›\n  const managerFilePatterns = [\n    '/ResultFiles/',\n    '\\\\ResultFiles\\\\',\n    'ResultFiles/',\n    'ResultFiles\\\\'\n  ];\n  \n  return managerFilePatterns.some(pattern => normalizedPath.includes(pattern));\n};\n\n// ê²½ë¡œì—ì„œ managerFileType ì¶”ì¶œí•˜ëŠ” í¬ë¡œìŠ¤í”Œëž«í¼ í•¨ìˆ˜\nconst extractManagerFileType = (filePath: string): string | null => {\n  if (!filePath) return null;\n  \n  const normalizedPath = filePath.replace(/\\\\/g, '/');\n  const pathParts = normalizedPath.split('/');\n  const resultFilesIndex = pathParts.findIndex(part => part === 'ResultFiles');\n  \n  if (resultFilesIndex !== -1 && resultFilesIndex + 1 < pathParts.length) {\n    return pathParts[resultFilesIndex + 1];\n  }\n  \n  return null;\n};\n\n// CustomerRequest íŒŒì¼ì¸ì§€ í™•ì¸í•˜ëŠ” í¬ë¡œìŠ¤í”Œëž«í¼ í•¨ìˆ˜ (í•˜ìœ„ ê³ ê°ìš”ì²­ ì²¨ë¶€ ì˜ì—­ì— ì‚¬ìš©)\nconst isCustomerFile = (filePath: string): boolean => {\n  if (!filePath) return false;\n  \n  const normalizedPath = filePath.replace(/\\\\/g, '/');\n  \n  const customerFilePatterns = [\n    '/CustomerRequest/',\n    '\\\\CustomerRequest\\\\',\n    'CustomerRequest/',\n    'CustomerRequest\\\\'\n  ];\n  \n  return customerFilePatterns.some(pattern => normalizedPath.includes(pattern));\n};\n\n// ResultFiles/customer íŒŒì¸ì§€ í™•ì¸ (ìƒë‹¨ \"ê³ ê° ì œì¶œ ë¬¸ì„œ ì—…ë¡œë“œ\" ì „ìš©)\nconst isResultCustomerFile = (filePath: string): boolean => {\n  if (!filePath) return false;\n  const normalizedPath = filePath.replace(/\\\\/g, '/').toLowerCase();\n  return normalizedPath.includes('/resultfiles/customer/');\n};\n\ninterface AccessorySelectorProps {\n  accTypeKey: string;\n  typeCode: string;\n  currentAcc: { typeCode: string; makerCode: string; modelCode: string; specification: string; };\n  accMakerList: any[];\n  accModelList: any[];\n  onAccessoryChange: (accessory: any) => void;\n  isReadOnly: boolean;\n}\n\ninterface ValveData {\n  id: string;\n  tagNo: string;\n  qty: number;\n  order: number;\n  sheetID: number;\n  typeId: string;\n  fluid: {\n    medium: string;\n    fluid: string;\n    density: string;\n    molecular: string;\n    t1: { max: number; normal: number; min: number; };\n    p1: { max: number; normal: number; min: number; };\n    p2: { max: number; normal: number; min: number; };\n    dp: { max: number; normal: number; min: number; };\n    qm: { max: number; normal: number; min: number; unit: string; };\n    qn: { max: number; normal: number; min: number; unit: string; };\n    pressureUnit: string;\n    temperatureUnit: string;\n  };\n  body: {\n    type: string;\n    typeCode: string;\n    size: string;\n    sizeUnit: string;\n    materialBody: string;\n    materialTrim: string;\n    option: string;\n    rating: string;\n    ratingUnit: string;\n  };\n  actuator: {\n    type: string;\n    hw: string;\n  };\n  accessory: {\n    positioner: { type: string; exists: boolean; };\n    explosionProof: string;\n    transmitter: { type: string; exists: boolean; };\n    solenoidValve: boolean;\n    limitSwitch: boolean;\n    airSet: boolean;\n    volumeBooster: boolean;\n    airOperatedValve: boolean;\n    lockupValve: boolean;\n    snapActingRelay: boolean;\n  };\n  isQM: boolean;\n  isP2: boolean;\n  isN1: boolean;\n  isDensity: boolean;\n  isHW: boolean;\n}\n\ninterface TypeData {\n  id: string;\n  name: string;\n  code: string;\n  count: number;\n  order: number;\n}\n\ninterface BodyValveData {\n  valveSeries: string;\n  valveSeriesCode: string;\n}\n\n\n\n// ðŸ”‘ íŒŒì¼ ê´€ë ¨ íƒ€ìž… ì¶”ê°€\ninterface EstimateAttachment {\n  attachmentID: number;\n  tempEstimateNo: string;\n  fileName: string;\n  filePath: string;\n  fileSize: number;\n  uploadDate: string;\n  uploadUserID: string | null;\n  managerFileType: string;\n}\n\nconst EstimateDetailPage: React.FC = () => {\n  const navigate = useNavigate();\n  const { tempEstimateNo } = useParams<{ tempEstimateNo: string }>();\n  \n  // ìƒíƒœ ê´€ë¦¬\n  const [types, setTypes] = useState<TypeData[]>([]);\n  const [valves, setValves] = useState<ValveData[]>([]);\n  const [selectedValve, setSelectedValve] = useState<ValveData | null>(null);\n  const [selectedType, setSelectedType] = useState<string>('');\n  \n  // ë§ˆìŠ¤í„° ë°ì´í„°\n  const [bodyValveList, setBodyValveList] = useState<BodyValveData[]>([]);\n  const [bodySizeList, setBodySizeList] = useState<BodySizeListDto[]>([]);\n  const [bodyMatList, setBodyMatList] = useState<any[]>([]);\n  const [trimMatList, setTrimMatList] = useState<any[]>([]);\n  const [trimOptionList, setTrimOptionList] = useState<any[]>([]);\n  const [bodyRatingList, setBodyRatingList] = useState<any[]>([]);\n  \n  // Step 3 ë§ˆìŠ¤í„° ë°ì´í„°\n  const [bodyBonnetList, setBodyBonnetList] = useState<any[]>([]);\n  const [bodyConnectionList, setBodyConnectionList] = useState<any[]>([]);\n  const [trimTypeList, setTrimTypeList] = useState<any[]>([]);\n  const [trimSeriesList, setTrimSeriesList] = useState<any[]>([]);\n  const [trimPortSizeList, setTrimPortSizeList] = useState<TrimPortSizeListDto[]>([]);\n  const [trimFormList, setTrimFormList] = useState<any[]>([]);\n  const [actTypeList, setActTypeList] = useState<any[]>([]);\n  const [actSeriesList, setActSeriesList] = useState<any[]>([]);\n  const [actSizeList, setActSizeList] = useState<any[]>([]);\n  const [actHWList, setActHWList] = useState<any[]>([]);\n  const [accMakerList, setAccMakerList] = useState<any[]>([]);\n  const [accModelList, setAccModelList] = useState<any[]>([]);\n  const [accMakerListByType, setAccMakerListByType] = useState<{ [key: string]: any[] }>({});\n  const [accModelListByType, setAccModelListByType] = useState<{ [key: string]: any[] }>({});\n  \n  // ê¸°íƒ€ ë°ì´í„°\n  const [customerRequirement, setCustomerRequirement] = useState(''); // ê³ ê° ìš”ì²­ì‚¬í•­\n  const [staffComment, setStaffComment] = useState(''); // ê´€ë¦¬ìž ì½”ë©˜íŠ¸\n  const [attachments, setAttachments] = useState<File[]>([]);\n  const [customerAttachments, setCustomerAttachments] = useState<any[]>([]); // ê³ ê° ìš”ì²­ ì²¨ë¶€íŒŒì¼\n  const [managerAttachments, setManagerAttachments] = useState<any[]>([]); // ê´€ë¦¬ ì²¨ë¶€íŒŒì¼\n  const [currentStatus, setCurrentStatus] = useState<string>('ê²¬ì ìš”ì²­');\n  const [isReadOnly, setIsReadOnly] = useState(false); // ì½ê¸° ì „ìš© ìƒíƒœ \n\n  // ðŸ”‘ íŒŒì¼ ê´€ë¦¬ ìƒíƒœ ì¶”ê°€\n  const [managerFiles, setManagerFiles] = useState<EstimateAttachment[]>([]);\n  const [customerFiles, setCustomerFiles] = useState<EstimateAttachment[]>([]);\n  const [isLoadingFiles, setIsLoadingFiles] = useState(false);\n\n  // ðŸ”‘ PDF ì—…ë¡œë“œ ê´€ë ¨ state ì¶”ê°€\n  const [selectedPdfFiles, setSelectedPdfFiles] = useState<{ [key: string]: File | null }>({\n    datasheet: null,\n    cvlist: null,\n    vllist: null,\n    singlequote: null,\n    multiquote: null\n  });\n\n  // ðŸ”‘ PDF ë·°ì–´ë¥¼ ìœ„í•œ state ì¶”ê°€\n  const [uploadedPdfUrls, setUploadedPdfUrls] = useState<{ [key: string]: string | null }>({\n    datasheet: null,\n    cvlist: null,\n    vllist: null,\n    singlequote: null,\n    multiquote: null\n  });\n\n  // ê²¬ì  ì‹œìž‘ ì—¬ë¶€(UI í† ê¸€)\n  const [quoteStarted, setQuoteStarted] = useState(false);\n  // ì„œë¥˜ ë°œê¸‰ ìƒì„±/ë‹¤ìš´ë¡œë“œ ì§„í–‰ ìƒíƒœ\n  const [docGenerating, setDocGenerating] = useState<Record<string, boolean>>({});\n  // ìš”ì•½ì¹´ë“œ í‘œì‹œê°’ ìƒíƒœ\n  const [summaryEstimateNo, setSummaryEstimateNo] = useState<string>('-');\n  const [summaryCompanyName, setSummaryCompanyName] = useState<string>('-');\n  const [summaryRequesterName, setSummaryRequesterName] = useState<string>('-');\n  const [summaryRequestDate, setSummaryRequestDate] = useState<string>('-');\n  const [summaryManager, setSummaryManager] = useState<string>('-');\n  const [summaryCompletedDate, setSummaryCompletedDate] = useState<string>('-');\n\n  // ðŸ”‘ íŒŒì¼ ìž…ë ¥ ref ì¶”ê°€\n  const fileInputRefs = useRef<{ [key: string]: HTMLInputElement | null }>({\n    datasheet: null,\n    cvlist: null,\n    vllist: null,\n    singlequote: null,\n    multiquote: null\n  });\n\n  // ê³ ê° ì²¨ë¶€ ë‹¤ì¤‘ ì—…ë¡œë“œìš© ìƒíƒœ\n  const [selectedCustomerFiles, setSelectedCustomerFiles] = useState<File[]>([]);\n  const customerAddInputRef = useRef<HTMLInputElement | null>(null);\n\n  // ACC ì„¹ì…˜ ì„ íƒ ìƒíƒœ ê´€ë¦¬\n  const [accSelections, setAccSelections] = useState<{\n    positioner: { typeCode: string; makerCode: string; modelCode: string; specification: string; };\n    solenoid: { typeCode: string; makerCode: string; modelCode: string; specification: string; };\n    limiter: { typeCode: string; makerCode: string; modelCode: string; specification: string; };\n    airSupply: { typeCode: string; makerCode: string; modelCode: string; specification: string; };\n    volumeBooster: { typeCode: string; makerCode: string; modelCode: string; specification: string; };\n    airOperator: { typeCode: string; makerCode: string; modelCode: string; specification: string; };\n    lockUp: { typeCode: string; makerCode: string; modelCode: string; specification: string; };\n    snapActingRelay: { typeCode: string; makerCode: string; modelCode: string; specification: string; };\n  }>({ // ê° ì•…ì„¸ì‚¬ë¦¬ì˜ typeCodeë¥¼ í•˜ë“œì½”ë”©ëœ ê°’ìœ¼ë¡œ ì´ˆê¸°í™”\n    positioner: { typeCode: 'A', makerCode: '', modelCode: '', specification: '' },\n    solenoid: { typeCode: 'B', makerCode: '', modelCode: '', specification: '' },\n    limiter: { typeCode: 'C', makerCode: '', modelCode: '', specification: '' },\n    airSupply: { typeCode: 'D', makerCode: '', modelCode: '', specification: '' },\n    volumeBooster: { typeCode: 'E', makerCode: '', modelCode: '', specification: '' },\n    airOperator: { typeCode: 'F', makerCode: '', modelCode: '', specification: '' },\n    lockUp: { typeCode: 'G', makerCode: '', modelCode: '', specification: '' },\n    snapActingRelay: { typeCode: 'H', makerCode: '', modelCode: '', specification: '' },\n  });\n\n  // ëª¨ë“  ìƒíƒœ ë³€ìˆ˜ ì„ ì–¸ í›„, ë Œë”ë§ ì‹œ accSelections ìƒíƒœ ë¡œê¹…\n  //console.log('EstimateDetailPage render - accSelections:', accSelections);\n\n  // TagNoë³„ ì‚¬ìš©ìž ì„ íƒê°’ ìž„ì‹œ ì €ìž¥ (TagNo ë³€ê²½ ì‹œ ë³µì›ìš©)\n  const [tempSelections, setTempSelections] = useState<{\n    [sheetID: number]: {\n      body: any;\n      trim: any;\n      act: any;\n      acc: any;\n    };\n  }>({});\n  // íŒŒì¼ ë‚´ í•¨ìˆ˜ë“¤ ì‚¬ì´ ì•„ë¬´ ê³³ì— ì¶”ê°€\n  const buildSaveSpecFromSelections = (sel: { body:any; trim:any; act:any; acc:any; valveTypeCode?:string }) => ({\n    valveId: sel.valveTypeCode || '',\n    body: { bonnetType: sel.body?.bonnetType || '', materialBody: sel.body?.materialBody || '', rating: sel.body?.ratingCode || '', ratingUnit: sel.body?.ratingUnitCode || '', connection: sel.body?.connection || '', sizeUnit: sel.body?.sizeBodyUnitCode || '', size: sel.body?.sizeBodyCode || '' },\n    trim: { type: sel.trim?.trimType || '', series: sel.trim?.trimSeries || '', portSize: sel.trim?.sizePortCode || '', portSizeUnit: sel.trim?.sizePortUnitCode || '', form: sel.trim?.formCode || sel.trim?.form || '', materialTrim: sel.trim?.materialTrim || '', option: sel.trim?.option || '' },\n    actuator: { type: sel.act?.actionType || '', series: sel.act?.series || '', size: sel.act?.size || '', hw: sel.act?.hw || '' },\n    accessories: {\n      PosCode: sel.acc?.positioner?.modelCode || null, PosMakerCode: sel.acc?.positioner?.makerCode || null,\n      SolCode: sel.acc?.solenoid?.modelCode || null,   SolMakerCode: sel.acc?.solenoid?.makerCode || null,\n      LimCode: sel.acc?.limiter?.modelCode || null,    LimMakerCode: sel.acc?.limiter?.makerCode || null,\n      ASCode: sel.acc?.airSupply?.modelCode || null,   ASMakerCode: sel.acc?.airSupply?.makerCode || null,\n      VolCode: sel.acc?.volumeBooster?.modelCode || null, VolMakerCode: sel.acc?.volumeBooster?.makerCode || null,\n      AirOpCode: sel.acc?.airOperator?.modelCode || null,  AirOpMakerCode: sel.acc?.airOperator?.makerCode || null,\n      LockupCode: sel.acc?.lockUp?.modelCode || null,  LockupMakerCode: sel.acc?.lockUp?.makerCode || null,\n      SnapActCode: sel.acc?.snapActingRelay?.modelCode || null, SnapActMakerCode: sel.acc?.snapActingRelay?.makerCode || null\n    }\n  });\n\n  // í˜„ìž¬ ì„ íƒê°’ì„ tempSelectionsì— ì €ìž¥í•˜ëŠ” í•¨ìˆ˜\n  const saveCurrentSelections = (sheetID: number) => {\n    if (sheetID) {\n      setTempSelections(prev => ({\n        ...prev,\n        [sheetID]: {\n          body: { ...bodySelections },\n          trim: { ...trimSelections },\n          act: { ...actSelections },\n          acc: { ...accSelections }\n        }\n      }));\n      //console.log(`${sheetID}ì˜ ì„ íƒê°’ë“¤ì„ ìž„ì‹œ ì €ìž¥í–ˆìŠµë‹ˆë‹¤.`);\n    }\n  };\n\n  // valve ì„ íƒ ì‹œ í˜¸ì¶œë˜ëŠ” í•¨ìˆ˜\n  const handleValveSelection = (valve: ValveData) => {\n    // í˜„ìž¬ íƒœê·¸ì—ì„œ ë– ë‚˜ê¸° ì „, í˜„ìž¬ ì„ íƒê°’ ìž„ì‹œ ì €ìž¥\n    if (selectedValve) {\n      setTempSelections(prev => ({\n        ...prev,\n        [selectedValve.sheetID]: {\n          body: { ...bodySelections },\n          trim: { ...trimSelections },\n          act:  { ...actSelections },\n          acc:  { ...accSelections },\n        }\n      }));\n    }\n  \n    setSelectedValve(valve);\n  \n    // ìƒˆ íƒœê·¸ì— ëŒ€í•´: ìž„ì‹œê°’ ìžˆìœ¼ë©´ ê·¸ê±¸ ë³µì›, ì—†ìœ¼ë©´ ì„œë²„ ì´ˆê¸°ê°’ ë¡œë“œ\n    if (tempSelections[valve.sheetID]) {\n      const saved = tempSelections[valve.sheetID];\n      // ë³µì›(ê° selections set í•¨ìˆ˜ í˜¸ì¶œ)\n      setBodySelections(saved.body || {});\n      setTrimSelections(saved.trim || {});\n      setActSelections(saved.act || {});\n      setAccSelections(saved.acc || {});\n    } else {\n      loadInitialSpecification(valve.sheetID);\n    }\n  };\n\n  const handleTypeSelection = (type: TypeData) => {\n    setSelectedType(type.id);\n    setSelectedValve(null); // Typeì„ ë³€ê²½í•˜ë©´ ì„ íƒëœ ValveëŠ” ì´ˆê¸°í™”ë©ë‹ˆë‹¤.\n  };\n\n                    // Body ì„¹ì…˜ ì„ íƒ ìƒíƒœ ê´€ë¦¬\n                  const [bodySelections, setBodySelections] = useState({\n                    bonnetType: '',\n                    bonnetTypeCode: '', // Code ê°’ ì¶”ê°€\n                    materialBody: '',\n                    materialBodyCode: '', // Code ê°’ ì¶”ê°€\n                    sizeBodyUnit: '',\n                    sizeBody: '',\n                    sizeBodyUnitCode: '', // Code ê°’ ì¶”ê°€\n                    sizeBodyCode: '', // Code ê°’ ì¶”ê°€\n                    ratingUnit: '',\n                    rating: '',\n                    ratingUnitCode: '', // Code ê°’ ì¶”ê°€\n                    ratingCode: '', // Code ê°’ ì¶”ê°€\n                    connection: '',\n                    connectionCode: '' // Code ê°’ ì¶”ê°€\n                  });\n                \n                  // Trim ì„¹ì…˜ ì„ íƒ ìƒíƒœ ê´€ë¦¬\n                  const [trimSelections, setTrimSelections] = useState({\n                    trimType: '',\n                    trimTypeCode: '', // Code ê°’ ì¶”ê°€\n                    trimSeries: '',\n                    trimSeriesCode: '', // Code ê°’ ì¶”ê°€\n                    materialTrim: '',\n                    materialTrimCode: '', // Code ê°’ ì¶”ê°€\n                    sizePortUnit: '',\n                    sizePort: '',\n                    sizePortUnitCode: '', // Code ê°’ ì¶”ê°€\n                    sizePortCode: '', // Code ê°’ ì¶”ê°€\n                    form: '',\n                    formCode: '', // Code ê°’ ì¶”ê°€\n                    option: '' // Trim Option í•„ë“œ ì¶”ê°€\n                  });\n                \n                                    // ACT ì„¹ì…˜ ì„ íƒ ìƒíƒœ ê´€ë¦¬\n                  const [actSelections, setActSelections] = useState({\n                    actionType: '',\n                    actionTypeCode: '', // Code ê°’ ì¶”ê°€\n                    series: '',\n                    seriesCode: '', // Code ê°’ ì¶”ê°€\n                    size: '',\n                    sizeCode: '', // Code ê°’ ì¶”ê°€\n                    hw: '',\n                    hwCode: '' // Code ê°’ ì¶”ê°€\n                  });\n\n                  // íƒœê·¸ë³„ ìƒíƒœ ì´ˆê¸°ê°’ê³¼ ë§µ ìƒíƒœ\n                  const INITIAL_BODY = {\n                    bonnetType: '',\n                    bonnetTypeCode: '',\n                    materialBody: '',\n                    materialBodyCode: '',\n                    sizeBodyUnit: '',\n                    sizeBody: '',\n                    sizeBodyUnitCode: '',\n                    sizeBodyCode: '',\n                    ratingUnit: '',\n                    rating: '',\n                    ratingUnitCode: '',\n                    ratingCode: '',\n                    connection: '',\n                    connectionCode: ''\n                  };\n                  const INITIAL_TRIM = {\n                    trimType: '',\n                    trimTypeCode: '',\n                    trimSeries: '',\n                    trimSeriesCode: '',\n                    materialTrim: '',\n                    materialTrimCode: '',\n                    sizePortUnit: '',\n                    sizePort: '',\n                    sizePortUnitCode: '',\n                    sizePortCode: '',\n                    form: '',\n                    formCode: '',\n                    option: ''\n                  };\n                  const INITIAL_ACT = {\n                    actionType: '',\n                    actionTypeCode: '',\n                    series: '',\n                    seriesCode: '',\n                    size: '',\n                    sizeCode: '',\n                    hw: '',\n                    hwCode: ''\n                  };\n                  const INITIAL_ACC = {\n                    positioner: { typeCode: '', makerCode: '', modelCode: '', specification: '' },\n                    solenoid: { typeCode: '', makerCode: '', modelCode: '', specification: '' },\n                    limiter: { typeCode: '', makerCode: '', modelCode: '', specification: '' },\n                    airSupply: { typeCode: '', makerCode: '', modelCode: '', specification: '' },\n                    volumeBooster: { typeCode: '', makerCode: '', modelCode: '', specification: '' },\n                    airOperator: { typeCode: '', makerCode: '', modelCode: '', specification: '' },\n                    lockUp: { typeCode: '', makerCode: '', modelCode: '', specification: '' },\n                    snapActingRelay: { typeCode: '', makerCode: '', modelCode: '', specification: '' },\n                  };\n\n                  const [bodySelectionsBySheet, setBodySelectionsBySheet] = useState<{[key:number]: typeof INITIAL_BODY}>({});\n                  const [trimSelectionsBySheet, setTrimSelectionsBySheet] = useState<{[key:number]: typeof INITIAL_TRIM}>({});\n                  const [actSelectionsBySheet, setActSelectionsBySheet] = useState<{[key:number]: typeof INITIAL_ACT}>({});\n                  const [accSelectionsBySheet, setAccSelectionsBySheet] = useState<{[key:number]: typeof INITIAL_ACC}>({});\n\n                  // íƒœê·¸ ì „í™˜ ì‹œ í•´ë‹¹ íƒœê·¸ì˜ ìƒíƒœë¥¼ ì‹±ê¸€ ìƒíƒœë¡œ ë™ê¸°í™”\n                  useEffect(() => {\n                    const sid = selectedValve?.sheetID as number | undefined;\n                    if (!sid) return;\n                    setBodySelections(bodySelectionsBySheet[sid] ?? INITIAL_BODY);\n                    setTrimSelections(trimSelectionsBySheet[sid] ?? INITIAL_TRIM);\n                    setActSelections(actSelectionsBySheet[sid] ?? INITIAL_ACT);\n                    setAccSelections(accSelectionsBySheet[sid] ?? INITIAL_ACC);\n                  }, [selectedValve?.sheetID, bodySelectionsBySheet, trimSelectionsBySheet, actSelectionsBySheet, accSelectionsBySheet]);\n\n                  // selectedValve ë³€ê²½ ì‹œ í•´ë‹¹ TAGì˜ ë°ì´í„° ë¡œë“œ\n                  useEffect(() => {\n                    const sid = selectedValve?.sheetID as number | undefined;\n                    if (!sid) return;\n                    \n                    // í•´ë‹¹ TAGì˜ ë°ì´í„° ë¡œë“œ\n                    setBodySelections(bodySelectionsBySheet[sid] ?? INITIAL_BODY);\n                    setTrimSelections(trimSelectionsBySheet[sid] ?? INITIAL_TRIM);\n                    setActSelections(actSelectionsBySheet[sid] ?? INITIAL_ACT);\n                    setAccSelections(accSelectionsBySheet[sid] ?? INITIAL_ACC);\n                    \n                    // ì•¡íŠ¸ ì‹œë¦¬ì¦ˆê°€ ìžˆìœ¼ë©´ ì‚¬ì´ì¦ˆ ëª©ë¡ ê°€ì ¸ì˜¤ê¸°\n                    const currentActSelections = actSelectionsBySheet[sid];\n                    if (currentActSelections?.series) {\n                      fetchActSizeList(currentActSelections.series);\n                    } else {\n                      setActSizeList([]);\n                    }\n                  }, [selectedValve?.sheetID, bodySelectionsBySheet, trimSelectionsBySheet, actSelectionsBySheet, accSelectionsBySheet]);\n\n                  // ìƒíƒœ ë° í”„ë¡œì íŠ¸ ì •ë³´\n  const [projectName, setProjectName] = useState<string>('');\n\n  // BodyValveList ê°€ì ¸ì˜¤ê¸°\n  const fetchBodyValveList = async () => {\n    try {\n      const response = await fetch('http://192.168.0.14:5135/api/estimate/body-valve-list');\n      if (!response.ok) {\n        console.error('body-valve-list ìš”ì²­ ì‹¤íŒ¨:', response.status, response.statusText);\n        setBodyValveList([]);\n        return;\n      }\n      const data = await response.json();\n      setBodyValveList(data ?? []);\n    } catch (error) {\n      console.error('BodyValveList ê°€ì ¸ì˜¤ê¸° ì‹¤íŒ¨:', error);\n    }\n  };\n\n  // ACT Size ëª©ë¡ ê°€ì ¸ì˜¤ê¸°\n  const fetchActSizeList = async (actSeriesCode: string) => {\n    try {\n      console.log('fetchActSizeList ì‹œìž‘:', actSeriesCode);\n      const response = await fetch(`http://192.168.0.14:5135/api/masterdata/act/size?actSeriesCode=${actSeriesCode}`);\n      const data = await response.json();\n      console.log('ACT Size API ì‘ë‹µ:', data);\n      setActSizeList(data || []);\n    } catch (error) {\n      console.error('ACT Size ëª©ë¡ ê°€ì ¸ì˜¤ê¸° ì‹¤íŒ¨:', error);\n      setActSizeList([]);\n    }\n  };\n\n  // ðŸ”‘ íŒŒì¼ ê´€ë¦¬ í•¨ìˆ˜ë“¤ ì¶”ê°€\n  const fetchManagerFiles = async (): Promise<any[]> => {\n    if (!tempEstimateNo) return [];\n    \n    try {\n      setIsLoadingFiles(true);\n      console.log('ðŸ”„ fetchManagerFiles ì‹œìž‘ - tempEstimateNo:', tempEstimateNo);\n      const response = await fetch(`http://192.168.0.14:5135/api/estimate/sheets/${tempEstimateNo}/attachments`);\n      console.log('ðŸ“¡ API ì‘ë‹µ ìƒíƒœ:', response.status, response.ok);\n      \n      if (response.ok) {\n        const attachments = await response.json();\n        console.log('ðŸ“¥ API ì‘ë‹µ ë°ì´í„°:', attachments);\n        console.log('ðŸ“¥ API ì‘ë‹µ ë°ì´í„° ê¸¸ì´:', attachments.length);\n        \n        // ðŸ”‘ ResultFiles ê²½ë¡œì˜ ëª¨ë“  íŒŒì¼ ê°€ì ¸ì˜¤ê¸° (ì—‘ì…€ + PDF)\n        const allManagerFiles = attachments.filter((att: any) => {\n          const filePath = att.path || att.filePath;\n          const isManagerFileResult = filePath && isManagerFile(filePath);\n          console.log('ðŸ” íŒŒì¼ í•„í„°ë§ ì²´í¬:', att.name || att.fileName, 'ê²½ë¡œ:', filePath, 'ê´€ë¦¬íŒŒì¼ì—¬ë¶€:', isManagerFileResult);\n          return isManagerFileResult;\n        }).map((att: any) => {\n          // ê²½ë¡œì—ì„œ managerFileType ì¶”ì¶œ (í¬ë¡œìŠ¤í”Œëž«í¼)\n          const filePath = att.path || att.filePath;\n          att.managerFileType = extractManagerFileType(filePath);\n          console.log('ðŸ·ï¸ ì¶”ì¶œëœ managerFileType:', att.managerFileType);\n          return att;\n        });\n        \n        setManagerFiles(allManagerFiles);\n        console.log('âœ… ê´€ë¦¬ìž íŒŒì¼ ëª©ë¡ ë¡œë“œ ì™„ë£Œ:', allManagerFiles.length, 'ê°œ');\n        console.log('ðŸ” í•„í„°ë§ëœ ê´€ë¦¬ íŒŒì¼ë“¤:', allManagerFiles);\n        return allManagerFiles;\n      } else {\n        console.error('âŒ API ì‘ë‹µ ì‹¤íŒ¨:', response.status, response.statusText);\n        return [];\n      }\n    } catch (error) {\n      console.error('ê´€ë¦¬ìž íŒŒì¼ ëª©ë¡ ì¡°íšŒ ì¤‘ ì˜¤ë¥˜:', error);\n      return [];\n    } finally {\n      setIsLoadingFiles(false);\n    }\n  };\n\n  const fetchCustomerFiles = async () => {\n    if (!tempEstimateNo) return;\n    \n    try {\n      setIsLoadingFiles(true);\n      console.log('ðŸ”„ fetchCustomerFiles ì‹œìž‘ - tempEstimateNo:', tempEstimateNo);\n      const response = await fetch(`http://192.168.0.14:5135/api/estimate/sheets/${tempEstimateNo}/attachments`);\n      console.log('ðŸ“¡ API ì‘ë‹µ ìƒíƒœ:', response.status, response.ok);\n      \n      if (response.ok) {\n        const files = await response.json();\n        const onlyResultCustomer = (files || []).filter((att: any) => isResultCustomerFile(att.filePath || att.path));\n        setCustomerFiles(onlyResultCustomer);\n        console.log('âœ… ê³ ê° íŒŒì¼ ëª©ë¡ ë¡œë“œ ì™„ë£Œ (ResultFiles/customer í•œì •):', onlyResultCustomer.length, 'ê°œ');\n      } else {\n        console.error('âŒ API ì‘ë‹µ ì‹¤íŒ¨:', response.status, response.statusText);\n      }\n    } catch (error) {\n      console.error('ê³ ê° íŒŒì¼ ëª©ë¡ ì¡°íšŒ ì¤‘ ì˜¤ë¥˜:', error);\n    } finally {\n      setIsLoadingFiles(false);\n    }\n  };\n\n  const deleteFile = async (managerFileType: string) => {\n    if (!tempEstimateNo) return;\n    \n    if (!window.confirm('ì •ë§ë¡œ ì´ íŒŒì¼ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {\n      return;\n    }\n    \n    try {\n      const response = await fetch(`http://192.168.0.14:5135/api/estimate/sheets/${tempEstimateNo}/files/${managerFileType}`, {\n        method: 'DELETE'\n      });\n      \n      if (response.ok) {\n        // íŒŒì¼ ëª©ë¡ ìƒˆë¡œê³ ì¹¨\n        await fetchManagerFiles();\n        alert('íŒŒì¼ì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.');\n      } else {\n        alert('íŒŒì¼ ì‚­ì œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');\n      }\n    } catch (error) {\n      console.error('íŒŒì¼ ì‚­ì œ ì¤‘ ì˜¤ë¥˜:', error);\n      alert('íŒŒì¼ ì‚­ì œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');\n    }\n  };\n\n  // ê°œë³„ ì²¨ë¶€íŒŒì¼ ì‚­ì œ(attachmentID ê¸°ì¤€) - ê³ ê° ë‹¤ì¤‘ íŒŒì¼ ëŒ€ì‘\n  const deleteAttachmentById = async (attachmentID: number) => {\n    if (!tempEstimateNo) return;\n    if (!window.confirm('ì •ë§ë¡œ ì´ íŒŒì¼ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) return;\n    try {\n      const response = await fetch(`http://192.168.0.14:5135/api/estimate/attachments/${attachmentID}`, {\n        method: 'DELETE'\n      });\n      if (response.ok) {\n        await fetchCustomerFiles();\n        await fetchManagerFiles();\n      } else {\n        alert('íŒŒì¼ ì‚­ì œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');\n      }\n    } catch (e) {\n      console.error('ì²¨ë¶€íŒŒì¼ ì‚­ì œ ì˜¤ë¥˜:', e);\n      alert('íŒŒì¼ ì‚­ì œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');\n    }\n  };\n\n  const downloadFile = async (filePath: string, fileName: string) => {\n    try {\n      // ðŸ”‘ íŒŒì¼ ë‹¤ìš´ë¡œë“œ API ìˆ˜ì • - ìƒˆë¡œ ì¶”ê°€ëœ API ì‚¬ìš©\n      const response = await fetch(`http://192.168.0.14:5135/api/estimate/attachments/download?filePath=${encodeURIComponent(filePath)}`);\n      if (response.ok) {\n        const blob = await response.blob();\n        const url = window.URL.createObjectURL(blob);\n        const a = document.createElement('a');\n        a.href = url;\n        a.download = fileName;\n        document.body.appendChild(a);\n        a.click();\n        window.URL.revokeObjectURL(url);\n        document.body.removeChild(a);\n      } else {\n        // ðŸ”‘ ë‹¤ìš´ë¡œë“œ ì‹¤íŒ¨ ì‹œ ìƒì„¸ ì—ëŸ¬ ì •ë³´ í‘œì‹œ\n        const errorText = await response.text();\n        console.error('íŒŒì¼ ë‹¤ìš´ë¡œë“œ ì‹¤íŒ¨:', response.status, errorText);\n        alert(`íŒŒì¼ ë‹¤ìš´ë¡œë“œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. (${response.status})\\n${errorText}`);\n      }\n    } catch (error) {\n      console.error('íŒŒì¼ ë‹¤ìš´ë¡œë“œ ì¤‘ ì˜¤ë¥˜:', error);\n      alert('íŒŒì¼ ë‹¤ìš´ë¡œë“œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');\n    }\n  };\n\n  const getFileTypeDisplayName = (managerFileType: string) => {\n    const typeMap: { [key: string]: string } = {\n      'cvlist': 'CV List',\n      'vllist': 'VL List',\n      'datasheet': 'DataSheet',\n      'singlequote': 'ë‹¨í’ˆê²¬ì ì„œ',\n      'multiquote': 'ë‹¤ìˆ˜ëŸ‰ê²¬ì ì„œ'\n    };\n    return typeMap[managerFileType] || managerFileType;\n  };\n\n  const formatFileSize = (bytes: number, decimals = 2) => {\n    if (bytes === 0) return '0 Bytes';\n    const k = 1024;\n    const sizes = ['Bytes', 'KB', 'MB', 'GB'];\n    const i = Math.floor(Math.log(bytes) / Math.log(k));\n    return parseFloat((bytes / Math.pow(k, i)).toFixed(decimals)) + ' ' + sizes[i];\n  };\n\n  const formatDate = (dateString: string) => {\n    return new Date(dateString).toLocaleString('ko-KR');\n  };\n\n  // ðŸ”‘ PDF ì—…ë¡œë“œ ê´€ë ¨ í•¨ìˆ˜ë“¤ ì¶”ê°€\n  const handlePdfUpload = (event: React.ChangeEvent<HTMLInputElement>, fileType: string) => {\n    // ðŸ”‘ í™”ë©´ ì´ë™ ë°©ì§€\n    event.preventDefault();\n    \n    const file = event.target.files?.[0];\n    if (file) {\n      if (file.type !== 'application/pdf') {\n        alert('PDF íŒŒì¼ë§Œ ì—…ë¡œë“œ ê°€ëŠ¥í•©ë‹ˆë‹¤.');\n        return;\n      }\n      \n      // ðŸ”‘ ìƒíƒœ ì—…ë°ì´íŠ¸ë¥¼ ë¹„ë™ê¸°ë¡œ ì²˜ë¦¬í•˜ì—¬ í™”ë©´ ì´ë™ ë°©ì§€\n      setTimeout(() => {\n        setSelectedPdfFiles(prev => ({\n          ...prev,\n          [fileType]: file\n        }));\n      }, 0);\n    }\n  };\n\n  // ðŸ”‘ íŒŒì¼ ì„ íƒì„ ìœ„í•œ ë³„ë„ í•¨ìˆ˜ ì¶”ê°€\n  const handleFileSelect = (fileType: string) => {\n    const input = document.createElement('input');\n    input.type = 'file';\n    // ê³ ê°/ê´€ë¦¬ìž ê³µí†µ ì„ íƒê¸°: ë¬¸ì„œ/ì••ì¶• í¬í•¨ ê´‘ë²”ìœ„ í—ˆìš©\n    input.accept = '.pdf,.doc,.docx,.xls,.xlsx,.ppt,.pptx,.hwp,.txt,.zip,.rar,.7z,.csv,.json';\n    input.style.display = 'none';\n    \n    input.onchange = (e) => {\n      const target = e.target as HTMLInputElement;\n      if (target.files && target.files[0]) {\n        const file = target.files[0];\n        // ê³ ê° ì—…ë¡œë“œ/ë²”ìš© ì„ íƒ: íŒŒì¼ íƒ€ìž… ì œí•œ ì™„í™” (ì„œë²„ì—ì„œ ìµœì¢… ê²€ì¦)\n        \n        setSelectedPdfFiles(prev => ({\n          ...prev,\n          [fileType]: file\n        }));\n      }\n    };\n    \n    document.body.appendChild(input);\n    input.click();\n    document.body.removeChild(input);\n  };\n\n                    // Body ì„¹ì…˜ ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ë“¤\n                  const handleBodyChange = (field: string, value: string) => {\n                    setBodySelections(prev => {\n                      const newSelections = { ...prev, [field]: value } as any;\n                      // ê¸°ì¡´ ë™ê¸°í™” ë¡œì§ ìœ ì§€...\n                      if (field === 'bonnetType') {\n                        const selectedItem = bodyBonnetList.find(item => item.bonnetCode === value);\n                        if (selectedItem) newSelections.bonnetTypeCode = selectedItem.bonnetCode;\n                      }\n                      if (field === 'materialBody') {\n                        const selectedItem = bodyMatList.find(item => item.bodyMatCode === value);\n                        if (selectedItem) newSelections.materialBodyCode = selectedItem.bodyMatCode;\n                      }\n                      if (field === 'connection') {\n                        const selectedItem = bodyConnectionList.find(item => item.connectionCode === value);\n                        if (selectedItem) newSelections.connectionCode = selectedItem.connectionCode;\n                      }\n                      if (field === 'sizeBodyUnit') { newSelections.sizeBody = ''; newSelections.sizeBodyCode = ''; }\n                      if (field === 'ratingUnit') { newSelections.rating = ''; newSelections.ratingCode = ''; }\n                      // ë§µì— ë°˜ì˜\n                      const sid = selectedValve?.sheetID;\n                      if (sid) setBodySelectionsBySheet((prevMap: any) => ({ ...prevMap, [sid]: newSelections }));\n                      return newSelections;\n                    });\n                  };\n\n                    // Trim ì„¹ì…˜ ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ë“¤\n                  const handleTrimChange = (field: string, value: string) => {\n                    setTrimSelections(prev => {\n                      const newSelections = { ...prev, [field]: value } as any;\n                      const sid = selectedValve?.sheetID;\n                      if (sid) setTrimSelectionsBySheet((prevMap: any) => ({ ...prevMap, [sid]: newSelections }));\n                      return newSelections;\n                    });\n                  };\n\n                    // ACT ì„¹ì…˜ ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ë“¤\n                  const handleActChange = (field: string, value: string) => {\n                    setActSelections(prev => {\n                      const newSelections = { ...prev, [field]: value } as any;\n                      \n                      // ì‹œë¦¬ì¦ˆê°€ ë³€ê²½ë˜ë©´ ì‚¬ì´ì¦ˆ ì´ˆê¸°í™” ë° ì‚¬ì´ì¦ˆ ëª©ë¡ ìƒˆë¡œ ê°€ì ¸ì˜¤ê¸°\n                      if (field === 'series') {\n                        newSelections.size = '';\n                        // ì•¡íŠ¸ ì‚¬ì´ì¦ˆ ëª©ë¡ ìƒˆë¡œ ê°€ì ¸ì˜¤ê¸°\n                        if (value) {\n                          fetchActSizeList(value);\n                        } else {\n                          setActSizeList([]);\n                        }\n                      }\n                      \n                      const sid = selectedValve?.sheetID;\n                      if (sid) setActSelectionsBySheet((prevMap: any) => ({ ...prevMap, [sid]: newSelections }));\n                      return newSelections;\n                    });\n                  };\n\n\n\n  // ì•…ì„¸ì‚¬ë¦¬ ë°ì´í„° ê°€ì ¸ì˜¤ê¸° (ìž¬ì‹œë„ ë¡œì§ í¬í•¨)\n  const fetchAccessoryData = async (retryCount = 0): Promise<boolean> => {\n    const maxRetries = 3;\n    \n    try {\n      console.log(`ì•…ì„¸ì‚¬ë¦¬ ë°ì´í„° ë¡œë”© ì‹œë„ ${retryCount + 1}/${maxRetries + 1}...`);\n      \n      const accSearchRes = await fetch('http://192.168.0.14:5135/api/masterdata/acc/search');\n      \n      if (accSearchRes.ok) {\n        const accSearchData = await accSearchRes.json();\n        console.log('ì•…ì„¸ì‚¬ë¦¬ ê²€ìƒ‰ ë°ì´í„° ë¡œë”© ì„±ê³µ:', accSearchData.length, 'ê°œ');\n        \n        // ë°±ì—”ë“œ ì‘ë‹µ ë°ì´í„° êµ¬ì¡° í™•ì¸\n        if (accSearchData.length > 0) {\n          console.log('ðŸ” ë°±ì—”ë“œ ì‘ë‹µ ë°ì´í„° ì²« ë²ˆì§¸ í•­ëª© êµ¬ì¡°:', accSearchData[0]);\n          console.log('ðŸ” ë°±ì—”ë“œ ì‘ë‹µ ë°ì´í„° ì²« ë²ˆì§¸ í•­ëª©ì˜ ëª¨ë“  í‚¤:', Object.keys(accSearchData[0]));\n        }\n        \n        // ë©”ì´ì»¤ì™€ ëª¨ë¸ ë°ì´í„° ë¶„ë¦¬ - ì•…ì„¸ì‚¬ë¦¬ íƒ€ìž…ë³„ë¡œ êµ¬ë¶„\n        const allAccMakerData: any[] = [];\n        const allAccModelData: any[] = [];\n        \n        // ì•…ì„¸ì‚¬ë¦¬ íƒ€ìž…ë³„ë¡œ ë°ì´í„° ê·¸ë£¹í™”\n        const groupedByType = accSearchData.reduce((acc: any, item: any) => {\n          if (!acc[item.accTypeCode]) {\n            acc[item.accTypeCode] = [];\n          }\n          acc[item.accTypeCode].push(item);\n          return acc;\n        }, {});\n        \n        // ê° íƒ€ìž…ë³„ë¡œ ë©”ì´ì»¤ì™€ ëª¨ë¸ ë°ì´í„° ì²˜ë¦¬\n        Object.entries(groupedByType).forEach(([typeCode, items]: [string, any]) => {\n          const typeItems = items as any[];\n          \n          // ë©”ì´ì»¤ ë°ì´í„° (íƒ€ìž…ë³„ë¡œ ì¤‘ë³µ ì œê±°)\n          typeItems.forEach((item: any) => {\n            const existingMaker = allAccMakerData.find(maker => \n              maker.accMakerCode === item.accMakerCode && maker.accTypeCode === typeCode\n            );\n            if (!existingMaker) {\n              allAccMakerData.push({\n                accMakerCode: item.accMakerCode,\n                accMakerName: item.accMakerName,\n                accTypeCode: typeCode\n              });\n            }\n          });\n          \n          // ëª¨ë¸ ë°ì´í„°\n          typeItems.forEach((item: any) => {\n            console.log(`ðŸ” ${typeCode} íƒ€ìž… ëª¨ë¸ ë°ì´í„°:`, {\n              accMakerCode: item.accMakerCode,\n              accModelCode: item.accModelCode,\n              accModelName: item.accModelName,\n              accSize: item.accSize,\n              accTypeCode: typeCode\n            });\n            \n            allAccModelData.push({\n              accMakerCode: item.accMakerCode,\n              accModelCode: item.accModelCode,\n              accModelName: item.accModelName,\n              accSize: item.accSize,\n              accTypeCode: typeCode  // item.accTypeCode ëŒ€ì‹  ê·¸ë£¹í™”ëœ typeCode ì‚¬ìš©\n            });\n          });\n        });\n        \n        console.log('ðŸ” ì•…ì„¸ì‚¬ë¦¬ íƒ€ìž…ë³„ ë°ì´í„° ê·¸ë£¹í™” ê²°ê³¼:', groupedByType);\n        console.log('ðŸ” ë¶„ë¦¬ëœ ë©”ì´ì»¤ ë°ì´í„°:', allAccMakerData);\n        console.log('ðŸ” ë¶„ë¦¬ëœ ëª¨ë¸ ë°ì´í„°:', allAccModelData);\n        \n        // ê° íƒ€ìž…ë³„ ë°ì´í„° ê°œìˆ˜ í™•ì¸\n        Object.entries(groupedByType).forEach(([typeCode, items]: [string, any]) => {\n          console.log(`ðŸ” ${typeCode} íƒ€ìž…: ${items.length}ê°œ`);\n          const uniqueMakers = new Set(items.map((item: any) => item.accMakerCode));\n          console.log(`  - ê³ ìœ  ë©”ì´ì»¤ ìˆ˜: ${uniqueMakers.size}`);\n          console.log(`  - ë©”ì´ì»¤ ì½”ë“œë“¤:`, Array.from(uniqueMakers));\n          \n          // íƒ€ìž…ë³„ ë©”ì´ì»¤ ëª©ë¡ í™•ì¸\n          const typeMakers = allAccMakerData.filter(maker => maker.accTypeCode === typeCode);\n          console.log(`  - íƒ€ìž…ë³„ ë©”ì´ì»¤ ëª©ë¡:`, typeMakers);\n        });\n        \n        // ì•…ì„¸ì‚¬ë¦¬ ë°ì´í„° ì„¤ì •\n        setAccMakerList(allAccMakerData);\n        setAccModelList(allAccModelData);\n        console.log('ì•…ì„¸ì‚¬ë¦¬ ë°ì´í„° ì„¤ì • ì™„ë£Œ - ë©”ì´ì»¤:', allAccMakerData.length, 'ê°œ, ëª¨ë¸:', allAccModelData.length, 'ê°œ');\n        \n        // accMakerList êµ¬ì¡° ìƒì„¸ í™•ì¸\n        console.log('ðŸ” accMakerList ìƒì„¸ êµ¬ì¡°:');\n        allAccMakerData.forEach((maker, index) => {\n          console.log(`  [${index}] ${maker.accTypeCode} - ${maker.accMakerCode}: ${maker.accMakerName}`);\n        });\n        \n        // íƒ€ìž…ë³„ ë©”ì´ì»¤ ê°œìˆ˜ í™•ì¸\n        const makerCountByType = allAccMakerData.reduce((acc: any, maker) => {\n          if (!acc[maker.accTypeCode]) acc[maker.accTypeCode] = 0;\n          acc[maker.accTypeCode]++;\n          return acc;\n        }, {});\n        console.log('ðŸ” íƒ€ìž…ë³„ ë©”ì´ì»¤ ê°œìˆ˜:', makerCountByType);\n        \n        // íƒ€ìž…ë³„ë¡œ ë©”ì´ì»¤ì™€ ëª¨ë¸ ë°ì´í„° ë¶„ë¦¬\n        const makerDataByType: { [key: string]: any[] } = {};\n        const modelDataByType: { [key: string]: any[] } = {};\n        \n        allAccMakerData.forEach(maker => {\n          if (!makerDataByType[maker.accTypeCode]) {\n            makerDataByType[maker.accTypeCode] = [];\n          }\n          makerDataByType[maker.accTypeCode].push(maker);\n        });\n        \n        allAccModelData.forEach(model => {\n          if (!modelDataByType[model.accTypeCode]) {\n            modelDataByType[model.accTypeCode] = [];\n          }\n          modelDataByType[model.accTypeCode].push(model);\n        });\n        \n        console.log('ðŸ” íƒ€ìž…ë³„ ë¶„ë¦¬ëœ ë°ì´í„°:', {\n          makerDataByType: Object.keys(makerDataByType).reduce((acc, key) => {\n            acc[key] = makerDataByType[key].length;\n            return acc;\n          }, {} as any),\n          modelDataByType: Object.keys(modelDataByType).reduce((acc, key) => {\n            acc[key] = modelDataByType[key].length;\n            return acc;\n          }, {} as any)\n        });\n        \n        // íƒ€ìž…ë³„ ë°ì´í„°ë¥¼ ìƒíƒœì— ì €ìž¥\n        setAccMakerListByType(makerDataByType);\n        setAccModelListByType(modelDataByType);\n        \n        // ì•…ì„¸ì‚¬ë¦¬ ë°ì´í„° ë¡œë“œ ì™„ë£Œ í›„ accSelections ì´ˆê¸°í™”\n        const initialAccSelections = {\n          positioner: { typeCode: 'Positioner', makerCode: '', modelCode: '', specification: '' },\n          solenoid: { typeCode: 'Solenoid', makerCode: '', modelCode: '', specification: '' },\n          limiter: { typeCode: 'Limit', makerCode: '', modelCode: '', specification: '' },\n          airSupply: { typeCode: 'Airset', makerCode: '', modelCode: '', specification: '' },\n          volumeBooster: { typeCode: 'Volume', makerCode: '', modelCode: '', specification: '' },\n          airOperator: { typeCode: 'Airoperate', makerCode: '', modelCode: '', specification: '' },\n          lockUp: { typeCode: 'Lockup', makerCode: '', modelCode: '', specification: '' },\n          snapActingRelay: { typeCode: 'Snapacting', makerCode: '', modelCode: '', specification: '' },\n        };\n        setAccSelections(initialAccSelections);\n        \n        return true; // ì„±ê³µ\n      } else {\n        console.error('ì•…ì„¸ì‚¬ë¦¬ ê²€ìƒ‰ API ì‘ë‹µ ì‹¤íŒ¨:', accSearchRes.status, accSearchRes.statusText);\n        return false; // ì‹¤íŒ¨\n      }\n    } catch (error) {\n      console.error('ì•…ì„¸ì‚¬ë¦¬ ê²€ìƒ‰ ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨:', error);\n      return false; // ì‹¤íŒ¨\n    }\n  };\n\n  // ë§ˆìŠ¤í„° ë°ì´í„° ê°€ì ¸ì˜¤ê¸°\n  const fetchMasterData = async () => {\n    try {\n      // Step 1, 2 ë§ˆìŠ¤í„° ë°ì´í„° (EstimateController)\n      const [sizeRes, matRes, trimMatRes, optionRes, ratingRes] = await Promise.all([\n        fetch('http://192.168.0.14:5135/api/estimate/body-size-list'),\n        fetch('http://192.168.0.14:5135/api/estimate/body-mat-list'),\n        fetch('http://192.168.0.14:5135/api/estimate/trim-mat-list'),\n        fetch('http://192.168.0.14:5135/api/estimate/trim-option-list'),\n        fetch('http://192.168.0.14:5135/api/estimate/body-rating-list')\n      ]);\n      \n      const [sizeData, matData, trimMatData, optionData, ratingData] = await Promise.all([\n        sizeRes.json(),\n        matRes.json(),\n        trimMatRes.json(),\n        optionRes.json(),\n        ratingRes.json()\n      ]);\n      \n      setBodySizeList(sizeData || []);\n      setBodyMatList(matData || []);\n      setTrimMatList(trimMatData || []);\n      setTrimOptionList(optionData || []);\n      setBodyRatingList(ratingData || []);\n      //console.log('BodyRatingList ë¡œë“œë¨:', ratingData); // ë””ë²„ê¹… ë¡œê·¸ ì¶”ê°€\n\n      // Step 3 ë§ˆìŠ¤í„° ë°ì´í„° (MasterDataController)\n      const [bodyBonnetRes, bodyConnectionRes, trimTypeRes, trimSeriesRes, trimPortSizeRes, trimFormRes, \n            actTypeRes, actSeriesRes, actHWRes] = await Promise.all([\n        fetch('http://192.168.0.14:5135/api/masterdata/body/bonnet'),\n        fetch('http://192.168.0.14:5135/api/masterdata/body/connection'),\n        fetch('http://192.168.0.14:5135/api/masterdata/trim-type'),\n        fetch('http://192.168.0.14:5135/api/masterdata/trim/series'),\n        fetch('http://192.168.0.14:5135/api/masterdata/trim/port-size'),\n        fetch('http://192.168.0.14:5135/api/masterdata/trim/form'),\n        fetch('http://192.168.0.14:5135/api/masterdata/act/type'),\n        fetch('http://192.168.0.14:5135/api/masterdata/act/series'),\n        fetch('http://192.168.0.14:5135/api/masterdata/act/hw')\n      ]);\n\n      // ë“œëž˜ê·¸ ì•¤ ë“œë¡­ í•¸ë“¤ëŸ¬ (ì¶”ê°€)\nconst onDragStart = (e: React.DragEvent<HTMLDivElement>, index: number, listKey: 'types' | 'valves') => {\n  e.dataTransfer.setData('text/plain', JSON.stringify({ index, listKey }));\n};\nconst onDragOver = (e: React.DragEvent<HTMLDivElement>) => { e.preventDefault(); };\nconst onDrop = (e: React.DragEvent<HTMLDivElement>, dropIndex: number, listKey: 'types' | 'valves') => {\n  e.preventDefault();\n  const { index } = JSON.parse(e.dataTransfer.getData('text/plain') || '{\"index\":-1}');\n  if (index < 0) return;\n\n  if (listKey === 'types') {\n    setTypes(prev => {\n      const arr = [...prev];\n      const [moved] = arr.splice(index, 1);\n      arr.splice(dropIndex, 0, moved);\n      return arr;\n    });\n  } else {\n    setValves(prev => {\n      const arr = [...prev];\n      const [moved] = arr.splice(index, 1);\n      arr.splice(dropIndex, 0, moved);\n      // ë³´ê¸°ìš© sheetNo ìž¬ë¶€ì—¬(1ë¶€í„°)\n      return arr.map((it, i) => ({ ...it, sheetNo: i + 1 }));\n    });\n  }\n};\n\n      // ê° API ì‘ë‹µì„ ê°œë³„ì ìœ¼ë¡œ ì²˜ë¦¬í•˜ì—¬ ì—ëŸ¬ ë°œìƒ ì‹œì—ë„ ë‹¤ë¥¸ ë°ì´í„°ëŠ” ë¡œë“œí•  ìˆ˜ ìžˆë„ë¡ í•¨\n      let bodyBonnetData = [], bodyConnectionData = [], trimTypeData = [], trimSeriesData = [], \n          trimPortSizeData = [], trimFormData = [], actTypeData = [], actSeriesData = [], \n          actHWData = [];\n\n      try {\n        bodyBonnetData = await bodyBonnetRes.json();\n        //console.log('Body Bonnet ë°ì´í„° ë¡œë“œ ì„±ê³µ:', bodyBonnetData.length);\n      } catch (e) {\n        console.error('Body Bonnet ë°ì´í„° íŒŒì‹± ì‹¤íŒ¨:', e);\n      }\n\n      try {\n        bodyConnectionData = await bodyConnectionRes.json();\n        //console.log('Body Connection ë°ì´í„° ë¡œë“œ ì„±ê³µ:', bodyConnectionData.length);\n      } catch (e) {\n        console.error('Body Connection ë°ì´í„° íŒŒì‹± ì‹¤íŒ¨:', e);\n      }\n\n      try {\n        trimTypeData = await trimTypeRes.json();\n        //console.log('Trim Type ë°ì´í„° ë¡œë“œ ì„±ê³µ:', trimTypeData.length);\n      } catch (e) {\n        console.error('Trim Type ë°ì´í„° íŒŒì‹± ì‹¤íŒ¨:', e);\n      }\n\n      try {\n        trimSeriesData = await trimSeriesRes.json();\n        //console.log('Trim Series ë°ì´í„° ë¡œë“œ ì„±ê³µ:', trimSeriesData.length);\n      } catch (e) {\n        console.error('Trim Series ë°ì´í„° íŒŒì‹± ì‹¤íŒ¨:', e);\n      }\n\n      try {\n        trimPortSizeData = await trimPortSizeRes.json();\n        //console.log('Trim Port Size ë°ì´í„° ë¡œë“œ ì„±ê³µ:', trimPortSizeData.length);\n      } catch (e) {\n        console.error('Trim Port Size ë°ì´í„° íŒŒì‹± ì‹¤íŒ¨:', e);\n      }\n\n      try {\n        trimFormData = await trimFormRes.json();\n        //console.log('Trim Form ë°ì´í„° ë¡œë“œ ì„±ê³µ:', trimFormData.length);\n      } catch (e) {\n        console.error('Trim Form ë°ì´í„° íŒŒì‹± ì‹¤íŒ¨:', e);\n      }\n\n      try {\n        actTypeData = await actTypeRes.json();\n        //console.log('Act Type ë°ì´í„° ë¡œë“œ ì„±ê³µ:', actTypeData.length);\n      } catch (e) {\n        console.error('Act Type ë°ì´í„° íŒŒì‹± ì‹¤íŒ¨:', e);\n      }\n\n      try {\n        actSeriesData = await actSeriesRes.json();\n        //console.log('Act Series ë°ì´í„° ë¡œë“œ ì„±ê³µ:', actSeriesData.length);\n      } catch (e) {\n        console.error('Act Series ë°ì´í„° íŒŒì‹± ì‹¤íŒ¨:', e);\n      }\n\n      try {\n        actHWData = await actHWRes.json();\n        //console.log('Act HW ë°ì´í„° ë¡œë“œ ì„±ê³µ:', actHWData.length);\n      } catch (e) {\n        console.error('Act HW ë°ì´í„° íŒŒì‹± ì‹¤íŒ¨:', e);\n      }\n\n\n\n      // ì•…ì„¸ì‚¬ë¦¬ ë°ì´í„° ë¡œë”©ì€ ë³„ë„ í•¨ìˆ˜ë¡œ ë¶„ë¦¬í•˜ì—¬ ìž¬ì‹œë„ ê°€ëŠ¥í•˜ë„ë¡ í•¨\n      await fetchAccessoryData();\n\n\n\n      setBodyBonnetList(bodyBonnetData || []);\n      setBodyConnectionList(bodyConnectionData || []);\n      setTrimTypeList(trimTypeData || []);\n      setTrimSeriesList(trimSeriesData || []);\n      setTrimPortSizeList(trimPortSizeData || []);\n      setTrimFormList(trimFormData || []);\n      setActTypeList(actTypeData || []);\n      setActSeriesList(actSeriesData || []);\n      setActHWList(actHWData || []);\n\n    } catch (error) {\n      console.error('ë§ˆìŠ¤í„° ë°ì´í„° ê°€ì ¸ì˜¤ê¸° ì‹¤íŒ¨:', error);\n      \n      // ê°œë³„ API ì‘ë‹µ ìƒíƒœ í™•ì¸ì„ ìœ„í•œ ë¡œê¹… ì¶”ê°€\n      //console.log('ë§ˆìŠ¤í„° ë°ì´í„° ë¡œë”© ìƒíƒœ:');\n      //console.log('- Body Size:', bodySizeList.length);\n      //console.log('- Body Material:', bodyMatList.length);\n      //console.log('- Trim Material:', trimMatList.length);\n      //\n      \n      // ì—ëŸ¬ ë°œìƒ ì‹œ ë¹ˆ ë°°ì—´ë¡œ ì„¤ì •\n      setBodySizeList([]);\n      setBodyMatList([]);\n      setTrimMatList([]);\n      setTrimOptionList([]);\n      setBodyRatingList([]);\n      setBodyBonnetList([]);\n      setBodyConnectionList([]);\n      setTrimTypeList([]);\n      setTrimSeriesList([]);\n      setTrimPortSizeList([]);\n      setTrimFormList([]);\n      setActTypeList([]);\n      setActSeriesList([]);\n      setActHWList([]);\n      setAccMakerList([]);\n      setAccModelList([]);\n    }\n  };\n\n  // í’ˆë²ˆ ìƒì„± í•¨ìˆ˜ - ì„¹ì…˜ë³„ë¡œ êµ¬ë¶„\n  const generatePartNumber = useCallback(() => {\n    try {\n      // BODY ì„¹ì…˜ (6ìžë¦¬) - ì½”ë“œ ì‚¬ìš©\n      const bodySection = [\n        bodySelections.bonnetTypeCode || '0',\n        '2', // valveSeries ê¸°ë³¸ê°’\n        bodySelections.materialBodyCode || '0',\n        bodySelections.sizeBodyCode || '0',\n        bodySelections.ratingCode || '0',\n        bodySelections.connectionCode || '0'\n      ].join('');\n      \n      // TRIM ì„¹ì…˜ (6ìžë¦¬) - ì½”ë“œ ì‚¬ìš©\n      const trimSection = [\n        trimSelections.trimTypeCode || '0',\n        trimSelections.trimSeriesCode || '0',\n        trimSelections.materialTrimCode || '0',\n        trimSelections.sizePortCode || '0',\n        trimSelections.sizePortCode || '0', // ì¤‘ë³µ\n        trimSelections.formCode || '0'\n      ].join('');\n      \n      // ACT ì„¹ì…˜ (4ìžë¦¬) - ì½”ë“œ ì‚¬ìš©\n      const actSection = [\n        actSelections.actionType || '0',\n        actSelections.series || '0',\n        actSelections.size || '0',\n        actSelections.hw || '0'\n      ].join('');\n      \n      // ACC ì„¹ì…˜ (11ìžë¦¬)\n      const accSection = [\n        accSelections.positioner.makerCode || '0',\n        accSelections.positioner.modelCode || '0',\n        accSelections.solenoid.makerCode || '0',\n        accSelections.solenoid.modelCode || '0',\n        accSelections.limiter.makerCode || '0',\n        accSelections.limiter.modelCode || '0',\n        accSelections.airSupply.modelCode || '0',\n        accSelections.volumeBooster.modelCode || '0',\n        accSelections.airOperator.modelCode || '0',\n        accSelections.lockUp.modelCode || '0',\n        accSelections.snapActingRelay.modelCode || '0'\n      ].join('');\n      \n      // ì„¹ì…˜ì„ '-'ë¡œ êµ¬ë¶„í•˜ì—¬ ë°˜í™˜\n      return `${bodySection}-${trimSection}-${actSection}-${accSection}`;\n      \n    } catch (error) {\n      console.error('í’ˆë²ˆ ìƒì„± ì¤‘ ì˜¤ë¥˜:', error);\n      return '000000-000000-0000-00000000000';\n    }\n  }, [bodySelections, trimSelections, actSelections, accSelections]);\n\n  // ê¸°ì¡´ ë°ì´í„° ë¡œë“œ\n  const loadExistingData = useCallback(async () => {\n    if (!tempEstimateNo) return;\n    \n    //console.log('í˜„ìž¬ tempEstimateNo:', tempEstimateNo); // tempEstimateNo ë¡œê·¸ ì¶”ê°€\n    \n    try {\n      // í˜„ìž¬ ë¡œê·¸ì¸í•œ ì‚¬ìš©ìž ì •ë³´ ê°€ì ¸ì˜¤ê¸°\n      const userStr = localStorage.getItem('user');\n      const currentUser = userStr ? JSON.parse(userStr) : null;\n\n      // currentUserIdëŠ” ìž„ì‹œë¡œ 'admin' ì‚¬ìš© (ì‹¤ì œë¡œëŠ” ë¡œê·¸ì¸ëœ ì‚¬ìš©ìž IDë¥¼ ì‚¬ìš©í•´ì•¼ í•¨)\n      const response = await getEstimateDetail(tempEstimateNo, currentUser?.userId || 'admin'); // ì‹¤ì œ ì‚¬ìš©ìž ID ì‚¬ìš©\n      const data = response;\n      \n      //console.log('ê²¬ì  ìƒì„¸ ë°ì´í„°:', data);\n      \n      \n      // í”„ë¡œì íŠ¸ëª… ì„¤ì •\n      if (data.estimateSheet && data.estimateSheet.project) {\n        setProjectName(data.estimateSheet.project);\n      }\n      \n      // í˜„ìž¬ ìƒíƒœ ì„¤ì • + ê²¬ì ì‹œìž‘ í† ê¸€\n      if (data.estimateSheet && data.estimateSheet.statusText) {\n        setCurrentStatus(data.estimateSheet.statusText);\n      }\n      // status === 3(ê²¬ì ì²˜ë¦¬ì¤‘) ì´ë©´ ë²„íŠ¼ì„ ë³´ë¼ìƒ‰ ìƒíƒœë¡œ í† ê¸€\n      if (data.estimateSheet && typeof data.estimateSheet.status === 'number') {\n        setQuoteStarted(data.estimateSheet.status === 3);\n      }\n      // ìš”ì•½ ì¹´ë“œ í‘œì‹œê°’ ì„¤ì •\n      const es: any = data.estimateSheet || {};\n      const tempNo: string = es.tempEstimateNo || es.TempEstimateNo || '';\n      const curNo: string | null = es.curEstimateNo ?? es.CurEstimateNo ?? null;\n      const customerName: string = es.customerName || es.CustomerName || '-';\n      const customerUserName: string = es.customerUserName || es.CustomerUserName || customerName;\n      const managerId: string = es.managerID || es.ManagerID || '-';\n      const managerName: string = es.managerName || es.ManagerName || managerId;\n\n      const parseFromTemp = (no: string): string => {\n        const m = /TEMP(\\d{4})(\\d{2})(\\d{2})/.exec(no || '');\n        return m ? `${m[1]}.${m[2]}.${m[3]}` : '-';\n      };\n      const parseFromCur = (no?: string | null): string => {\n        if (!no) return '-';\n        const m = /YA(\\d{4})(\\d{2})(\\d{2})-(\\d{3})/.exec(no);\n        return m ? `${m[1]}.${m[2]}.${m[3]}` : '-';\n      };\n\n      setSummaryEstimateNo(curNo ?? (tempNo || '-'));\n      setSummaryCompanyName(customerName);\n      setSummaryRequesterName(customerUserName); // ìš”ì²­ìž = User.Name\n      setSummaryRequestDate(parseFromTemp(tempNo));\n      setSummaryManager(managerName || managerId || '-');\n      setSummaryCompletedDate(parseFromCur(curNo));\n      \n      // ì½ê¸° ì „ìš© ìƒíƒœ ì„¤ì •\n      const isStatusThree = data.estimateSheet?.status === 3; // ìƒíƒœê°€ 3 (ê²¬ì ì²˜ë¦¬ì¤‘)ì¸ì§€\n      const isCurrentUserManager = currentUser?.userId === data.estimateSheet?.managerID; // í˜„ìž¬ ì‚¬ìš©ìžê°€ ë‹´ë‹¹ìžì¸ì§€\n      \n      const shouldBeReadOnly = !(isStatusThree && isCurrentUserManager); // ë‘˜ ë‹¤ ì°¸ì¼ ë•Œë§Œ false (ìˆ˜ì • ê°€ëŠ¥)\n      setIsReadOnly(shouldBeReadOnly);\n      //console.log('EstimateDetailPage isReadOnly ì„¤ì •ë¨:', shouldBeReadOnly);\n      //console.log('  status:', data.estimateSheet?.status, '(3ì´ë©´ ê²¬ì ì²˜ë¦¬ì¤‘)');\n      //console.log('  managerID:', data.estimateSheet?.managerID);\n      //console.log('  currentUser.userId:', currentUser?.userId);\n      \n      // EstimateRequest ë°ì´í„°ë¥¼ ê¸°ë°˜ìœ¼ë¡œ typesì™€ valves ì„¤ì •\n      if (data.estimateRequests && data.estimateRequests.length > 0) {\n        // ë””ë²„ê¹…: ì‹¤ì œ ë°ì´í„° êµ¬ì¡° í™•ì¸\n        console.log('ðŸ” EstimateDetailPage - API ì‘ë‹µ ë°ì´í„° êµ¬ì¡°:');\n        console.log('data.estimateRequests:', data.estimateRequests);\n        console.log('ì²« ë²ˆì§¸ estimateRequest:', data.estimateRequests[0]);\n        if (data.estimateRequests[0]?.tagNos) {\n          console.log('ì²« ë²ˆì§¸ tagNos:', data.estimateRequests[0].tagNos);\n          console.log('ì²« ë²ˆì§¸ tagNoì˜ í•„ë“œë“¤:', Object.keys(data.estimateRequests[0].tagNos[0] || {}));\n          console.log('ì²« ë²ˆì§¸ tagNoì˜ sheetNo:', data.estimateRequests[0].tagNos[0]?.sheetNo);\n          console.log('ì²« ë²ˆì§¸ tagNoì˜ sheetID:', data.estimateRequests[0].tagNos[0]?.sheetID);\n        }\n        // Type ì •ë³´ ì„¤ì •\n        const typeMap = new Map<string, { count: number; order: number }>();\n        \n        data.estimateRequests.forEach((req: any) => {\n          const valveType = req.valveType;\n          if (typeMap.has(valveType)) {\n            \n            typeMap.get(valveType)!.count += req.tagNos.reduce((sum: number, tag: any) => sum + tag.qty, 0);\n          } else {\n            const totalQty = req.tagNos.reduce((sum: number, tag: any) => sum + tag.qty, 0);\n            typeMap.set(valveType, { count: totalQty, order: typeMap.size + 1 });\n          }\n        });\n        \n        // typesDataë¥¼ SheetNo ê¸°ì¤€ìœ¼ë¡œ ì •ë ¬\n        const typesData = Array.from(typeMap.entries()).map(([code, info]) => {\n          // bodyValveListê°€ ë¡œë“œë˜ì§€ ì•Šì€ ê²½ìš°ë¥¼ ëŒ€ë¹„í•˜ì—¬ ê¸°ë³¸ê°’ ì„¤ì •\n          const valveInfo = bodyValveList.find(v => v.valveSeriesCode === code);\n          return {\n            id: code,\n            name: valveInfo ? valveInfo.valveSeries : `Valve Type ${code}`,\n            code: code,\n            count: info.count,\n            order: info.order\n          };\n        });\n        \n        // ë°¸ë¸Œ íƒ€ìž…ì„ SheetNo ìˆœì„œëŒ€ë¡œ ì •ë ¬\n        const sortedTypesData = typesData.sort((a, b) => {\n          // ê° ë°¸ë¸Œ íƒ€ìž…ì˜ ì²« ë²ˆì§¸ TagNoì˜ SheetNoë¥¼ ê¸°ì¤€ìœ¼ë¡œ ì •ë ¬\n          const aFirstTag = data.estimateRequests.find(req => req.valveType === a.code)?.tagNos?.[0];\n          const bFirstTag = data.estimateRequests.find(req => req.valveType === b.code)?.tagNos?.[0];\n          \n          // sheetNo ë˜ëŠ” sheetID ì‚¬ìš© (íƒ€ìž… ì•ˆì „ì„± í™•ë³´)\n          const aSheetNo = (aFirstTag as any)?.sheetNo || (aFirstTag as any)?.sheetID || 999;\n          const bSheetNo = (bFirstTag as any)?.sheetNo || (bFirstTag as any)?.sheetID || 999;\n          \n          return aSheetNo - bSheetNo;\n        });\n        \n        setTypes(sortedTypesData);\n        \n        // Valve ì •ë³´ ì„¤ì • - TagNoDetailDtoë¥¼ ê¸°ë°˜ìœ¼ë¡œ ë³€í™˜\n        const valvesData: ValveData[] = [];\n        data.estimateRequests.forEach((req: any) => {\n          req.tagNos.forEach((tag: any) => {\n            // Body Type ì´ë¦„ ê°€ì ¸ì˜¤ê¸°\n            const valveInfo = bodyValveList.find(v => v.valveSeriesCode === req.valveType);\n            const bodyTypeName = valveInfo ? valveInfo.valveSeries : `Valve Type ${req.valveType}`;\n            \n            // Rating Unit ê°€ì ¸ì˜¤ê¸° (bodyRatingListì—ì„œ ì°¾ê¸°)\n            const ratingInfo = bodyRatingList.find(r => r.ratingCode === tag.bodyRating);\n            const ratingUnit = ratingInfo ? ratingInfo.ratingUnit : '';\n            \n            valvesData.push({\n              id: `${tag.sheetID}`,\n              tagNo: tag.tagNo,\n              qty: tag.qty,\n              order: tag.sheetNo ?? tag.sheetID,\n              sheetID: tag.sheetID,\n              typeId: req.valveType,\n              fluid: {\n                medium: tag.medium || '',\n                fluid: tag.fluid || '',\n                density: tag.density || '',\n                molecular: tag.molecularWeight || '',\n                t1: { max: tag.inletTemperatureQ || 0, normal: tag.inletTemperatureNorQ || 0, min: tag.inletTemperatureMinQ || 0 },\n                p1: { max: tag.inletPressureMaxQ || 0, normal: tag.inletPressureNorQ || 0, min: tag.inletPressureMinQ || 0 },\n                p2: { max: tag.outletPressureMaxQ || 0, normal: tag.outletPressureNorQ || 0, min: tag.outletPressureMinQ || 0 },\n                dp: { max: tag.differentialPressureMaxQ || 0, normal: tag.differentialPressureNorQ || 0, min: tag.differentialPressureMinQ || 0 },\n                qm: { max: tag.qmMax || 0, normal: tag.qmNor || 0, min: tag.qmMin || 0, unit: tag.qmUnit || '' },\n                qn: { max: tag.qnMax || 0, normal: tag.qnNor || 0, min: tag.qnMin || 0, unit: tag.qnUnit || '' },\n                pressureUnit: tag.pressureUnit || '',\n                temperatureUnit: tag.temperatureUnit || ''\n              },\n              body: {\n                type: bodyTypeName, // Body Type ì´ë¦„ ì„¤ì •\n                typeCode: req.valveType || '',\n                size: tag.bodySize || '',\n                sizeUnit: tag.bodySizeUnit || '',\n                materialBody: tag.bodyMat || '',\n                materialTrim: tag.trimMat || '',\n                option: tag.trimOption || '',\n                rating: tag.bodyRating || '',\n                ratingUnit: ratingUnit // Rating Unit ì„¤ì •\n              },\n              actuator: {\n                type: tag.actType || '',\n                hw: tag.isHW ? 'Yes' : 'No'\n              },\n              accessory: {\n                positioner: { type: tag.positionerType || '', exists: tag.isPositioner || false },\n                explosionProof: tag.explosionProof || '',\n                transmitter: { type: tag.transmitterType || '', exists: !!tag.transmitterType },\n                solenoidValve: tag.isSolenoid || false,\n                limitSwitch: tag.isLimSwitch || false,\n                airSet: tag.isAirSet || false,\n                volumeBooster: tag.isVolumeBooster || false,\n                airOperatedValve: tag.isAirOperated || false,\n                lockupValve: tag.isLockUp || false,\n                snapActingRelay: tag.isSnapActingRelay || false\n              },\n              isQM: tag.isQM || false,\n              isP2: tag.isP2 || false,\n              isN1: false, // EstimateRequestDetailDtoì—ëŠ” isN1ì´ ì—†ìŒ\n              isDensity: tag.isDensity || false,\n              isHW: tag.isHW || false\n            });\n          });\n        });\n        // sheetNo ê¸°ì¤€ìœ¼ë¡œ ì˜¤ë¦„ì°¨ìˆœ ì •ë ¬\n        valvesData.sort((a, b) => a.order - b.order);\n\n        // ì •ë ¬ëœ ê²°ê³¼ë¡œ ìƒíƒœ ë°˜ì˜\n        setValves(valvesData);\n        \n\n        \n        // ì²« ë²ˆì§¸ valveë¥¼ ê¸°ë³¸ ì„ íƒ\n        // if (valvesData.length > 0) {\n        //   setSelectedValve(valvesData[0]);\n        // }\n      }\n      \n      // ê¸°íƒ€ ìš”ì²­ì‚¬í•­ ì„¤ì •\n      if (data.estimateSheet && data.estimateSheet.customerRequirement) {\n        setCustomerRequirement(data.estimateSheet.customerRequirement);\n      }\n      \n      // ê´€ë¦¬ìž ì½”ë©˜íŠ¸ ì„¤ì •\n      if (data.estimateSheet && data.estimateSheet.staffComment) {\n        setStaffComment(data.estimateSheet.staffComment);\n      }\n      \n      // ì²¨ë¶€íŒŒì¼ ì„¤ì • - ê³ ê° ìš”ì²­ê³¼ ê´€ë¦¬ ì²¨ë¶€íŒŒì¼ ë¶„ë¦¬\n      if (data.attachments && data.attachments.length > 0) {\n        const customerFiles: any[] = [];\n        const managerFiles: any[] = [];\n        \n        data.attachments.forEach((att: any) => {\n          if (att.filePath && isCustomerFile(att.filePath)) {\n            customerFiles.push(att);\n          } else if (att.filePath && isManagerFile(att.filePath)) {\n            managerFiles.push(att);\n          }\n        });\n        \n        setCustomerAttachments(customerFiles);\n        setManagerAttachments(managerFiles);\n        \n        // ê¸°ì¡´ í˜¸í™˜ì„± ìœ ì§€\n        const fileList = data.attachments.map((att: any) => ({\n          name: att.fileName || 'Unknown',\n          size: att.fileSize || 0\n        } as any));\n        setAttachments(fileList);\n      }\n      \n    } catch (error) {\n      console.error('ê¸°ì¡´ ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨:', error);\n    }\n  }, [tempEstimateNo, bodyValveList, bodyRatingList]);\n\n  // ìƒíƒœ ë³€ê²½ ì²˜ë¦¬\n  const handleStatusChange = async (newStatus: string) => {\n    try {\n      // ìƒíƒœ í…ìŠ¤íŠ¸ë¥¼ ìˆ«ìž ì½”ë“œë¡œ ë³€í™˜í•˜ëŠ” í—¬í¼ í•¨ìˆ˜\n      const getStatusCodeFromText = (statusText: string): number => {\n        switch (statusText) {\n          case 'ìž„ì‹œì €ìž¥': return 1;\n          case 'ê²¬ì ìš”ì²­': return 2;\n          case 'ê²¬ì ì²˜ë¦¬ì¤‘': return 3;\n          case 'ê²¬ì ì™„ë£Œ': return 4;\n          case 'ì£¼ë¬¸': return 5;\n          default: return -1; // ì•Œ ìˆ˜ ì—†ëŠ” ìƒíƒœ\n        }\n      };\n\n      const newStatusCode = getStatusCodeFromText(newStatus);\n      \n      // í˜„ìž¬ ì‚¬ìš©ìž ì •ë³´ì™€ ê²¬ì  ì •ë³´ ê°€ì ¸ì˜¤ê¸°\n      const userStr = localStorage.getItem('user');\n      const currentUser = userStr ? JSON.parse(userStr) : null;\n      \n      // ê²¬ì  ìƒì„¸ ì •ë³´ ê°€ì ¸ì˜¤ê¸° (isReadOnly ê³„ì‚°ì„ ìœ„í•´)\n      if (!tempEstimateNo) {\n        throw new Error('tempEstimateNoê°€ ì—†ìŠµë‹ˆë‹¤.');\n      }\n      const estimateResponse = await getEstimateDetail(tempEstimateNo, currentUser?.userId || 'admin');\n      const estimateData = estimateResponse;\n\n      // ê²¬ì ìš”ì²­ ìƒíƒœ(2)ì—ì„œë§Œ ê²¬ì ì²˜ë¦¬ì¤‘(3)ìœ¼ë¡œ ë³€ê²½ ê°€ëŠ¥\n      // if (currentStatusCode === 2 && newStatusCode === 3) {\n        // ìƒíƒœ ë³€ê²½ API í˜¸ì¶œ\n        const response = await fetch(`/api/estimate/sheets/${tempEstimateNo}/status`, { // API ê²½ë¡œ ìˆ˜ì •\n          method: 'PUT',\n          headers: {\n            'Content-Type': 'application/json',\n          },\n          body: JSON.stringify({ status: newStatusCode }), // ìˆ«ìž ìƒíƒœ ì½”ë“œë¡œ ì „ì†¡\n        });\n\n        if (response.ok) {\n          setCurrentStatus(newStatus); // UI ìƒíƒœ ì—…ë°ì´íŠ¸ (ë¬¸ìžì—´ë¡œ ìœ ì§€)\n          \n          // ìƒíƒœ ë³€ê²½ í›„ isReadOnly ìž¬ê³„ì‚°\n          const newStatusCode = getStatusCodeFromText(newStatus);\n          const isStatusThree = newStatusCode === 3; // ìƒíƒœê°€ 3 (ê²¬ì ì²˜ë¦¬ì¤‘)ì¸ì§€\n          const isCurrentUserManager = currentUser?.userId === estimateData.estimateSheet?.managerID; // í˜„ìž¬ ì‚¬ìš©ìžê°€ ë‹´ë‹¹ìžì¸ì§€\n          const shouldBeReadOnly = !(isStatusThree && isCurrentUserManager); // ë‘˜ ë‹¤ ì°¸ì¼ ë•Œë§Œ false (ìˆ˜ì • ê°€ëŠ¥)\n          setIsReadOnly(shouldBeReadOnly);\n          alert('ìƒíƒœê°€ ì„±ê³µì ìœ¼ë¡œ ë³€ê²½ë˜ì—ˆìŠµë‹ˆë‹¤.'); // ë©”ì‹œì§€ ì¼ë°˜í™”\n          // ìƒíƒœ ë³€ê²½ í›„ ìƒì„¸ ì •ë³´ë¥¼ ë‹¤ì‹œ ë¶ˆëŸ¬ì˜¤ëŠ” ë¡œì§ì´ í•„ìš”í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤.\n          // loadEstimateDetail(); // ìƒì„¸ ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” í•¨ìˆ˜ê°€ ìžˆë‹¤ë©´ í˜¸ì¶œ\n        } else {\n          // ì‘ë‹µ ë³¸ë¬¸ì„ ì½ì–´ì„œ ë” ìžì„¸í•œ ì˜¤ë¥˜ ë©”ì‹œì§€ í™•ì¸\n          const errorData = await response.json();\n          throw new Error(errorData.message || 'ìƒíƒœ ë³€ê²½ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');\n        }\n      // } else { // ì´ else ë¸”ë¡ë„ ì œê±°í•©ë‹ˆë‹¤.\n      //   alert('ê²¬ì ìš”ì²­ ìƒíƒœì—ì„œë§Œ ê²¬ì ì²˜ë¦¬ì¤‘ìœ¼ë¡œ ë³€ê²½í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤.');\n      // }\n    } catch (error: any) {\n      console.error('ìƒíƒœ ë³€ê²½ ì‹¤íŒ¨:', error.message);\n      alert(`ìƒíƒœ ë³€ê²½ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤: ${error.message}`);\n    }\n  };\n\n  // ì²¨ë¶€íŒŒì¼ ê´€ë ¨ í•¨ìˆ˜ë“¤\n  const handleDownloadFile = async (file: any, type: 'customer' | 'manager') => {\n    try {\n      if (type === 'customer' && !file.fileName.toLowerCase().endsWith('.pdf')) {\n        alert('ê³ ê°ì€ PDF íŒŒì¼ë§Œ ë‹¤ìš´ë¡œë“œí•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤.');\n        return;\n      }\n      \n      // íŒŒì¼ ë‹¤ìš´ë¡œë“œ API í˜¸ì¶œ\n              const response = await fetch(`/api/estimate/attachments/${file.attachmentID}/download`);\n      if (response.ok) {\n        const blob = await response.blob();\n        const url = window.URL.createObjectURL(blob);\n        const a = document.createElement('a');\n        a.href = url;\n        a.download = file.fileName;\n        document.body.appendChild(a);\n        a.click();\n        window.URL.revokeObjectURL(url);\n        document.body.removeChild(a);\n      } else {\n        alert('íŒŒì¼ ë‹¤ìš´ë¡œë“œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');\n      }\n    } catch (error) {\n      console.error('íŒŒì¼ ë‹¤ìš´ë¡œë“œ ì˜¤ë¥˜:', error);\n      alert('íŒŒì¼ ë‹¤ìš´ë¡œë“œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');\n    }\n  };\n\n  const handleUploadManagerFile = async (fileType: string) => {\n    const file = selectedPdfFiles[fileType];\n    if (!file) {\n      alert('ì—…ë¡œë“œí•  PDF íŒŒì¼ì„ ì„ íƒí•´ì£¼ì„¸ìš”.');\n      return;\n    }\n\n    try {\n      const formData = new FormData();\n      formData.append('file', file);\n\n      // ðŸ”‘ ì¿¼ë¦¬ íŒŒë¼ë¯¸í„°ë¡œ ì „ì†¡í•˜ë„ë¡ ìˆ˜ì •\n      const response = await fetch(`http://192.168.0.14:5135/api/estimate/sheets/${tempEstimateNo}/attachments?uploadUserID=admin&fileType=manager&managerFileType=${fileType}`, {\n        method: 'POST',\n        body: formData\n      });\n\n      if (response.ok) {\n        alert('PDF íŒŒì¼ì´ ì„±ê³µì ìœ¼ë¡œ ì—…ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤.');\n        \n        // ðŸ”‘ íŒŒì¼ ëª©ë¡ ìƒˆë¡œê³ ì¹¨ - ë” í™•ì‹¤í•˜ê²Œ ì²˜ë¦¬\n        console.log('ðŸ”„ íŒŒì¼ ì—…ë¡œë“œ ì™„ë£Œ, ëª©ë¡ ìƒˆë¡œê³ ì¹¨ ì‹œìž‘');\n        await fetchManagerFiles();\n        await fetchCustomerFiles();\n        \n        // ðŸ”‘ ì¶”ê°€ë¡œ ìž ì‹œ í›„ í•œ ë²ˆ ë” ìƒˆë¡œê³ ì¹¨ (ë°±ì—”ë“œ ì²˜ë¦¬ ì§€ì—° ê³ ë ¤)\n        setTimeout(async () => {\n          console.log('ðŸ”„ ì§€ì—° ìƒˆë¡œê³ ì¹¨ ì‹¤í–‰');\n          await fetchManagerFiles();\n          await fetchCustomerFiles();\n        }, 1000);\n        \n        // ðŸ”‘ ì—‘ì…€ íŒŒì¼ë„ í•¨ê»˜ ìƒˆë¡œê³ ì¹¨ (ë°±ì—”ë“œ êµì²´ ë¡œì§ ë¬¸ì œ í•´ê²°)\n        setTimeout(async () => {\n          console.log('ðŸ”„ ì—‘ì…€ íŒŒì¼ ìƒˆë¡œê³ ì¹¨ ì‹¤í–‰');\n          await fetchManagerFiles();\n          await fetchCustomerFiles();\n        }, 2000);\n        \n        // ì„ íƒëœ íŒŒì¼ ì´ˆê¸°í™”\n        setSelectedPdfFiles(prev => ({\n          ...prev,\n          [fileType]: null\n        }));\n        \n        // íŒŒì¼ ìž…ë ¥ ì´ˆê¸°í™” - í•´ë‹¹ IDì˜ ìž…ë ¥ë§Œ ì´ˆê¸°í™”\n        const fileInput = document.getElementById(`pdf-${fileType}`) as HTMLInputElement;\n        if (fileInput) fileInput.value = '';\n      } else {\n        const error = await response.json();\n        alert(`PDF ì—…ë¡œë“œ ì‹¤íŒ¨: ${error.message}`);\n      }\n    } catch (error) {\n      console.error('PDF ì—…ë¡œë“œ ì¤‘ ì˜¤ë¥˜:', error);\n      alert('PDF ì—…ë¡œë“œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');\n    }\n  };\n\n  // ê³ ê° ì²¨ë¶€ ë‹¤ì¤‘ ì„ íƒ\n  const handleCustomerFileSelect = async (e: React.ChangeEvent<HTMLInputElement>) => {\n    const files = Array.from(e.target.files ?? []);\n    if (files.length === 0) return;\n    setSelectedCustomerFiles(files);\n    await uploadCustomerFiles(files);\n    if (customerAddInputRef.current) customerAddInputRef.current.value = '';\n  };\n\n  // ê³ ê° ì²¨ë¶€ ë‹¤ì¤‘ ì—…ë¡œë“œ (ResultFiles/customerì— ì—…ë¡œë“œ)\n  const uploadCustomerFiles = async (files: File[]) => {\n    if (files.length === 0) {\n      alert('ì—…ë¡œë“œí•  íŒŒì¼ì„ ì„ íƒí•´ì£¼ì„¸ìš”.');\n      return;\n    }\n\n    try {\n      for (const file of files) {\n        const formData = new FormData();\n        formData.append('file', file);\n\n        // manager ì—…ë¡œë“œ + managerFileType=customer ë¡œ ì—…ë¡œë“œ â†’ ResultFiles/customerì— ì €ìž¥ë˜ë„ë¡ ë°±ì—”ë“œ ê·œì•½ ì‚¬ìš©\n        const response = await fetch(`http://192.168.0.14:5135/api/estimate/sheets/${tempEstimateNo}/attachments?uploadUserID=admin&fileType=manager&managerFileType=customer`, {\n          method: 'POST',\n          body: formData,\n        });\n\n        if (!response.ok) {\n          let msg = 'ê³ ê° íŒŒì¼ ì—…ë¡œë“œ ì‹¤íŒ¨';\n          try { const er = await response.json(); msg = er.message || msg; } catch {}\n          console.error(msg);\n        }\n      }\n\n      alert('ê³ ê° íŒŒì¼ ì—…ë¡œë“œê°€ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.');\n      await fetchCustomerFiles();\n      setSelectedCustomerFiles([]);\n    } catch (err) {\n      console.error('ê³ ê° íŒŒì¼ ì—…ë¡œë“œ ì¤‘ ì˜¤ë¥˜:', err);\n      alert('ê³ ê° íŒŒì¼ ì—…ë¡œë“œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');\n    }\n  };\n\n  const handleUploadCustomerFiles = async () => uploadCustomerFiles(selectedCustomerFiles);\n\n  const handleGenerateDatasheet = async () => {\n    try {\n      // TODO: ì‚¬ìš©ìžê°€ ë‚˜ì¤‘ì— ì œê³µí•  Datasheet ìƒì„± ë¡œì§\n      alert('Datasheet ìƒì„± ê¸°ëŠ¥ì€ ì¤€ë¹„ ì¤‘ìž…ë‹ˆë‹¤.');\n    } catch (error) {\n      console.error('Datasheet ìƒì„± ì˜¤ë¥˜:', error);\n      alert('Datasheet ìƒì„± ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');\n    }\n  };\n\n  // ì„œë¥˜ ìƒì„± í›„ ë‹¤ìš´ë¡œë“œ (í”„ë¡ íŠ¸ë§Œìœ¼ë¡œ ì²˜ë¦¬)\n  const generateAndDownload = async (type: 'cvlist'|'vllist'|'datasheet'|'singlequote', endpoint: string) => {\n    if (!tempEstimateNo) return;\n    setDocGenerating(prev => ({ ...prev, [type]: true }));\n    try {\n      // ë‹¨í’ˆ ê²¬ì ì„œ ë²„íŠ¼ í´ë¦­ ì‹œ: ë‹¨í’ˆ + ë‹¤ìˆ˜ëŸ‰ ê²¬ì ì„œë¥¼ ëª¨ë‘ ìƒì„±\n      if (type === 'singlequote') {\n        console.log('ðŸ” ê²¬ì ì„œ ìƒì„± ì‹œìž‘ - ë‹¨í’ˆ + ë‹¤ìˆ˜ëŸ‰');\n        \n        // 1) ë‹¨í’ˆê²¬ì ì„œ ìƒì„±\n        console.log('ðŸ“„ ë‹¨í’ˆê²¬ì ì„œ ìƒì„± ì¤‘...');\n        const singleQuoteResp = await fetch(`http://192.168.0.14:5135/api/estimate/sheets/${tempEstimateNo}/generate-single-quote`, { method: 'POST' });\n        if (!singleQuoteResp.ok) {\n          const er = await singleQuoteResp.json().catch(()=>({}));\n          throw new Error(`ë‹¨í’ˆê²¬ì ì„œ ìƒì„± ì‹¤íŒ¨: ${er.message || 'ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜'}`);\n        }\n        console.log('âœ… ë‹¨í’ˆê²¬ì ì„œ ìƒì„± ì™„ë£Œ');\n        \n        // 2) ë‹¤ìˆ˜ëŸ‰ê²¬ì ì„œ ìƒì„±\n        console.log('ðŸ“„ ë‹¤ìˆ˜ëŸ‰ê²¬ì ì„œ ìƒì„± ì¤‘...');\n        const multiQuoteResp = await fetch(`http://192.168.0.14:5135/api/estimate/sheets/${tempEstimateNo}/generate-multi-quote`, { method: 'POST' });\n        if (!multiQuoteResp.ok) {\n          const er = await multiQuoteResp.json().catch(()=>({}));\n          throw new Error(`ë‹¤ìˆ˜ëŸ‰ê²¬ì ì„œ ìƒì„± ì‹¤íŒ¨: ${er.message || 'ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜'}`);\n        }\n        console.log('âœ… ë‹¤ìˆ˜ëŸ‰ê²¬ì ì„œ ìƒì„± ì™„ë£Œ');\n        \n        // ìƒì„±ëœ ë‘ íŒŒì¼ ë‹¤ìš´ë¡œë“œ\n        console.log('ðŸ“¥ ìƒì„±ëœ ê²¬ì ì„œ íŒŒì¼ ë‹¤ìš´ë¡œë“œ ì¤‘...');\n        await downloadQuoteFiles();\n        alert('ê²¬ì ì„œê°€ ì„±ê³µì ìœ¼ë¡œ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤!\\n- ë‹¨í’ˆê²¬ì ì„œ\\n- ë‹¤ìˆ˜ëŸ‰ê²¬ì ì„œ');\n        return;\n      }\n      \n      // ê¸°ì¡´ ë¡œì§ (ë‹¨ì¼ íƒ€ìž… ìƒì„±: cvlist, vllist, datasheet ë“±)\n      const resp = await fetch(`http://192.168.0.14:5135/api/estimate/sheets/${tempEstimateNo}/${endpoint}`, { method: 'POST' });\n      if (!resp.ok) {\n        const er = await resp.json().catch(()=>({}));\n        throw new Error(er.message || 'ìƒì„± ì‹¤íŒ¨');\n      }\n      const pickLatest = (list: any[]) =>\n        list.filter(f => f.managerFileType === type)\n            .sort((a,b) => new Date(b.uploadDate).getTime() - new Date(a.uploadDate).getTime())[0];\n\n      // ìµœì´ˆ ì‹œë„\n      let list = await fetchManagerFiles();\n      let target = pickLatest(list);\n\n      // ìƒì„± ì§í›„ ì¸ë±ì‹± ì§€ì—° ëŒ€ë¹„ í´ë§(ìµœëŒ€ 5íšŒ, 600ms ê°„ê²©)\n      let retries = 5;\n      while (!target && retries-- > 0) {\n        await new Promise(r => setTimeout(r, 600));\n        list = await fetchManagerFiles();\n        target = pickLatest(list);\n      }\n\n      if (!target) throw new Error('ìƒì„±ëœ íŒŒì¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ìƒˆë¡œê³ ì¹¨ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.');\n      await downloadFile(target.filePath, target.fileName);\n    } catch (e: any) {\n      alert(e.message || 'ìƒì„± ì¤‘ ì˜¤ë¥˜');\n    } finally {\n      setDocGenerating(prev => ({ ...prev, [type]: false }));\n    }\n  };\n  \n  // ìƒì„±ëœ ê²¬ì ì„œ íŒŒì¼(ë‹¨í’ˆ/ë‹¤ìˆ˜ëŸ‰) ë‹¤ìš´ë¡œë“œ\n  const downloadQuoteFiles = async () => {\n    try {\n      const list = await fetchManagerFiles();\n      \n      const singleQuote = list.filter(f => f.managerFileType === 'singlequote')\n        .sort((a,b) => new Date(b.uploadDate).getTime() - new Date(a.uploadDate).getTime())[0];\n      if (singleQuote) {\n        await downloadFile(singleQuote.filePath, singleQuote.fileName);\n      }\n      \n      const multiQuote = list.filter(f => f.managerFileType === 'multiquote')\n        .sort((a,b) => new Date(b.uploadDate).getTime() - new Date(a.uploadDate).getTime())[0];\n      if (multiQuote) {\n        await downloadFile(multiQuote.filePath, multiQuote.fileName);\n      }\n      \n      console.log('âœ… ê²¬ì ì„œ íŒŒì¼ ë‹¤ìš´ë¡œë“œ ì™„ë£Œ');\n    } catch (error) {\n      console.error('ê²¬ì ì„œ íŒŒì¼ ë‹¤ìš´ë¡œë“œ ì¤‘ ì˜¤ë¥˜:', error);\n      alert('ì¼ë¶€ ê²¬ì ì„œ íŒŒì¼ ë‹¤ìš´ë¡œë“œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');\n    }\n  };\n  \n  // ê²¬ì  ì„¸ë¶€ ì •ë³´ ë¯¸ë‹ˆ ì¹´ë“œ\n  const EstimateSummaryCard = () => {\n    const totalQty = (valves || []).reduce((sum, v:any) => sum + (Number(v?.qty) || 0), 0);\n    return (\n      <div className=\"step-section-detail estimate-summary-card\">\n        <div className=\"step-header-detail\" style={{ marginBottom: 4 }}>\n          <h3>ê²¬ì  ì„¸ë¶€ ì •ë³´</h3>\n        </div>\n        <div className=\"summary-grid\">\n          <div className=\"summary-row\"><span className=\"k\">ê²¬ì ë²ˆí˜¸</span><span className=\"v\">{summaryEstimateNo}</span><span className=\"k\">ìƒíƒœ</span><span className=\"v\">{currentStatus || '-'}</span></div>\n          <div className=\"summary-row\"><span className=\"k\">íšŒì‚¬ëª…</span><span className=\"v\">{summaryCompanyName}</span><span className=\"k\">ìˆ˜ëŸ‰</span><span className=\"v\">{totalQty || '-'}</span></div>\n          <div className=\"summary-row\"><span className=\"k\">ìš”ì²­ìž</span><span className=\"v\">{summaryRequesterName}</span><span className=\"k\">ìš”ì²­ì¼ìž</span><span className=\"v\">{summaryRequestDate}</span></div>\n          <div className=\"summary-row\"><span className=\"k\">ë‹´ë‹¹ìž</span><span className=\"v\">{summaryManager}</span><span className=\"k\">ì™„ë£Œì¼ìž</span><span className=\"v\">{summaryCompletedDate}</span></div>\n        </div>\n      </div>\n    );\n  };\n\n  const handleStartQuote = async () => {\n    try {\n      const userStr = localStorage.getItem('user');\n      const currentUser = userStr ? JSON.parse(userStr) : null;\n      const currentUserId = currentUser?.userId;\n      if (!tempEstimateNo || !currentUserId) {\n        alert('ë¡œê·¸ì¸ ì •ë³´ ë˜ëŠ” ê²¬ì ë²ˆí˜¸ê°€ ì—†ìŠµë‹ˆë‹¤.');\n        return;\n      }\n      const res = await assignEstimate(tempEstimateNo, currentUserId);\n      if (res && (res.message || '').includes('ì™„ë£Œ')) {\n        // ìƒíƒœ í…ìŠ¤íŠ¸ ê°±ì‹ \n        setCurrentStatus('ê²¬ì ì²˜ë¦¬ì¤‘');\n        setQuoteStarted(true);\n        // ìƒì„¸ ì •ë³´ ìž¬ì¡°íšŒë¡œ í™”ë©´ ìµœì‹ í™”\n        await loadExistingData();\n      } else {\n        alert('ê²¬ì  ì‹œìž‘ ì²˜ë¦¬ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');\n      }\n    } catch (e) {\n      console.error(e);\n      alert('ê²¬ì  ì‹œìž‘ ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');\n    }\n  };\n\n  const handleEndQuote = () => {\n    alert('ê²¬ì  ë§ˆê°');\n  };\n\n  // ê²¬ì ì™„ë£Œ: CurEstimateNo ìƒì„± + ìƒíƒœ ë³€ê²½\n  const handleCompleteQuote = async () => {\n    if (!tempEstimateNo) return;\n    try {\n      const resp = await fetch(`http://192.168.0.14:5135/api/estimate/sheets/${tempEstimateNo}/complete`, { method: 'POST' });\n      if (!resp.ok) {\n        const er = await resp.json().catch(()=>({message:'ì²˜ë¦¬ ì‹¤íŒ¨'}));\n        alert(er.message || 'ì²˜ë¦¬ ì‹¤íŒ¨');\n        return;\n      }\n      const data = await resp.json();\n      const curNo = data.curEstimateNo as string;\n      setSummaryEstimateNo(curNo || '-');\n      setSummaryCompletedDate((() => {\n        const m = /YA(\\d{4})(\\d{2})(\\d{2})-(\\d{3})/.exec(curNo || '');\n        return m ? `${m[1]}.${m[2]}.${m[3]}` : '-';\n      })());\n      setCurrentStatus('ê²¬ì ì™„ë£Œ');\n    } catch (e) {\n      alert('ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜');\n    }\n  };\n\n  // ì™„ë£Œ ì·¨ì†Œ(ì§„í–‰ì¤‘ìœ¼ë¡œ ë˜ëŒë¦¬ê¸°)\n  const handleCancelComplete = async () => {\n    if (!tempEstimateNo) return;\n    try {\n      const resp = await fetch(`http://192.168.0.14:5135/api/estimate/sheets/${tempEstimateNo}/complete/cancel`, { method: 'POST' });\n      if (!resp.ok) throw new Error('ì™„ë£Œì·¨ì†Œ ì‹¤íŒ¨');\n      setCurrentStatus('ê²¬ì ì²˜ë¦¬ì¤‘');\n    } catch (e) {\n      alert('ì™„ë£Œì·¨ì†Œ ì¤‘ ì˜¤ë¥˜');\n    }\n  };\n\n  // ì£¼ë¬¸ í™•ì •\n  const handleConfirmOrder = async () => {\n    if (!tempEstimateNo) return;\n    try {\n      const resp = await fetch(`http://192.168.0.14:5135/api/estimate/sheets/${tempEstimateNo}/order/confirm`, { method: 'POST' });\n      if (!resp.ok) throw new Error('ì£¼ë¬¸í™•ì • ì‹¤íŒ¨');\n      setCurrentStatus('ì£¼ë¬¸');\n    } catch (e) {\n      alert('ì£¼ë¬¸í™•ì • ì¤‘ ì˜¤ë¥˜');\n    }\n  };\n\n  const handleGenerateFile = async (managerFileType: string) => {\n    try {\n      let apiEndpoint = '';\n      let fileTypeName = '';\n      \n      switch (managerFileType) {\n        case 'cvlist':\n          apiEndpoint = `http://192.168.0.14:5135/api/estimate/sheets/${tempEstimateNo}/generate-cv`;\n          fileTypeName = 'CV ë¦¬ìŠ¤íŠ¸';\n          break;\n        case 'vllist':\n          apiEndpoint = `http://192.168.0.14:5135/api/estimate/sheets/${tempEstimateNo}/generate-vl`;\n          fileTypeName = 'VL ë¦¬ìŠ¤íŠ¸';\n          break;\n        case 'datasheet':\n          apiEndpoint = `http://192.168.0.14:5135/api/estimate/sheets/${tempEstimateNo}/generate-datasheet`;\n          fileTypeName = 'DataSheet';\n          break;\n        case 'singlequote':\n          apiEndpoint = `http://192.168.0.14:5135/api/estimate/sheets/${tempEstimateNo}/generate-single-quote`;\n          fileTypeName = 'ë‹¨í’ˆê²¬ì ì„œ';\n          break;\n        case 'multiquote':\n          apiEndpoint = `http://192.168.0.14:5135/api/estimate/sheets/${tempEstimateNo}/generate-multi-quote`;\n          fileTypeName = 'ë‹¤ìˆ˜ëŸ‰ê²¬ì ì„œ';\n          break;\n        default:\n          alert('ì§€ì›í•˜ì§€ ì•ŠëŠ” íŒŒì¼ íƒ€ìž…ìž…ë‹ˆë‹¤.');\n          return;\n      }\n      \n      console.log(`${fileTypeName} ìƒì„± ì‹œìž‘:`, tempEstimateNo);\n      \n      const response = await fetch(apiEndpoint, {\n        method: 'POST'\n      });\n      \n      if (response.ok) {\n        const result = await response.json();\n        alert(`${fileTypeName}ê°€ ì„±ê³µì ìœ¼ë¡œ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤!\\n\\nìƒì„±ëœ íŒŒì¼:\\n${result.fileName}`);\n        console.log(`${fileTypeName} ìƒì„± ì„±ê³µ:`, result);\n        \n        // ðŸ”‘ íŒŒì¼ ìƒì„± ì™„ë£Œ í›„ ìžë™ ìƒˆë¡œê³ ì¹¨ ì¶”ê°€\n        await fetchManagerFiles();\n        await fetchCustomerFiles();\n        \n        // ê¸°ì¡´ ì²¨ë¶€íŒŒì¼ ëª©ë¡ë„ ìƒˆë¡œê³ ì¹¨\n        loadExistingData();\n      } else {\n        const error = await response.json();\n        alert(`${fileTypeName} ìƒì„± ì‹¤íŒ¨: ${error.message}`);\n        console.error(`${fileTypeName} ìƒì„± ì‹¤íŒ¨:`, error);\n      }\n    } catch (error) {\n      console.error('íŒŒì¼ ìƒì„± ì˜¤ë¥˜:', error);\n      alert('íŒŒì¼ ìƒì„± ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');\n    }\n  };\n  // ì„ íƒê°’ì´ ë°”ë€” ë•Œë§ˆë‹¤ í˜„ìž¬ íƒœê·¸(sheetID)ë¡œ ìž„ì‹œ ì €ìž¥\nuseEffect(() => {\n  if (!selectedValve) return;\n  setTempSelections(prev => ({\n    ...prev,\n    [selectedValve.sheetID]: {\n      body: { ...bodySelections },\n      trim: { ...trimSelections },\n      act:  { ...actSelections },\n      acc:  { ...accSelections },\n    }\n  }));\n}, [selectedValve?.sheetID, bodySelections, trimSelections, actSelections, accSelections]);\n\n  useEffect(() => {\n    if (!selectedValve) return;\n    const dto = {\n      valveId: selectedValve?.body?.typeCode || '',\n      body: {\n        bonnetType: bodySelections.bonnetType || '',\n        materialBody: bodySelections.materialBody || '',\n        rating: bodySelections.ratingCode || '',\n        ratingUnit: bodySelections.ratingUnitCode || '',\n        connection: bodySelections.connection || '',\n        sizeUnit: bodySelections.sizeBodyUnitCode || '',\n        size: bodySelections.sizeBodyCode || ''\n      },\n      trim: {\n        type: trimSelections.trimType || '',\n        series: trimSelections.trimSeries || '',\n        portSize: trimSelections.sizePortCode || '',\n        portSizeUnit: trimSelections.sizePortUnitCode || '',\n        form: trimSelections.form || '',\n        materialTrim: trimSelections.materialTrim || '',\n        option: trimSelections.option || ''\n      },\n      actuator: {\n        type: actSelections.actionType || '',\n        series: actSelections.series || '',\n        size: actSelections.size || '',\n        hw: actSelections.hw || ''\n      },\n      accessories: {\n        PosCode: accSelections.positioner?.modelCode || null,\n        PosMakerCode: accSelections.positioner?.makerCode || null,\n        SolCode: accSelections.solenoid?.modelCode || null,\n        SolMakerCode: accSelections.solenoid?.makerCode || null,\n        LimCode: accSelections.limiter?.modelCode || null,\n        LimMakerCode: accSelections.limiter?.makerCode || null,\n        ASCode: accSelections.airSupply?.modelCode || null,\n        ASMakerCode: accSelections.airSupply?.makerCode || null,\n        VolCode: accSelections.volumeBooster?.modelCode || null,\n        VolMakerCode: accSelections.volumeBooster?.makerCode || null,\n        AirOpCode: accSelections.airOperator?.modelCode || null,\n        AirOpMakerCode: accSelections.airOperator?.makerCode || null,\n        LockupCode: accSelections.lockUp?.modelCode || null,\n        LockupMakerCode: accSelections.lockUp?.makerCode || null,\n        SnapActCode: accSelections.snapActingRelay?.modelCode || null,\n        SnapActMakerCode: accSelections.snapActingRelay?.makerCode || null,\n      }\n    };\n    setSpecBySheetId(prev => ({ ...prev, [selectedValve.sheetID]: dto }));\n  }, [selectedValve?.sheetID, bodySelections, trimSelections, actSelections, accSelections]);\n\n  const handleDeleteManagerFile = async (file: any) => {\n    try {\n      if (window.confirm('ì •ë§ë¡œ ì´ íŒŒì¼ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {\n        const response = await fetch(`/api/estimate/attachments/${file.attachmentID}`, {\n          method: 'DELETE'\n        });\n        \n        if (response.ok) {\n          alert('íŒŒì¼ì´ ì„±ê³µì ìœ¼ë¡œ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.');\n          loadExistingData(); // ì²¨ë¶€íŒŒì¼ ëª©ë¡ ìƒˆë¡œê³ ì¹¨\n        } else {\n          alert('íŒŒì¼ ì‚­ì œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');\n        }\n      }\n    } catch (error) {\n      console.error('íŒŒì¼ ì‚­ì œ ì˜¤ë¥˜:', error);\n      alert('íŒŒì¼ ì‚­ì œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');\n    }\n  };\n\n  // ì‚¬ì–‘ ì €ìž¥ í•¨ìˆ˜\n  // íƒœê·¸ë³„ ì„œë¡œ ë‹¤ë¥¸ ìž…ë ¥ì„ ìˆ˜ì§‘í•˜ê¸° ìœ„í•œ ìƒíƒœ\n  const [specBySheetId, setSpecBySheetId] = useState<Record<number, any>>({});\n\n  // selectedValve, bodySelections, trimSelections, actSelections, accSelections ë³€ê²½ ì‹œ ì €ìž¥\nuseEffect(() => {\n  if (!selectedValve) return;\n  const dto = buildSaveSpecFromSelections({\n    body: bodySelections,\n    trim: trimSelections,\n    act: actSelections,\n    acc: accSelections,\n    valveTypeCode: selectedValve?.body?.typeCode || ''\n  });\n  setSpecBySheetId(prev => ({ ...prev, [selectedValve.sheetID]: dto }));\n}, [selectedValve?.sheetID, bodySelections, trimSelections, actSelections, accSelections]);\n\nconst handleSaveValveOrder = async () => {\n  const sheetIDs = valves.map(v => v.sheetID);           // í˜„ìž¬ í™”ë©´ ìˆœì„œëŒ€ë¡œ\n  const resp = await fetch(`http://192.168.0.14:5135/api/estimate/sheets/${tempEstimateNo}/requests/order`, {\n    method: 'PUT',\n    headers: { 'Content-Type': 'application/json' },\n    body: JSON.stringify(sheetIDs)\n  });\n  if (resp.ok) {\n    // ë¡œì»¬ ë³´ê¸°ìš© sheetNo ì‹±í¬\n    setValves(prev => prev.map((v, i) => ({ ...v, sheetNo: i + 1 })));\n    alert('ìˆœì„œê°€ ì €ìž¥ë˜ì—ˆìŠµë‹ˆë‹¤.');\n  } else {\n    alert('ìˆœì„œ ì €ìž¥ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');\n  }\n};\n\n// ìˆœì„œ ì €ìž¥: í™”ë©´ì˜ valves ìˆœì„œë¥¼ SheetNoë¡œ ë°˜ì˜\nconst saveValveOrder = async () => {\n  if (!tempEstimateNo) return;\n  const sheetIDs = valves.map(v => v.sheetID); // ì „ì²´ ëª©ë¡ì˜ í˜„ìž¬ ìˆœì„œ\n  await fetch(`http://192.168.0.14:5135/api/estimate/sheets/${tempEstimateNo}/requests/order`, {\n    method: 'PUT',\n    headers: { 'Content-Type': 'application/json' },\n    body: JSON.stringify(sheetIDs),\n  });\n};\nconst handleSaveSpecification = useCallback(async () => {\n  try {\n    // 0) ìˆœì„œ ë¨¼ì € ì €ìž¥ â†’ SheetNo DB ë°˜ì˜\n    await saveValveOrder();\n\n    // 1) ì¼ê´„ ì €ìž¥ ëŒ€ìƒ ê²°ì •(ì „ì²´)\n    const template = buildSaveSpecFromSelections({\n      body: bodySelections, trim: trimSelections, act: actSelections, acc: accSelections,\n      valveTypeCode: selectedValve?.body?.typeCode || ''\n    });\n    const items = valves.map(v => ({\n      sheetID: v.sheetID,\n      specification: specBySheetId[v.sheetID]\n        ?? (tempSelections[v.sheetID]\n            ? buildSaveSpecFromSelections({\n                body: tempSelections[v.sheetID].body,\n                trim: tempSelections[v.sheetID].trim,\n                act:  tempSelections[v.sheetID].act,\n                acc:  tempSelections[v.sheetID].acc\n              })\n            : template)\n    }));\n\n    // 2) ì¼ê´„ ì‚¬ì–‘ ì €ìž¥\n    const resp = await fetch(`http://192.168.0.14:5135/api/estimate/sheets/${tempEstimateNo}/specification/bulk`, {\n      method: 'POST',\n      headers: { 'Content-Type': 'application/json' },\n      body: JSON.stringify({ items })\n    });\n\n    if (resp.ok) alert('ëª¨ë“  íƒœê·¸ì— ì‚¬ì–‘ì´ ì¼ê´„ ì €ìž¥ë˜ì—ˆìŠµë‹ˆë‹¤.');\n    else alert('ì‚¬ì–‘ ì¼ê´„ ì €ìž¥ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');\n  } catch (e) {\n    console.error(e);\n    alert('ì‚¬ì–‘ ì¼ê´„ ì €ìž¥ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');\n  }\n  // ì˜ì¡´ì„±: valves, specBySheetId, tempSelections, bodySelections, trimSelections, actSelections, accSelections, selectedValve, tempEstimateNo\n}, [valves, specBySheetId, tempSelections, bodySelections, trimSelections, actSelections, accSelections, selectedValve, tempEstimateNo]);\n\n  const AccessorySelector: React.FC<AccessorySelectorProps> = ({\n    accTypeKey,\n    typeCode,\n    currentAcc,\n    accMakerList,\n    accModelList,\n    onAccessoryChange,\n    isReadOnly,\n  }) => {\n    const [makerSearchTerm, setMakerSearchTerm] = useState('');\n    const [modelSearchTerm, setModelSearchTerm] = useState('');\n    const [specSearchTerm, setSpecSearchTerm] = useState('');\n    const [isDropdownOpen, setIsDropdownOpen] = useState(false);\n    const [isSelected, setIsSelected] = useState(false); // ì„ íƒ ì—¬ë¶€ ìƒíƒœ ì¶”ê°€\n    const dropdownRef = useRef<HTMLDivElement>(null);\n\n    // ì»´í¬ë„ŒíŠ¸ ë§ˆìš´íŠ¸ ì‹œ ë””ë²„ê¹… ë¡œê·¸\n    useEffect(() => {\n      console.log(`ðŸ” AccessorySelector ${accTypeKey} ë§ˆìš´íŠ¸:`, {\n        accTypeKey,\n        typeCode,\n        currentAcc,\n        accMakerListLength: accMakerList.length,\n        accModelListLength: accModelList.length\n      });\n      \n      // accMakerListì™€ accModelListì˜ ë‚´ìš© í™•ì¸\n      console.log(`ðŸ” ${accTypeKey} - accMakerList ë‚´ìš©:`, accMakerList);\n      console.log(`ðŸ” ${accTypeKey} - accModelList ë‚´ìš© (íƒ€ìž…ë³„ í•„í„°ë§):`, \n        accModelList.filter(item => item.accTypeCode === typeCode)\n      );\n    }, [accTypeKey, typeCode, currentAcc, accMakerList.length, accModelList.length, accMakerList, accModelList]);\n\n    // ì»´í¬ë„ŒíŠ¸ ë§ˆìš´íŠ¸ ì‹œ ë˜ëŠ” accSelections ë³€ê²½ ì‹œ ìž…ë ¥ í•„ë“œ ì´ˆê¸°í™” ë° ì„ íƒ ìƒíƒœ ì„¤ì •\n    useEffect(() => {\n      if (currentAcc?.modelCode) {\n        const selectedMakerName = accMakerList.find(maker => \n          maker.accMakerCode === currentAcc?.makerCode && maker.accTypeCode === typeCode\n        )?.accMakerName || '';\n        const selectedModelName = accModelList.find(model => \n          model.accModelCode === currentAcc?.modelCode && model.accTypeCode === typeCode\n        )?.accModelName || '';\n        setMakerSearchTerm(selectedMakerName);\n        setModelSearchTerm(selectedModelName);\n        setSpecSearchTerm(currentAcc.specification || '');\n        setIsSelected(true); // ëª¨ë¸ì´ ì´ë¯¸ ì„ íƒë˜ì–´ ìžˆìœ¼ë©´ isSelectedë¥¼ trueë¡œ\n      } else {\n        setMakerSearchTerm('');\n        setModelSearchTerm('');\n        setSpecSearchTerm('');\n        setIsSelected(false); // ëª¨ë¸ì´ ì—†ìœ¼ë©´ isSelectedë¥¼ falseë¡œ\n      }\n    }, [currentAcc, accMakerList, accModelList, typeCode]);\n\n\n\n    // í†µí•© ê²€ìƒ‰ í•„í„°ë§ ë¡œì§\n    const filteredModels = useMemo(() => {\n      const allSearchTerms = [\n        makerSearchTerm,\n        modelSearchTerm,\n        specSearchTerm\n      ].filter(term => term);\n\n      console.log('ðŸ” AccessorySelector ë””ë²„ê¹…:');\n      console.log('  - accTypeKey:', accTypeKey);\n      console.log('  - typeCode:', typeCode);\n      console.log('  - accModelList ê¸¸ì´:', accModelList.length);\n      console.log('  - accMakerList ê¸¸ì´:', accMakerList.length);\n\n      if (allSearchTerms.length === 0) {\n        // ê²€ìƒ‰ì–´ê°€ ì—†ìœ¼ë©´ í•´ë‹¹ íƒ€ìž… ì½”ë“œì™€ ì¼ì¹˜í•˜ëŠ” ì „ì²´ ëª¨ë¸ ë°˜í™˜\n        const filtered = accModelList.filter(item => item.accTypeCode === typeCode);\n        console.log('  - í•„í„°ë§ëœ ëª¨ë¸ ìˆ˜ (ê²€ìƒ‰ì–´ ì—†ìŒ):', filtered.length);\n        console.log('  - í•„í„°ë§ëœ ëª¨ë¸ë“¤:', filtered);\n        return filtered;\n      }\n\n      const lowerCaseSearchWords = allSearchTerms.map(term => term.toLowerCase().split(' ').filter(word => word)).flat();\n\n      const filtered = accModelList.filter(item => {\n        if (!typeCode || item.accTypeCode !== typeCode) {\n          return false;\n        }\n\n        const makerName = (accMakerList.find(maker => maker.accMakerCode === item.accMakerCode && maker.accTypeCode === item.accTypeCode)?.accMakerName || '').toLowerCase();\n        const modelName = (item.accModelName || '').toLowerCase();\n        const specification = (item.accSize || '').toLowerCase();\n\n        // ëª¨ë“  ê²€ìƒ‰ ë‹¨ì–´ë¥¼ ëª¨ë“  í•„ë“œì—ì„œ AND ê²€ìƒ‰\n        return lowerCaseSearchWords.every(word =>\n          makerName.includes(word) || modelName.includes(word) || specification.includes(word)\n        );\n      });\n\n      console.log('  - í•„í„°ë§ëœ ëª¨ë¸ ìˆ˜ (ê²€ìƒ‰ì–´ ìžˆìŒ):', filtered.length);\n      console.log('  - í•„í„°ë§ëœ ëª¨ë¸ë“¤:', filtered);\n      return filtered;\n    }, [makerSearchTerm, modelSearchTerm, specSearchTerm, accModelList, accMakerList, typeCode]);\n\n    // ì•…ì„¸ì‚¬ë¦¬ ì„ íƒ í•¸ë“¤ëŸ¬\n    const handleSelectAccessory = (selectedModel: any) => {\n      onAccessoryChange({\n        ...selectedModel,\n        typeCode: selectedModel.accTypeCode,\n        makerCode: selectedModel.accMakerCode,\n        modelCode: selectedModel.accModelCode,\n        specification: selectedModel.accSize || '',\n      });\n      // ì„ íƒ ì‹œ ì„¸ ìž…ë ¥ í•„ë“œë¥¼ ì„ íƒëœ ê°’ìœ¼ë¡œ ì±„ìš°ê¸°\n      const selectedMakerName = accMakerList.find(maker => \n        maker.accMakerCode === selectedModel.accMakerCode && maker.accTypeCode === selectedModel.accTypeCode\n      )?.accMakerName || '';\n      setMakerSearchTerm(selectedMakerName);\n      setModelSearchTerm(selectedModel.accModelName || '');\n      setSpecSearchTerm(selectedModel.accSize || '');\n      setIsDropdownOpen(false);\n      setIsSelected(true); // ì„ íƒ ì™„ë£Œ ì‹œ isSelectedë¥¼ trueë¡œ\n    };\n\n    // ì„ íƒ í•´ì œ í•¸ë“¤ëŸ¬\n    const handleReset = () => {\n      onAccessoryChange({\n        ...currentAcc,\n        typeCode: typeCode || '', // ê¸°ì¡´ typeCode ìœ ì§€\n        makerCode: '',\n        modelCode: '',\n        specification: '',\n      });\n      setMakerSearchTerm('');\n      setModelSearchTerm('');\n      setSpecSearchTerm('');\n      setIsSelected(false); // ì„ íƒ í•´ì œ ì‹œ isSelectedë¥¼ falseë¡œ\n      setIsDropdownOpen(false); // ë“œë¡­ë‹¤ìš´ ë‹«ê¸°\n    };\n\n    // ì™¸ë¶€ í´ë¦­ ê°ì§€ (ë“œë¡­ë‹¤ìš´ ë‹«ê¸°)\n    useEffect(() => {\n      const handleClickOutside = (event: MouseEvent) => {\n        if (dropdownRef.current && !dropdownRef.current.contains(event.target as Node)) {\n          setIsDropdownOpen(false);\n        }\n      };\n      document.addEventListener('mousedown', handleClickOutside);\n      return () => {\n        document.removeEventListener('mousedown', handleClickOutside);\n      };\n    }, []);\n\n\n    return (\n      <div className=\"accessory-selector\" ref={dropdownRef}>\n        <div className=\"input-group-detail\">\n          <input\n            type=\"text\"\n            placeholder=\"ë©”ì´ì»¤\"\n            value={makerSearchTerm}\n            onChange={(e) => {if (!isSelected) {setMakerSearchTerm(e.target.value); setIsDropdownOpen(true);}}}\n            onFocus={() => {if (!isSelected) setIsDropdownOpen(true);}}\n            readOnly={isSelected || isReadOnly} // isReadOnly ìƒíƒœì— ë”°ë¼ ì½ê¸° ì „ìš©\n          />\n          <input\n            type=\"text\"\n            placeholder=\"ëª¨ë¸ëª…\"\n            value={modelSearchTerm}\n            onChange={(e) => {if (!isSelected) {setModelSearchTerm(e.target.value); setIsDropdownOpen(true);}}}\n            onFocus={() => {if (!isSelected) setIsDropdownOpen(true);}}\n            readOnly={isSelected || isReadOnly}\n          />\n          <input\n            type=\"text\"\n            placeholder=\"ê·œê²©\"\n            value={specSearchTerm}\n            onChange={(e) => {if (!isSelected) {setSpecSearchTerm(e.target.value); setIsDropdownOpen(true);}}}\n            onFocus={() => {if (!isSelected) setIsDropdownOpen(true);}}\n            readOnly={isSelected || isReadOnly}\n          />\n          {isSelected && (\n            <button type=\"button\" onClick={handleReset} className=\"reset-button\" disabled={isReadOnly}>ì´ˆê¸°í™”</button>\n          )}\n        </div>\n        {isDropdownOpen && (\n          <ul className=\"dropdown-list\">\n            {filteredModels.length > 0 ? (\n              filteredModels.map((item: any) => (\n                <li\n                  key={`${item.accTypeCode}-${item.accMakerCode}-${item.accModelCode}`}\n                  onClick={() => {if (!isReadOnly) handleSelectAccessory(item);}} // isReadOnlyì¼ ë•Œ í´ë¦­ ë¶ˆê°€\n                >\n                  <span className=\"dropdown-maker\">{accMakerList.find(maker => maker.accMakerCode === item.accMakerCode)?.accMakerName || ''}</span>\n                  <span className=\"dropdown-model\">{item.accModelName}</span>\n                  <span className=\"dropdown-spec\">{item.accSize || ''}</span>\n                </li>\n              ))\n            ) : ( \n              <li>ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤.</li>\n            )}\n          </ul>\n        )}\n      </div>\n    );\n  };\n  // ì´ˆê¸°í™”\n  useEffect(() => {\n    console.log('EstimateDetailPage ì´ˆê¸°í™” ì‹œìž‘');\n    fetchBodyValveList();\n    fetchMasterData();\n  }, []); // ì˜ì¡´ì„± ë°°ì—´ ë¹„ì›€ - ì´ˆê¸° ë¡œë“œë§Œ í•„ìš”\n\n  // bodyValveListì™€ bodyRatingListê°€ ë¡œë“œëœ í›„ ê¸°ì¡´ ë°ì´í„° ë¡œë“œ\n  useEffect(() => {\n    console.log('useEffect ì‹¤í–‰:', { \n      bodyValveListLength: bodyValveList.length, \n      bodyRatingListLength: bodyRatingList.length, \n      tempEstimateNo \n    });\n    if (bodyValveList.length > 0 && bodyRatingList.length > 0 && tempEstimateNo) {\n      console.log('loadExistingData í˜¸ì¶œ ì‹œìž‘');\n      loadExistingData();\n    }\n  }, [bodyValveList.length, bodyRatingList.length, tempEstimateNo]); // loadExistingData ì˜ì¡´ì„± ì œê±°\n\n  // bodyValveListê°€ ë¡œë“œëœ í›„ íƒ€ìž… ì´ë¦„ì„ ì½”ë“œâ†’ì‹œë¦¬ì¦ˆëª…ìœ¼ë¡œ ë™ê¸°í™”\n  useEffect(() => {\n    if (bodyValveList.length > 0) {\n      setTypes(prevTypes => {\n        let changed = false;\n        const next = prevTypes.map(type => {\n          const key = (type as any).code ?? (type as any).id;\n          const valveInfo = bodyValveList.find((v: any) => v.valveSeriesCode === key);\n          const newName = valveInfo ? valveInfo.valveSeries : type.name;\n          if (newName !== type.name) {\n            changed = true;\n            return { ...type, name: newName } as any;\n          }\n          return type;\n        });\n        return changed ? next : prevTypes;\n      });\n    }\n  }, [bodyValveList]);\n\n  // selectedValveê°€ ë³€ê²½ë  ë•Œë§ˆë‹¤ ê¸°ì¡´ ì‚¬ì–‘ ë°ì´í„° ë¡œë“œ\n  useEffect(() => {\n    if (selectedValve) {\n      // ì´ˆê¸° ë¡œë“œë§Œ í•„ìš”í•˜ë¯€ë¡œ ì—¬ê¸°ì„œëŠ” ì•„ë¬´ê²ƒë„ í•˜ì§€ ì•ŠìŒ\n      // handleValveSelectionì—ì„œ ì²˜ë¦¬ë¨\n    }\n  }, [selectedValve]);\n\n  // selectedTypeì´ ë³€ê²½ë˜ë©´ selectedValveë¥¼ ì´ˆê¸°í™”í•˜ì—¬ Step 3ë¥¼ ìˆ¨ê¹€\n  useEffect(() => {\n      setSelectedValve(null);\n  }, [selectedType]);\n\n  // ì´ˆê¸° ì‚¬ì–‘ ë°ì´í„° ë¡œë“œ (DBì—ì„œ ë¶ˆëŸ¬ì˜¤ê¸°)\n  const loadInitialSpecification = async (sheetID: number) => {\n    // ì´ë¯¸ ìž„ì‹œ ì €ìž¥ëœ ê°’ì´ ìžˆìœ¼ë©´ ì„œë²„ê°’ìœ¼ë¡œ ë®ì–´ì“°ì§€ ì•ŠìŒ\n  if (tempSelections[sheetID]) {\n    const saved = tempSelections[sheetID];\n    setBodySelections(saved.body || {});\n    setTrimSelections(saved.trim || {});\n    setActSelections(saved.act || {});\n    setAccSelections(saved.acc || {});\n    return;\n  }\n    \n    try {\n      if (!tempEstimateNo) {\n        console.error(\"tempEstimateNoê°€ ì—†ìŠµë‹ˆë‹¤.\");\n        return;\n      }\n      const response = await fetch(`http://192.168.0.14:5135/api/estimate/sheets/${tempEstimateNo}/specification/${sheetID}`);\n      if (response.ok) {\n        const specificationData = await response.json();\n        console.log('--- ì‹¤ì œ Accessories ë°ì´í„° êµ¬ì¡° ---', specificationData.accessories);\n        \n        if (specificationData.accessories) {\n          console.log('ê°œë³„ ì•…ì„¸ì‚¬ë¦¬ ë°ì´í„° (Positioner):', specificationData.accessories.positioner);\n          console.log('ê°œë³„ ì•…ì„¸ì‚¬ë¦¬ ë°ì´í„° (Solenoid):', specificationData.accessories.solenoid);\n          console.log('ê°œë³„ ì•…ì„¸ì‚¬ë¦¬ ë°ì´í„° (AirOperator):', specificationData.accessories.airOperator);\n          console.log('ê°œë³„ ì•…ì„¸ì‚¬ë¦¬ ë°ì´í„° (LockUp):', specificationData.accessories.lockUp);\n        }\n        \n        // Body ì‚¬ì–‘ ë°ì´í„° ì„¤ì • (ì´ˆê¸°ê°’ë§Œ) - null ì²˜ë¦¬ ê°œì„ \n        if (specificationData.body) {\n          console.log('Body ë°ì´í„°:', specificationData.body); // Body ë°ì´í„° ë¡œê·¸ ì¶”ê°€\n          setBodySelections(prev => ({\n            ...prev,\n            bonnetType: specificationData.body.bonnetTypeCode || '',\n            bonnetTypeCode: specificationData.body.bonnetTypeCode || '',\n            materialBody: specificationData.body.materialBodyCode || '',\n            materialBodyCode: specificationData.body.materialBodyCode || '',\n            sizeBodyUnit: specificationData.body.sizeUnit || '',\n            sizeBody: specificationData.body.sizeCode || '',\n            sizeBodyUnitCode: specificationData.body.sizeUnit || '', // Code ê°’ ì¶”ê°€\n            sizeBodyCode: specificationData.body.sizeCode || '', // Code ê°’ ì¶”ê°€\n            ratingUnit: (() => {\n              if (specificationData.body.ratingUnit && bodyRatingList.length > 0) {\n                const ratingItem = bodyRatingList.find(item => item.ratingUnitCode === specificationData.body.ratingUnit);\n                return ratingItem ? ratingItem.ratingUnit : '';\n              }\n              return '';\n            })(), // ratingUnitCodeì— í•´ë‹¹í•˜ëŠ” ratingUnit ì´ë¦„ ì°¾ê¸°\n            rating: specificationData.body.ratingCode || '',\n            ratingUnitCode: (() => {\n              if (specificationData.body.ratingUnit && bodyRatingList.length > 0) {\n                const ratingItem = bodyRatingList.find(item => item.ratingUnitCode === specificationData.body.ratingUnit);\n                return ratingItem ? ratingItem.ratingUnitCode : '';\n              }\n              return '';\n            })(), // ratingUnitCodeì— í•´ë‹¹í•˜ëŠ” ratingUnitCode ì°¾ê¸°\n            ratingCode: specificationData.body.ratingCode || '', // Code ê°’ ì¶”ê°€\n            connection: specificationData.body.connectionCode || '',\n            connectionCode: specificationData.body.connectionCode || ''\n          }));\n        }\n        \n        // Trim ì‚¬ì–‘ ë°ì´í„° ì„¤ì • (ì´ˆê¸°ê°’ë§Œ) - null ì²˜ë¦¬ ê°œì„ \n        if (specificationData.trim) {\n          console.log('Trim ë°ì´í„°:', specificationData.trim); // Trim ë°ì´í„° ë¡œê·¸ ì¶”ê°€\n          setTrimSelections(prev => ({\n            ...prev,\n            trimType: specificationData.trim.typeCode || '',\n            trimTypeCode: specificationData.trim.typeCode || '',\n            trimSeries: specificationData.trim.seriesCode || '',\n            trimSeriesCode: specificationData.trim.seriesCode || '',\n            materialTrim: specificationData.body?.materialTrimCode || '',\n            materialTrimCode: specificationData.body?.materialTrimCode || '',\n            sizePortUnit: specificationData.trim.portSizeUnit || '',\n            sizePort: specificationData.trim.portSizeCode || '',\n            sizePortUnitCode: specificationData.trim.portSizeUnit || '', // Code ê°’ ì¶”ê°€\n            sizePortCode: specificationData.trim.portSizeCode || '', // Code ê°’ ì¶”ê°€\n            form: specificationData.trim.formCode || '',\n            formCode: specificationData.trim.formCode || '',\n            option: specificationData.body?.optionCode || '' // Bodyì—ì„œ Option ê°’ì„ ê°€ì ¸ì˜´\n          }));\n        }\n        \n        // Actuator ì‚¬ì–‘ ë°ì´í„° ì„¤ì • (ì´ˆê¸°ê°’ë§Œ) - null ì²˜ë¦¬ ê°œì„ \n        if (specificationData.actuator) {\n          console.log('Actuator ë°ì´í„°:', specificationData.actuator); // Actuator ë°ì´í„° ë¡œê·¸ ì¶”ê°€\n          const seriesCode = specificationData.actuator.seriesCode || '';\n          setActSelections(prev => ({\n            ...prev,\n            actionType: specificationData.actuator.typeCode || '',\n            actionTypeCode: specificationData.actuator.typeCode || '',\n            series: seriesCode,\n            seriesCode: seriesCode,\n            size: specificationData.actuator.sizeCode || '',\n            sizeCode: specificationData.actuator.sizeCode || '',\n            hw: specificationData.actuator.hwCode || '',\n            hwCode: specificationData.actuator.hwCode || ''\n          }));\n\n          // Series ì½”ë“œê°€ ìžˆìœ¼ë©´ í•´ë‹¹ Size ëª©ë¡ì„ ê°€ì ¸ì˜´\n          if (seriesCode) {\n            fetchActSizeList(seriesCode);\n          }\n        }\n        \n        // Accessory ì‚¬ì–‘ ë°ì´í„° ì„¤ì • - ê¸°ì¡´ ë°ì´í„°ê°€ ìžˆìœ¼ë©´ ë¡œë“œ, ì—†ìœ¼ë©´ fetchMasterDataì—ì„œ ì´ˆê¸°í™”ë¨\n        if (specificationData.accessories) {\n          const newAccSelections = {\n            positioner: { typeCode: 'Positioner', makerCode: '', modelCode: '', specification: '' },\n            solenoid: { typeCode: 'Solenoid', makerCode: '', modelCode: '', specification: '' },\n            limiter: { typeCode: 'Limit', makerCode: '', modelCode: '', specification: '' },\n            airSupply: { typeCode: 'Airset', makerCode: '', modelCode: '', specification: '' },\n            volumeBooster: { typeCode: 'Volume', makerCode: '', modelCode: '', specification: '' },\n            airOperator: { typeCode: 'Airoperate', makerCode: '', modelCode: '', specification: '' },\n            lockUp: { typeCode: 'Lockup', makerCode: '', modelCode: '', specification: '' },\n            snapActingRelay: { typeCode: 'Snapacting', makerCode: '', modelCode: '', specification: '' },\n          };\n\n          const accKeys: Array<keyof typeof specificationData.accessories> = [\n            'positioner', 'solenoid', 'limiter', 'airSupply',\n            'volumeBooster', 'airOperator', 'lockUp', 'snapActingRelay',\n          ];\n\n          accKeys.forEach(key => {\n            const accObj = specificationData.accessories[key];\n            console.log(`ë¡œë”©ë  ì•…ì„¸ì‚¬ë¦¬ ë°ì´í„° (${String(key)}):`, accObj);\n            // 1. ë°ì´í„° ê°œìˆ˜ í™•ì¸\nconsole.log('accModelList ê¸¸ì´:', accModelList.length);\nconsole.log('accMakerList ê¸¸ì´:', accMakerList.length);\n\n// 2. Positioner ë°ì´í„° í™•ì¸\nconsole.log('Positioner ëª¨ë¸ë“¤:', accModelList.filter(item => item.accTypeCode === 'Positioner'));\nconsole.log('Positioner ë©”ì´ì»¤ë“¤:', accMakerList.filter(item => item.accTypeCode === 'Positioner'));\n\n// 3. ë°ì´í„° êµ¬ì¡° í™•ì¸\nconsole.log('ì²« ë²ˆì§¸ ëª¨ë¸:', accModelList[0]);\nconsole.log('ì²« ë²ˆì§¸ ë©”ì´ì»¤:', accMakerList[0]);\n            if (accObj && accObj.makerCode && accObj.modelCode) {\n              // ì‹¤ì œ ë°ì´í„°ê°€ ìžˆëŠ” ê²½ìš°ì—ë§Œ ì„¤ì •\n              newAccSelections[key as keyof typeof newAccSelections] = {\n                typeCode: accObj.typeCode || newAccSelections[key as keyof typeof newAccSelections].typeCode,\n                makerCode: accObj.makerCode || '',\n                modelCode: accObj.modelCode || '',\n                specification: accObj.specification || '',\n              };\n              console.log(`ìƒˆë¡œìš´ AccSelections (${String(key)}) ë°ì´í„° ì„¤ì •ë¨:`, newAccSelections[key as keyof typeof newAccSelections]);\n            }\n            // ë°ì´í„°ê°€ ì—†ìœ¼ë©´ ê¸°ë³¸ê°’ ìœ ì§€ (fetchMasterDataì—ì„œ ì„¤ì •ë¨)\n          });\n          console.log('ìµœì¢… ì—…ë°ì´íŠ¸ë  AccSelections:', newAccSelections);\n          setAccSelections(newAccSelections);\n        }\n        // ì•¡ì„¸ì„œë¦¬ ë°ì´í„°ê°€ ì—†ëŠ” ê²½ìš° fetchMasterDataì—ì„œ ì´ˆê¸°í™”ë¨\n      } else {\n        console.log('API ì‘ë‹µ ì‹¤íŒ¨:', response.status, response.statusText);\n      }\n    } catch (error) {\n      console.log('ì´ˆê¸° ì‚¬ì–‘ ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨:', error);\n    }\n  };\n  const saveOrder = async () => {\n  const sheetIDs = valves.map(v => v.sheetID);\n  const resp = await fetch(`http://192.168.0.14:5135/api/estimate/sheets/${tempEstimateNo}/requests/order`, {\n    method: 'PUT',\n    headers: { 'Content-Type': 'application/json' },\n    body: JSON.stringify(sheetIDs)\n  });\n  if (resp.ok) {\n    alert('ìˆœì„œê°€ ì €ìž¥ë˜ì—ˆìŠµë‹ˆë‹¤.');\n  } else {\n    alert('ìˆœì„œ ì €ìž¥ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');\n  }\n};\n\nconst handleDragStart = (e: React.DragEvent<HTMLDivElement>, index: number) => {\n  e.dataTransfer.setData('text/plain', String(index));\n};\nconst handleDragOver = (e: React.DragEvent<HTMLDivElement>) => { e.preventDefault(); };\nconst handleDrop = (e: React.DragEvent<HTMLDivElement>, dropIndex: number) => {\n  e.preventDefault();\n  const dragIndex = Number(e.dataTransfer.getData('text/plain'));\n  if (Number.isNaN(dragIndex)) return;\n  setValves(prev => {\n    const arr = [...prev];\n    const [moved] = arr.splice(dragIndex, 1);\n    arr.splice(dropIndex, 0, moved);\n    return arr.map((it, i) => ({ ...it, sheetNo: i + 1 }));\n  });\n};\n\n  // TagNo ë³€ê²½ ì‹œ ìž„ì‹œ ì €ìž¥ëœ ì„ íƒê°’ ë³µì›\n  const restoreTempSelections = (sheetID: number) => {\n    const tempData = tempSelections[sheetID];\n    if (tempData) {\n      console.log(`${sheetID}ì˜ ìž„ì‹œ ì €ìž¥ëœ ì„ íƒê°’ë“¤ì„ ë³µì›í•©ë‹ˆë‹¤:`, tempData);\n      \n      // Body ì„ íƒê°’ ë³µì›\n      if (tempData.body) {\n        setBodySelections(prev => ({\n          ...prev,\n          ...tempData.body\n        }));\n      }\n      \n      // Trim ì„ íƒê°’ ë³µì›\n      if (tempData.trim) {\n        setTrimSelections(prev => ({\n          ...prev,\n          ...tempData.trim\n        }));\n      }\n      \n      // Actuator ì„ íƒê°’ ë³µì›\n      if (tempData.act) {\n        setActSelections(prev => ({\n          ...prev,\n          ...tempData.act\n        }));\n      }\n      \n      // Accessory ì„ íƒê°’ ë³µì›\n      if (tempData.acc) {\n        setAccSelections(prev => ({\n          ...prev,\n          ...tempData.acc\n        }));\n      }\n    } else {\n      console.log(`${sheetID}ì˜ ìž„ì‹œ ì €ìž¥ëœ ì„ íƒê°’ì´ ì—†ìŠµë‹ˆë‹¤.`);\n    }\n  };\n\n  // Step 1, 2, 3 í†µí•© ì„¹ì…˜\n  const StepsSection = () => (\n    <div className=\"step-section-detail\">\n      <div className=\"step-header-detail\">\n        <h3>ê²¬ì  ìƒì„¸ ì •ë³´</h3>\n      </div>\n\n      <div className=\"steps-horizontal-container\">\n        <div className=\"step-col-detail\">\n          {/* Step 1: Type ì„ ì • */}\n          <div className=\"step-subsection-detail\">\n            <h4>Step 1: Type ì„ ì •</h4>\n            <div className=\"type-list-detail\">\n              {types.map((type) => (\n                <div\n                  key={type.id}\n                  className={`type-item-detail ${selectedType === type.id ? 'selected' : ''}`}\n                  onClick={() => handleTypeSelection(type)}\n                >\n                  <span className=\"type-name-detail\">{(bodyValveList.find((v: any) => v.valveSeriesCode === type.id)?.valveSeries) || type.name}</span>\n                  <span className=\"type-count\">({type.count})</span>\n                </div>\n              ))}\n            </div>\n          </div>\n        </div>\n\n        <div className=\"step-col-detail\">\n          {/* Step 2: TagNo ì„ íƒ */}\n          <div className=\"step-subsection-detail\">\n            <h4>Step 2: TagNo ì„ íƒ</h4>\n            {selectedType ? (\n              <div className=\"valve-list-detail\">\n              {valves\n                .filter((valve) => valve.typeId === selectedType)\n                .map((valve) => {\n                  const originalIndex = valves.findIndex(v => (v.sheetID ?? v.id) === (valve.sheetID ?? valve.id));\n                  return (\n                    <div\n                      key={valve.sheetID ?? valve.id}\n                      className={`valve-item-detail ${selectedValve?.id === valve.id ? 'selected' : ''}`}\n                      onClick={() => handleValveSelection(valve)}\n                    >\n                      <span className=\"valve-tag-detail\">{valve.tagNo}</span>\n                      <span className=\"valve-qty-detail\">({valve.qty})</span>\n                    </div>\n                  );\n                })}\n            </div>\n            ) : (\n              <div className=\"no-type-selected\">Step 1ì—ì„œ Typeì„ ì„ íƒí•˜ì„¸ìš”.</div>\n            )}\n          </div>\n        </div>\n        \n        {selectedValve && <div className=\"step-col-detail\">\n          {/* Step 3: ìƒì„¸ì‚¬ì–‘ ìž…ë ¥ */}\n          <div className=\"step-subsection-detail\">\n            <h4>Step 3: ìƒì„¸ì‚¬ì–‘ ìž…ë ¥</h4>\n            <div className=\"specification-grid-detail\">\n              {/* BODY ì„¹ì…˜ */}\n              <div className=\"spec-section-detail\">\n                <h4>BODY</h4>\n                <div className=\"spec-grid-detail\">\n                  <div className=\"spec-item-detail\">\n                    <label>Bonnet Type:</label>\n                    <select value={bodySelections.bonnetType} onChange={(e) => handleBodyChange('bonnetType', e.target.value)} disabled={isReadOnly}>\n                      <option value=\"\">ì„ íƒí•˜ì„¸ìš”</option>\n                      {bodyBonnetList && bodyBonnetList.length > 0 && bodyBonnetList.map((item: any) => (\n                        <option key={item.bonnetCode} value={item.bonnetCode}>\n                          {item.bonnet}\n                        </option>\n                      ))}\n                    </select>\n                  </div>\n                  <div className=\"spec-item-detail\">\n                    <label>Material Body:</label>\n                    <select value={bodySelections.materialBody} onChange={(e) => handleBodyChange('materialBody', e.target.value)} disabled={isReadOnly}>\n                      <option value=\"\">ì„ íƒí•˜ì„¸ìš”</option>\n                      {bodyMatList && bodyMatList.length > 0 && bodyMatList.map((item: any) => (\n                        <option key={item.bodyMatCode} value={item.bodyMatCode}>\n                          {item.bodyMat}\n                        </option>\n                      ))}\n                    </select>\n                  </div>\n                  <div className=\"spec-item-detail\">\n                    <label>Size Body:</label>\n                    <div className=\"size-input-group-detail\">\n                      <select value={bodySelections.sizeBodyUnitCode} onChange={(e) => {\n                        handleBodyChange('sizeBodyUnit', e.target.value);\n                        handleBodyChange('sizeBodyUnitCode', e.target.value);\n                      }} disabled={isReadOnly}>\n                        <option value=\"\">Unit ì„ íƒ</option>\n                        {bodySizeList && bodySizeList.length > 0 && \n                          bodySizeList\n                            .map(item => item.sizeUnitCode)\n                            .filter((unit, index, arr) => arr.indexOf(unit) === index)\n                            .map((unit: string) => {\n                              // Unit ì½”ë“œë¥¼ ì‚¬ìš©ìž ì¹œí™”ì ì¸ ì´ë¦„ìœ¼ë¡œ ë³€í™˜\n                              let displayName = unit;\n                              if (unit === 'A') displayName = 'DN';\n                              if (unit === 'I') displayName = 'inch';\n                              if (unit === 'N') displayName = 'None';\n                              if (unit === 'Z') displayName = 'SPECIAL';\n                              \n                              return (\n                                <option key={unit} value={unit}>\n                                  {displayName}\n                                </option>\n                              );\n                            })\n                        }\n                      </select>\n                      <select value={bodySelections.sizeBodyCode} onChange={(e) => {\n                        const selectedItem = bodySizeList.find(item => item.bodySizeCode === e.target.value);\n                        if (selectedItem) {\n                          handleBodyChange('sizeBody', selectedItem.bodySize);\n                          handleBodyChange('sizeBodyCode', selectedItem.bodySizeCode);\n                        }\n                      }} disabled={!bodySelections.sizeBodyUnit || isReadOnly}>\n                        <option value=\"\">ê°’ ì„ íƒ</option>\n                        {bodySelections.sizeBodyUnit && bodySizeList && bodySizeList.length > 0 && \n                          bodySizeList\n                            .filter(item => item.sizeUnitCode === bodySelections.sizeBodyUnit)\n                            .map((item: any) => (\n                              <option key={item.bodySizeCode} value={item.bodySizeCode}>\n                                {item.bodySize} ({item.sizeUnit})\n                              </option>\n                            ))\n                        }\n                      </select>\n                    </div>\n                  </div>\n                  <div className=\"spec-item-detail\">\n                    <label>Rating:</label>\n                    <div className=\"rating-input-group-detail\">\n                      <select value={bodySelections.ratingUnit} onChange={(e) => {\n                        const selectedUnit = bodyRatingList.find(item => item.ratingUnit === e.target.value);\n                        if (selectedUnit) {\n                          handleBodyChange('ratingUnit', selectedUnit.ratingUnit);\n                          handleBodyChange('ratingUnitCode', selectedUnit.ratingUnitCode);\n                        }\n                      }} disabled={isReadOnly}>\n                        <option value=\"\">Unit ì„ íƒ</option>\n                        {bodyRatingList && bodyRatingList.length > 0 && \n                          bodyRatingList\n                            .map(item => item.ratingUnit)\n                            .filter((unit, index, arr) => arr.indexOf(unit) === index)\n                            .map((unit: string) => (\n                              <option key={unit} value={unit}>\n                                {unit}\n                              </option>\n                            ))\n                        }\n                      </select>\n                      <select value={bodySelections.ratingCode} onChange={(e) => {\n                        const selectedItem = bodyRatingList.find(item => item.ratingCode === e.target.value);\n                        if (selectedItem) {\n                          handleBodyChange('rating', selectedItem.ratingName);\n                          handleBodyChange('ratingCode', selectedItem.ratingCode);\n                        }\n                      }} disabled={!bodySelections.ratingUnitCode || isReadOnly}>\n                        <option value=\"\">ê°’ ì„ íƒ</option>\n                        {bodySelections.ratingUnit && bodyRatingList && bodyRatingList.length > 0 && \n                          bodyRatingList\n                            .filter(item => item.ratingUnit === bodySelections.ratingUnit)\n                            .map((item: any) => (\n                              <option key={item.ratingCode} value={item.ratingCode}>\n                                {item.ratingName}\n                              </option>\n                            ))\n                        }\n                      </select>\n                    </div>\n                  </div>\n                  <div className=\"spec-item-detail\">\n                    <label>Connection:</label>\n                    <select value={bodySelections.connection} onChange={(e) => handleBodyChange('connection', e.target.value)} disabled={isReadOnly}>\n                      <option value=\"\">ì„ íƒí•˜ì„¸ìš”</option>\n                      {bodyConnectionList && bodyConnectionList.length > 0 && bodyConnectionList.map((item: any) => (\n                        <option key={item.connectionCode} value={item.connectionCode}>\n                          {item.connection}\n                        </option>\n                      ))}\n                    </select>\n                    </div>\n                </div>\n              </div>\n\n              {/* Trim ì„¹ì…˜ */}\n              <div className=\"spec-section-detail\">\n                <h4>Trim</h4>\n                <div className=\"spec-grid-detail\">\n                  <div className=\"spec-item-detail\">\n                    <label>Trim Type:</label>\n                    <select value={trimSelections.trimType} onChange={(e) => handleTrimChange('trimType', e.target.value)} disabled={isReadOnly}>\n                      <option value=\"\">ì„ íƒí•˜ì„¸ìš”</option>\n                      {trimTypeList && trimTypeList.length > 0 && trimTypeList.map((item: any) => (\n                        <option key={item.trimTypeCode} value={item.trimTypeCode}>\n                          {item.trimType}\n                        </option>\n                      ))}\n                    </select>\n                  </div>\n                  <div className=\"spec-item-detail\">\n                    <label>Trim Series:</label>\n                    <select value={trimSelections.trimSeries} onChange={(e) => handleTrimChange('trimSeries', e.target.value)} disabled={isReadOnly}>\n                      <option value=\"\">ì„ íƒí•˜ì„¸ìš”</option>\n                      {trimSeriesList && trimSeriesList.length > 0 && trimSeriesList.map((item: any) => (\n                        <option key={item.trimSeriesCode} value={item.trimSeriesCode}>\n                          {item.trimSeries}\n                        </option>\n                        ))}\n                      </select>\n                  </div>\n                  <div className=\"spec-item-detail\">\n                    <label>Material Trim:</label>\n                    <select value={trimSelections.materialTrim} onChange={(e) => handleTrimChange('materialTrim', e.target.value)} disabled={isReadOnly}>\n                      <option value=\"\">ì„ íƒí•˜ì„¸ìš”</option>\n                      {trimMatList && trimMatList.length > 0 && trimMatList.map((item: any) => (\n                        <option key={item.trimMatCode} value={item.trimMatCode}>\n                          {item.trimMat}\n                        </option>\n                      ))}\n                    </select>\n                  </div>\n                  <div className=\"spec-item-detail\">\n                    <label>Option:</label>\n                    <select value={trimSelections.option} onChange={(e) => handleTrimChange('option', e.target.value)} disabled={isReadOnly}>\n                      <option value=\"\">ì„ íƒí•˜ì„¸ìš”</option>\n                      {trimOptionList && trimOptionList.length > 0 && trimOptionList.map((item: any) => (\n                        <option key={item.trimOptionCode} value={item.trimOptionCode}>\n                          {item.trimOption}\n                        </option>\n                      ))}\n                    </select>\n                  </div>\n                  <div className=\"spec-item-detail\">\n                    <label>Size Port:</label>\n                    <div className=\"size-input-group-detail\">\n                      <select value={trimSelections.sizePortUnitCode} onChange={(e) => {\n                        handleTrimChange('sizePortUnit', e.target.value);\n                        handleTrimChange('sizePortUnitCode', e.target.value);\n                      }} disabled={isReadOnly}>\n                        <option value=\"\">Unit ì„ íƒ</option>\n                        {trimPortSizeList && trimPortSizeList.length > 0 && \n                          trimPortSizeList\n                            .map(item => ({ unitCode: item.unitCode, unitName: item.unitName }))\n                            .filter((item, index, arr) => arr.findIndex(x => x.unitCode === item.unitCode) === index)\n                            .map((item: any) => (\n                              <option key={item.unitCode} value={item.unitCode}>\n                                {item.unitName}\n                              </option>\n                            ))\n                        }\n                      </select>\n                      <select value={trimSelections.sizePortCode} onChange={(e) => {\n                        const selectedItem = trimPortSizeList.find(item => item.portSizeCode === e.target.value);\n                        if (selectedItem) {\n                          handleTrimChange('sizePort', selectedItem.portSize);\n                          handleTrimChange('sizePortCode', selectedItem.portSizeCode);\n                        }\n                      }} disabled={!trimSelections.sizePortUnit || isReadOnly}>\n                        <option value=\"\">ê°’ ì„ íƒ</option>\n                        {trimSelections.sizePortUnit && trimPortSizeList && trimPortSizeList.length > 0 && \n                          trimPortSizeList\n                            .filter(item => item.unitCode === trimSelections.sizePortUnit)\n                            .map((item: any) => (\n                                                              <option key={item.portSizeCode} value={item.portSizeCode}>\n                                  {item.portSize} ({item.unitName})\n                                </option>\n                            ))\n                        }\n                      </select>\n                    </div>\n                  </div>\n                  <div className=\"spec-item-detail\">\n                    <label>Form:</label>\n                    <select value={trimSelections.form} onChange={(e) => handleTrimChange('form', e.target.value)} disabled={isReadOnly}>\n                      <option value=\"\">ì„ íƒí•˜ì„¸ìš”</option>\n                      {trimFormList && trimFormList.length > 0 && trimFormList.map((item: any) => (\n                        <option key={item.trimFormCode} value={item.trimFormCode}>\n                          {item.trimForm}\n                        </option>\n                      ))}\n                    </select>\n                  </div>\n                </div>\n              </div>\n\n              {/* ACT ì„¹ì…˜ */}\n              <div className=\"spec-section-detail\">\n                <h4>ACT</h4>\n                <div className=\"spec-grid-detail\">\n                  <div className=\"spec-item-detail\">\n                    <label>Action Type:</label>\n                    <select value={actSelections.actionType} onChange={(e) => handleActChange('actionType', e.target.value)} disabled={isReadOnly}>\n                      <option value=\"\">ì„ íƒí•˜ì„¸ìš”</option>\n                      {actTypeList && actTypeList.length > 0 && actTypeList.map((item: any) => (\n                        <option key={item.actTypeCode} value={item.actTypeCode}>\n                          {item.actType}\n                        </option>\n                      ))}\n                    </select>\n                  </div>\n                  <div className=\"spec-item-detail\">\n                    <label>Series:</label>\n                    <select value={actSelections.series} onChange={(e) => handleActChange('series', e.target.value)} disabled={isReadOnly}>\n                      <option value=\"\">ì„ íƒí•˜ì„¸ìš”</option>\n                      {actSeriesList && actSeriesList.length > 0 && actSeriesList.map((item: any) => (\n                        <option key={item.actSeriesCode} value={item.actSeriesCode}>\n                          {item.actSeries}\n                        </option>\n                      ))}\n                    </select>\n                  </div>\n                  <div className=\"spec-item-detail\">\n                    <label>Size:</label>\n                    <select value={actSelections.size} onChange={(e) => handleActChange('size', e.target.value)} disabled={!actSelections.series || isReadOnly}>\n                      <option value=\"\">ì„ íƒí•˜ì„¸ìš”</option>\n                      {actSizeList && actSizeList.length > 0 && \n                        actSizeList.map((item: any) => (\n                          <option key={item.actSizeCode} value={item.actSizeCode}>\n                            {item.actSize} {/* actSizeName -> actSizeë¡œ ë³€ê²½ */}\n                          </option>\n                        ))\n                      }\n                    </select>\n                  </div>\n                  <div className=\"spec-item-detail\">\n                    <label>H.W:</label>\n                    <select value={actSelections.hw} onChange={(e) => handleActChange('hw', e.target.value)} disabled={isReadOnly}>\n                      <option value=\"\">ì„ íƒí•˜ì„¸ìš”</option>\n                      {actHWList && actHWList.length > 0 && actHWList.map((item: any) => (\n                        <option key={item.hwCode} value={item.hwCode}>\n                          {item.hw}\n                        </option>\n                      ))}\n                    </select>\n                  </div>\n                </div>\n              </div>\n            </div>\n\n            {/* ACC ì„¹ì…˜ - ì‚¬ì§„ê³¼ ë™ì¼í•œ 3ì—´ êµ¬ì¡°ë¡œ ë³€ê²½ */}\n            <div className=\"acc-section-detail\">\n              <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '10px' }}>\n                <h4>ACC</h4>\n                <button \n                  onClick={async () => {\n                    console.log('ì•…ì„¸ì‚¬ë¦¬ ë°ì´í„° ê°•ì œ ë¦¬ë¡œë“œ ì‹œìž‘...');\n                    const success = await fetchAccessoryData();\n                    if (success) {\n                      alert('ì•…ì„¸ì‚¬ë¦¬ ë°ì´í„°ê°€ ì„±ê³µì ìœ¼ë¡œ ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤!');\n                    } else {\n                      alert('ì•…ì„¸ì‚¬ë¦¬ ë°ì´í„° ë¡œë“œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.');\n                    }\n                  }}\n                  style={{\n                    padding: '8px 16px',\n                    backgroundColor: '#007bff',\n                    color: 'white',\n                    border: 'none',\n                    borderRadius: '4px',\n                    cursor: 'pointer',\n                    fontSize: '12px'\n                  }}\n                  title=\"ì•…ì„¸ì‚¬ë¦¬ ë°ì´í„° ê°•ì œ ë¦¬ë¡œë“œ\"\n                >\n                  ðŸ”„ ì•…ì„¸ì‚¬ë¦¬ ë¦¬ë¡œë“œ\n                </button>\n                <span style={{ fontSize: '11px', color: '#666', marginLeft: '10px' }}>\n                  ë©”ì´ì»¤: {accMakerList.length}ê°œ, ëª¨ë¸: {accModelList.length}ê°œ\n                </span>\n              </div>\n              <div className=\"acc-table-detail\">\n                <table>\n                  <thead>\n                    <tr>\n                      <th>ì„ íƒëª©ë¡</th>\n                      <th>ë©”ì´ì»¤</th>\n                      <th>ëª¨ë¸ëª…</th>\n                      <th>ê·œê²©</th>\n                    </tr>\n                  </thead>\n                  <tbody>\n                  <tr>\n                            <td>Positioner</td>\n                            <td className=\"acc-options-group-detail\" colSpan={3}>\n                              <AccessorySelector\n                                accTypeKey=\"positioner\"\n                                typeCode=\"Positioner\"\n                                currentAcc={accSelections.positioner}\n                                accMakerList={accMakerListByType.Positioner || []}\n                                accModelList={accModelListByType.Positioner || []}\n                                onAccessoryChange={(accessory) => handleAccessoryChange('positioner', accessory)}\n                                isReadOnly={isReadOnly}\n                              />\n                            </td>\n                          </tr>\n                          <tr>\n                            <td>Solenoid Valve</td>\n                            <td className=\"acc-options-group-detail\" colSpan={3}>\n                              <AccessorySelector\n                                accTypeKey=\"solenoid\"\n                                typeCode=\"Solenoid\"\n                                currentAcc={accSelections.solenoid}\n                                accMakerList={accMakerListByType.Solenoid || []}\n                                accModelList={accModelListByType.Solenoid || []}\n                                onAccessoryChange={(accessory) => handleAccessoryChange('solenoid', accessory)}\n                                isReadOnly={isReadOnly}\n                              />\n                            </td>\n                          </tr>\n                    <tr>\n                    <td>Limit Switch</td>\n                            <td className=\"acc-options-group-detail\" colSpan={3}>\n                              <AccessorySelector\n                                accTypeKey=\"limiter\"\n                                typeCode=\"Limit\"\n                                currentAcc={accSelections.limiter}\n                                accMakerList={accMakerListByType.Limit || []}\n                                accModelList={accModelListByType.Limit || []}\n                                onAccessoryChange={(accessory) => handleAccessoryChange('limiter', accessory)}\n                                isReadOnly={isReadOnly}\n                              />\n                            </td>\n                          </tr>\n                          <tr>\n                            <td>Air Set</td>\n                            <td className=\"acc-options-group-detail\" colSpan={3}>\n                              <AccessorySelector\n                                accTypeKey=\"airSupply\"\n                                typeCode=\"Airset\"\n                                currentAcc={accSelections.airSupply}\n                                accMakerList={accMakerListByType.Airset || []}\n                                accModelList={accModelListByType.Airset || []}\n                                onAccessoryChange={(accessory) => handleAccessoryChange('airSupply', accessory)}\n                                isReadOnly={isReadOnly}\n                              />\n                            </td>\n                          </tr>\n                          <tr>\n                            <td>Volume Booster</td>\n                            <td className=\"acc-options-group-detail\" colSpan={3}>\n                              <AccessorySelector\n                                accTypeKey=\"volumeBooster\"\n                                typeCode=\"Volume\"\n                                currentAcc={accSelections.volumeBooster}\n                                accMakerList={accMakerListByType.Volume || []}\n                                accModelList={accModelListByType.Volume || []}\n                                onAccessoryChange={(accessory) => handleAccessoryChange('volumeBooster', accessory)}\n                                isReadOnly={isReadOnly}\n                              />\n                            </td>\n                          </tr>\n                          <tr>\n                            <td>Air Operated Valve</td>\n                            <td className=\"acc-options-group-detail\" colSpan={3}>\n                              <AccessorySelector\n                                accTypeKey=\"airOperator\"\n                                typeCode=\"Airoperate\"\n                                currentAcc={accSelections.airOperator}\n                                accMakerList={accMakerListByType.Airoperate || []}\n                                accModelList={accModelListByType.Airoperate || []}\n                                onAccessoryChange={(accessory) => handleAccessoryChange('airOperator', accessory)}\n                                isReadOnly={isReadOnly}\n                              />\n                            </td>\n                          </tr>\n                          <tr>\n                            <td>Lock-Up Valve</td>\n                            <td className=\"acc-options-group-detail\" colSpan={3}>\n                              <AccessorySelector\n                                accTypeKey=\"lockUp\"\n                                typeCode=\"Lockup\"\n                                currentAcc={accSelections.lockUp}\n                                accMakerList={accMakerListByType.Lockup || []}\n                                accModelList={accModelListByType.Lockup || []}\n                                onAccessoryChange={(accessory) => handleAccessoryChange('lockUp', accessory)}\n                                isReadOnly={isReadOnly}\n                              />\n                            </td>\n                          </tr>\n                          <tr>\n                            <td>Snap Acting Relay</td>\n                            <td className=\"acc-options-group-detail\" colSpan={3}>\n                              <AccessorySelector\n                                accTypeKey=\"snapActingRelay\"\n                                typeCode=\"Snapacting\"\n                                currentAcc={accSelections.snapActingRelay}\n                                accMakerList={accMakerListByType.Snapacting || []}\n                                accModelList={accModelListByType.Snapacting || []}\n                                onAccessoryChange={(accessory) => handleAccessoryChange('snapActingRelay', accessory)}\n                                isReadOnly={isReadOnly}\n                              />\n                            </td>\n                          </tr>\n                  </tbody>\n                </table>\n              </div>\n            </div>\n          </div>\n        </div>}\n      </div>\n    </div>\n  );\n\n  // ê³ ê° ìš”ì²­ì‚¬í•­ ì„¹ì…˜ (í•­ìƒ readonly)\n  const CustomerRequirementSection = () => (\n    <div className=\"step-section-detail\">\n      <div className=\"step-header-detail\">\n        <h3>ê³ ê° ìš”ì²­ì‚¬í•­</h3>\n      </div>\n      <div className=\"customer-requirement-content-detail\">\n        <textarea\n          value={customerRequirement}\n          onChange={() => {}} // ë³€ê²½ ë¶ˆê°€\n          readOnly={true} // í•­ìƒ readonly\n          placeholder=\"ê³ ê° ìš”ì²­ì‚¬í•­ì´ ì—†ìŠµë‹ˆë‹¤.\"\n          className=\"customer-requirement-textarea-detail\"\n        />\n      </div>\n    </div>\n  );\n\n  // ê´€ë¦¬ìž ì½”ë©˜íŠ¸ ì„¹ì…˜\n  const StaffCommentSection = () => (\n    <div className=\"step-section-detail\">\n      <div className=\"step-header-detail\">\n        <h3>ê´€ë¦¬ìž ì½”ë©˜íŠ¸</h3>\n      </div>\n      <div className=\"staff-comment-content-detail\">\n        <textarea\n          value={staffComment}\n          onChange={(e) => !isReadOnly && setStaffComment(e.target.value)}\n          readOnly={isReadOnly}\n          placeholder=\"ê´€ë¦¬ìž ì½”ë©˜íŠ¸ê°€ ì—†ìŠµë‹ˆë‹¤.\"\n          className=\"staff-comment-textarea-detail\"\n        />\n      </div>\n    </div>\n  );\n\n  // ê³ ê° ìš”ì²­ ì²¨ë¶€íŒŒì¼ ì„¹ì…˜ (ë‹¤ìš´ë¡œë“œë§Œ ê°€ëŠ¥)\n  const CustomerAttachmentsSection = () => (\n    <div className=\"step-section-detail\">\n      <div className=\"step-header-detail\">\n        <h3>ê³ ê° ìš”ì²­ ì²¨ë¶€íŒŒì¼</h3>\n      </div>\n      <div className=\"attachments-content\">\n        {customerAttachments.length > 0 ? (\n          <div className=\"attachment-list-detail\">\n            {customerAttachments.map((file, index) => (\n              <div key={index} className=\"attachment-item-detail\">\n                <span className=\"file-name-detail\">{file.fileName}</span>\n                <span className=\"file-size-detail\">({(file.fileSize / 1024).toFixed(2)} KB)</span>\n                <button \n                  className=\"btn btn-primary btn-sm\"\n                  onClick={() => handleDownloadFile(file, 'customer')}\n                  disabled={!file.fileName.toLowerCase().endsWith('.pdf')}\n                >\n                  PDF ë‹¤ìš´ë¡œë“œ\n                </button>\n              </div>\n            ))}\n          </div>\n        ) : (\n          <div className=\"no-attachments\">\n            ê³ ê° ìš”ì²­ ì²¨ë¶€íŒŒì¼ì´ ì—†ìŠµë‹ˆë‹¤.\n          </div>\n        )}\n      </div>\n    </div>\n  );\n\n  // ê´€ë¦¬ ì²¨ë¶€íŒŒì¼ ì„¹ì…˜ (ì—…ë¡œë“œ, ë‹¤ìš´ë¡œë“œ, ìƒì„± ê°€ëŠ¥)\n  const ManagerAttachmentsSection = () => (\n    <div className=\"step-section-detail\">\n      <div className=\"step-header-detail\">\n        <h3>ê²¬ì  ì„œë¥˜ ë°œê¸‰</h3>\n      </div>\n      <div className=\"doc-issue-list\">\n        <div className=\"doc-item\">\n          <span className=\"doc-label\">CV LIST</span>\n          <button\n            className={`icon-download ${docGenerating['cvlist'] ? 'loading' : ''}`}\n            title=\"ìƒì„± í›„ ë‹¤ìš´ë¡œë“œ\"\n            onClick={() => generateAndDownload('cvlist', 'generate-cv')}\n            disabled={!!docGenerating['cvlist']}\n          >{docGenerating['cvlist'] ? 'â³' : 'â¬‡ï¸'}</button>\n        </div>\n        <div className=\"doc-item\">\n          <span className=\"doc-label\">VALVE LIST</span>\n          <button\n            className={`icon-download ${docGenerating['vllist'] ? 'loading' : ''}`}\n            title=\"ìƒì„± í›„ ë‹¤ìš´ë¡œë“œ\"\n            onClick={() => generateAndDownload('vllist', 'generate-vl')}\n            disabled={!!docGenerating['vllist']}\n          >{docGenerating['vllist'] ? 'â³' : 'â¬‡ï¸'}</button>\n        </div>\n        <div className=\"doc-item\">\n          <span className=\"doc-label\">DATA SHEET</span>\n          <button\n            className={`icon-download ${docGenerating['datasheet'] ? 'loading' : ''}`}\n            title=\"ìƒì„± í›„ ë‹¤ìš´ë¡œë“œ\"\n            onClick={() => generateAndDownload('datasheet', 'generate-datasheet')}\n            disabled={!!docGenerating['datasheet']}\n          >{docGenerating['datasheet'] ? 'â³' : 'â¬‡ï¸'}</button>\n        </div>\n        <div className=\"doc-item\">\n          <span className=\"doc-label\">ê²¬ì ì„œ</span>\n          <button\n            className={`icon-download ${docGenerating['singlequote'] ? 'loading' : ''}`}\n            title=\"ìƒì„± í›„ ë‹¤ìš´ë¡œë“œ\"\n            onClick={() => generateAndDownload('singlequote', 'generate-single-quote')}\n            disabled={!!docGenerating['singlequote']}\n          >{docGenerating['singlequote'] ? 'â³' : 'â¬‡ï¸'}</button>\n        </div>\n      </div>\n    </div>\n  );\n  useEffect(() => {\n    if (tempEstimateNo) {\n      loadExistingData();\n      // ðŸ”‘ íŒŒì¼ ëª©ë¡ ì¡°íšŒ ì¶”ê°€\n      fetchManagerFiles();\n      fetchCustomerFiles();\n    }\n  }, [tempEstimateNo, loadExistingData]); // loadExistingData ì¶”ê°€\n\n  useEffect(() => {\n    // typesì™€ accModelListê°€ ëª¨ë‘ ë¡œë“œëœ í›„ì—ë§Œ loadInitialSpecificationì„ í˜¸ì¶œ\n    if (tempEstimateNo && types.length > 0 && accModelList.length > 0) {\n      if (selectedValve && selectedValve.sheetID > 0) {\n        loadInitialSpecification(selectedValve.sheetID);\n      }\n    }\n  }, [selectedValve?.sheetID, tempEstimateNo, types, accModelList]); // typesì™€ accModelList ì¶”ê°€\n\n  // ì‹œìž‘ ì·¨ì†Œ í•¸ë“¤ëŸ¬\n  const handleCancelStart = async () => {\n    if (!tempEstimateNo) return;\n    if (window.confirm('ê²¬ì  ì‹œìž‘ì„ ì·¨ì†Œí•˜ì‹œê² ìŠµë‹ˆê¹Œ? ë‹´ë‹¹ìž ë°°ì •ì´ í•´ì œë˜ê³  \"ê²¬ì ìš”ì²­\" ìƒíƒœë¡œ ëŒì•„ê°‘ë‹ˆë‹¤.')) {\n      try {\n        const response = await fetch(`http://192.168.0.14:5135/api/estimate/sheets/${tempEstimateNo}/cancel-start`, {\n          method: 'POST',\n        });\n\n        if (response.ok) {\n          alert('ê²¬ì  ì‹œìž‘ì´ ì·¨ì†Œë˜ì—ˆìŠµë‹ˆë‹¤.');\n          setCurrentStatus('ê²¬ì ìš”ì²­');\n          loadExistingData(); // ë°ì´í„° ìƒˆë¡œê³ ì¹¨\n        } else {\n          const errorText = await response.text();\n          alert(`ì‹œìž‘ ì·¨ì†Œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤: ${errorText}`);\n        }\n      } catch (error) {\n        console.error('ì‹œìž‘ ì·¨ì†Œ ì¤‘ ì˜¤ë¥˜ ë°œìƒ:', error);\n        alert('ì‹œìž‘ ì·¨ì†Œ ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');\n      }\n    }\n  };\n\n  // ì£¼ë¬¸ ì·¨ì†Œ í•¸ë“¤ëŸ¬\n  const handleCancelOrder = async () => {\n    if (!tempEstimateNo) return;\n    if (window.confirm('ì •ë§ë¡œ ì£¼ë¬¸ì„ ì·¨ì†Œí•˜ì‹œê² ìŠµë‹ˆê¹Œ? \"ê²¬ì ì™„ë£Œ\" ìƒíƒœë¡œ ëŒì•„ê°‘ë‹ˆë‹¤.')) {\n      try {\n        const response = await fetch(`http://192.168.0.14:5135/api/estimate/sheets/${tempEstimateNo}/order/cancel`, {\n          method: 'POST',\n        });\n\n        if (response.ok) {\n          alert('ì£¼ë¬¸ì´ ì·¨ì†Œë˜ì—ˆìŠµë‹ˆë‹¤.');\n          setCurrentStatus('ê²¬ì ì™„ë£Œ');\n          loadExistingData(); // ë°ì´í„° ìƒˆë¡œê³ ì¹¨\n        } else {\n          const errorText = await response.text();\n          alert(`ì£¼ë¬¸ ì·¨ì†Œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤: ${errorText}`);\n        }\n      } catch (error) {\n        console.error('ì£¼ë¬¸ ì·¨ì†Œ ì¤‘ ì˜¤ë¥˜ ë°œìƒ:', error);\n        alert('ì£¼ë¬¸ ì·¨ì†Œ ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');\n      }\n    }\n  };\n\n  // ì•…ì„¸ì‚¬ë¦¬ ë³€ê²½ í•¸ë“¤ëŸ¬\n  const handleAccessoryChange = (accTypeKey: string, accessory: any) => {\n    setAccSelections(prev => ({\n      ...prev,\n      [accTypeKey]: accessory\n    }));\n    const sid = selectedValve?.sheetID;\n    if (sid) setAccSelectionsBySheet((prevMap: any) => ({\n      ...prevMap,\n      [sid]: { ...(prevMap?.[sid] ?? accSelections), [accTypeKey]: accessory }\n    }));\n  };\n\n  // ì•¡ì¶”ì—ì´í„° ë³€ê²½ í•¸ë“¤ëŸ¬\n\n  if (isLoadingFiles) {\n    return <div className=\"loading\">ë¡œë”© ì¤‘...</div>;\n  }\n\n  return (\n    <div className=\"estimate-detail-page dashboard-page\">\n      {/* í—¤ë” */}\n      <div className=\"page-header-detail\">\n        <button className=\"back-button-detail\" onClick={() => navigate(-1)}>\n          â† ê²¬ì ìš”ì²­\n        </button>\n        <h1>ì‚¬ì–‘ ì„ ì •</h1>\n      </div>\n\n      {/* ìƒë‹¨ ìš°ì¸¡ ë¯¸ë‹ˆ íŒ¨ë„: ê²¬ì  ì„œë¥˜ ë°œê¸‰ + ê³ ê° ì œì¶œ ë¬¸ì„œ ì—…ë¡œë“œ */}\n      <div className=\"mini-tools-panel\">\n        <EstimateSummaryCard />\n        <ManagerAttachmentsSection />\n        <div className=\"step-section-detail customer-uploader\">\n          <div className=\"uploader-header\">\n            <h3>ê³ ê° ì œì¶œ ë¬¸ì„œ ì—…ë¡œë“œ</h3>\n            <div className=\"header-actions-detail\">\n              <input\n                ref={customerAddInputRef}\n                type=\"file\"\n                multiple\n                onChange={handleCustomerFileSelect}\n                accept=\".pdf,.doc,.docx,.xls,.xlsx,.ppt,.pptx,.hwp,.txt,.zip,.rar,.7z,.csv,.json\"\n                style={{ display: 'none' }}\n              />\n              <button className=\"btn btn-light btn-xs\" onClick={() => customerAddInputRef.current?.click()}>ì¶”ê°€</button>\n            </div>\n          </div>\n          <div className=\"uploader-list\">\n            {isLoadingFiles ? (\n              <div className=\"loading\" style={{ padding: 8 }}>ë¡œë”© ì¤‘â€¦</div>\n            ) : customerFiles.length === 0 ? (\n              <div className=\"no-files\" style={{ padding: 8, color: '#6c757d' }}>ì—…ë¡œë“œëœ íŒŒì¼ì´ ì—†ìŠµë‹ˆë‹¤.</div>\n            ) : (\n              customerFiles.map(file => {\n                const name = file.fileName || '';\n                const ext = (name.split('.').pop() || '').toLowerCase();\n                return (\n                  <div key={file.attachmentID} className=\"uploader-item\">\n                    <span className={`file-icon ext-${ext}`} aria-hidden />\n                    <span className=\"file-name-detail\" title={name}>{name}</span>\n                    <button className=\"remove-btn\" onClick={() => deleteAttachmentById(file.attachmentID)}>âœ•</button>\n                  </div>\n                );\n              })\n            )}\n          </div>\n        </div>\n        {/* ê²¬ì  ì‹œìž‘/ë§ˆê° ë²„íŠ¼ ì»¬ëŸ¼ */}\n        <div className=\"quote-actions\">\n          {(() => {\n            // ëª…í™•í•œ ìƒíƒœ ê¸°ë°˜ ë¶„ê¸° ì²˜ë¦¬\n            if (currentStatus === 'ê²¬ì ìš”ì²­') {\n              return (\n                <button className=\"btn btn-success\" onClick={handleStartQuote}>ê²¬ì ì‹œìž‘</button>\n              );\n            }\n            if (currentStatus === 'ê²¬ì ì²˜ë¦¬ì¤‘') {\n              return (\n                <div className=\"button-column\">\n                  <button className=\"btn btn-primary\" onClick={handleCompleteQuote}>ê²¬ì ì™„ë£Œ</button>\n                  <button className=\"btn btn-danger\" onClick={handleCancelStart}>ì‹œìž‘ì·¨ì†Œ</button>\n                </div>\n              );\n            }\n            if (currentStatus === 'ê²¬ì ì™„ë£Œ') {\n              return (\n                <div className=\"button-column\">\n                  <button className=\"btn btn-success\" onClick={handleConfirmOrder}>ì£¼ë¬¸í™•ì •</button>\n                  <button className=\"btn btn-danger\" onClick={handleCancelComplete}>ì™„ë£Œì·¨ì†Œ</button>\n                </div>\n              );\n            }\n            if (currentStatus === 'ì£¼ë¬¸') {\n              return (\n                <button className=\"btn btn-danger\" onClick={handleCancelOrder}>ì£¼ë¬¸ì·¨ì†Œ</button>\n              );\n            }\n            // ê·¸ ì™¸ì˜ ê²½ìš° (ë¡œë”© ì¤‘ ë“±)ëŠ” ë²„íŠ¼ì„ í‘œì‹œí•˜ì§€ ì•ŠìŒ\n            return null;\n          })()}\n        </div>\n      </div>\n\n      {/* ìƒíƒœ ë° í”„ë¡œì íŠ¸ ì •ë³´ */}\n      <div className=\"status-section-detail\">\n        {/*\n        <div className=\"status-group\">\n          <label>ì§„í–‰ìƒíƒœ:</label>\n          <select \n            value={currentStatus} \n            onChange={(e) => {\n              const newStatus = e.target.value;\n              if (newStatus !== currentStatus) {\n                handleStatusChange(newStatus);\n              }\n            }}\n            className=\"status-select-detail\"\n          >\n            <option value=\"ê²¬ì ìš”ì²­\">ê²¬ì ìš”ì²­</option>\n            <option value=\"ê²¬ì ì²˜ë¦¬ì¤‘\">ê²¬ì ì²˜ë¦¬ì¤‘</option>\n            <option value=\"ê²¬ì ì™„ë£Œ\">ê²¬ì ì™„ë£Œ</option>\n            <option value=\"ì£¼ë¬¸\">ì£¼ë¬¸</option>\n          </select>\n        </div>\n        */}\n        <div className=\"project-group-detail\">\n          <label>í”„ë¡œì íŠ¸ëª…:</label>\n          <input type=\"text\" value={projectName} readOnly={isReadOnly} className=\"project-input-detail\" />\n        </div>\n        \n        {/* ì €ìž¥ ë²„íŠ¼ */}\n        <div className=\"save-section\">\n              <button \n                className=\"btn btn-primary save-specification-btn\"\n                onClick={handleSaveSpecification}\n                disabled={isReadOnly} // isReadOnly ìƒíƒœì— ë”°ë¼ ë¹„í™œì„±í™”\n              >\n                ì‚¬ì–‘ ì €ìž¥\n              </button>\n            </div>\n      </div>\n\n      {/* ë©”ì¸ ì½˜í…ì¸  */}\n      <div className=\"main-content-detail\">\n        <div className=\"steps-container-detail\">\n          <StepsSection />\n          \n          {/* ê³ ê° ìš”ì²­ ì‚¬í•­ê³¼ ì²¨ë¶€íŒŒì¼ì„ í•˜ë‚˜ì˜ ë¸”ë¡ìœ¼ë¡œ ë¬¶ìŒ */}\n          <div className=\"customer-request-block-detail\">\n            <CustomerRequirementSection />\n            <CustomerAttachmentsSection />\n          </div>\n\n          <StaffCommentSection />\n        </div>\n        \n        {/* í’ˆë²ˆ í‘œì‹œ ì„¹ì…˜ - í•œ ì¤„ ëª¨ëˆˆì¢…ì´ */}\n        <div className=\"part-number-section\">\n          <h3 className=\"text-lg font-semibold text-gray-800 mb-4\">ìƒì„±ëœ í’ˆë²ˆ</h3>\n          <div className=\"part-number-single-line\">\n            {generatePartNumber().split('').map((char: string, index: number) => (\n              <div \n                key={index}\n                className={`char-box ${char === '0' ? 'empty-char' : 'filled-char'}`}\n                title={`ìœ„ì¹˜ ${index}: ${char}`}\n              >\n                {char}\n              </div>\n            ))}\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n\n  };\n  \n  export default EstimateDetailPage;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}