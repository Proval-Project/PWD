{"ast":null,"code":"import React,{useState,useEffect}from'react';import{searchUsers}from'../api/userManagement';import'./UserSearchModal.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const CustomerSearchModal=_ref=>{let{isOpen,onClose,onSelectUser}=_ref;const[searchTerm,setSearchTerm]=useState('');const[users,setUsers]=useState([]);const[loading,setLoading]=useState(false);const[error,setError]=useState(null);const performSearch=React.useCallback(async()=>{if(!searchTerm.trim())return;try{setLoading(true);setError(null);const results=await searchUsers(searchTerm);console.log('검색 결과 (전체):',results);// 고객(roleID: 3)만 필터링\nconst filteredResults=results.filter(user=>user.roleID===3);console.log('필터링된 고객 결과:',filteredResults);setUsers(filteredResults);}catch(err){var _err$response,_err$response$data;console.error('고객 검색 실패:',err);setError(((_err$response=err.response)===null||_err$response===void 0?void 0:(_err$response$data=_err$response.data)===null||_err$response$data===void 0?void 0:_err$response$data.message)||'고객 검색에 실패했습니다.');}finally{setLoading(false);}},[searchTerm]);useEffect(()=>{if(isOpen&&searchTerm.trim()){const timeoutId=setTimeout(()=>{performSearch();},300);return()=>clearTimeout(timeoutId);}},[searchTerm,isOpen,performSearch]);const handleUserSelect=user=>{onSelectUser(user);onClose();};const handleClose=()=>{setSearchTerm('');setUsers([]);setError(null);onClose();};if(!isOpen)return null;return/*#__PURE__*/_jsx(\"div\",{className:\"modal-overlay\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"user-search-modal\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"modal-header\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"\\uACE0\\uAC1D \\uAC80\\uC0C9\"}),/*#__PURE__*/_jsx(\"button\",{className:\"close-btn\",onClick:handleClose,children:\"\\xD7\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"modal-body\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"search-input\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"\\uACE0\\uAC1D\\uC744 \\uD68C\\uC0AC\\uBA85, \\uC774\\uB984, \\uC774\\uBA54\\uC77C\\uB85C \\uAC80\\uC0C9\\uD558\\uC138\\uC694...\",value:searchTerm,onChange:e=>setSearchTerm(e.target.value)}),/*#__PURE__*/_jsx(\"button\",{className:\"search-btn\",onClick:performSearch,disabled:loading||!searchTerm.trim(),children:loading?'검색 중...':'검색'})]}),error&&/*#__PURE__*/_jsx(\"div\",{className:\"error-message\",children:error}),loading&&/*#__PURE__*/_jsx(\"div\",{className:\"loading-message\",children:\"\\uAC80\\uC0C9 \\uC911...\"}),!loading&&searchTerm&&users.length===0&&/*#__PURE__*/_jsx(\"div\",{className:\"no-results\",children:\"\\uACE0\\uAC1D \\uC911 \\uAC80\\uC0C9 \\uACB0\\uACFC\\uAC00 \\uC5C6\\uC2B5\\uB2C8\\uB2E4.\"}),!loading&&users.length>0&&/*#__PURE__*/_jsx(\"div\",{className:\"user-list\",children:users.map(user=>/*#__PURE__*/_jsxs(\"div\",{className:\"user-item\",onClick:()=>handleUserSelect(user),children:[/*#__PURE__*/_jsxs(\"div\",{className:\"user-info\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"user-name\",children:user.name}),/*#__PURE__*/_jsx(\"div\",{className:\"user-company\",children:user.companyName}),/*#__PURE__*/_jsx(\"div\",{className:\"user-email\",children:user.email})]}),/*#__PURE__*/_jsx(\"div\",{className:\"user-role\",children:user.roleID===3?'고객':'기타'})]},user.userID))})]})]})});};export default CustomerSearchModal;","map":{"version":3,"names":["React","useState","useEffect","searchUsers","jsx","_jsx","jsxs","_jsxs","CustomerSearchModal","_ref","isOpen","onClose","onSelectUser","searchTerm","setSearchTerm","users","setUsers","loading","setLoading","error","setError","performSearch","useCallback","trim","results","console","log","filteredResults","filter","user","roleID","err","_err$response","_err$response$data","response","data","message","timeoutId","setTimeout","clearTimeout","handleUserSelect","handleClose","className","children","onClick","type","placeholder","value","onChange","e","target","disabled","length","map","name","companyName","email","userID"],"sources":["/Users/simjimin/Downloads/final_develop/projec/frontend/src/components/CustomerSearchModal.tsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { searchUsers, UserListResponseDto } from '../api/userManagement';\nimport './UserSearchModal.css';\n\ninterface CustomerSearchModalProps {\n  isOpen: boolean;\n  onClose: () => void;\n  onSelectUser: (user: UserListResponseDto) => void;\n}\n\nconst CustomerSearchModal: React.FC<CustomerSearchModalProps> = ({ \n  isOpen, \n  onClose, \n  onSelectUser \n}) => {\n  const [searchTerm, setSearchTerm] = useState('');\n  const [users, setUsers] = useState<UserListResponseDto[]>([]);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n\n  const performSearch = React.useCallback(async () => {\n    if (!searchTerm.trim()) return;\n\n    try {\n      setLoading(true);\n      setError(null);\n      const results = await searchUsers(searchTerm);\n      console.log('검색 결과 (전체):', results);\n      // 고객(roleID: 3)만 필터링\n      const filteredResults = results.filter(user => user.roleID === 3);\n      console.log('필터링된 고객 결과:', filteredResults);\n      setUsers(filteredResults);\n    } catch (err: any) {\n      console.error('고객 검색 실패:', err);\n      setError(err.response?.data?.message || '고객 검색에 실패했습니다.');\n    } finally {\n      setLoading(false);\n    }\n  }, [searchTerm]);\n\n  useEffect(() => {\n    if (isOpen && searchTerm.trim()) {\n      const timeoutId = setTimeout(() => {\n        performSearch();\n      }, 300);\n\n      return () => clearTimeout(timeoutId);\n    }\n  }, [searchTerm, isOpen, performSearch]);\n\n  const handleUserSelect = (user: UserListResponseDto) => {\n    onSelectUser(user);\n    onClose();\n  };\n\n  const handleClose = () => {\n    setSearchTerm('');\n    setUsers([]);\n    setError(null);\n    onClose();\n  };\n\n  if (!isOpen) return null;\n\n  return (\n    <div className=\"modal-overlay\">\n      <div className=\"user-search-modal\">\n        <div className=\"modal-header\">\n          <h3>고객 검색</h3>\n          <button className=\"close-btn\" onClick={handleClose}>×</button>\n        </div>\n\n        <div className=\"modal-body\">\n          <div className=\"search-input\">\n            <input\n              type=\"text\"\n              placeholder=\"고객을 회사명, 이름, 이메일로 검색하세요...\"\n              value={searchTerm}\n              onChange={(e) => setSearchTerm(e.target.value)}\n            />\n            <button \n              className=\"search-btn\" \n              onClick={performSearch}\n              disabled={loading || !searchTerm.trim()}\n            >\n              {loading ? '검색 중...' : '검색'}\n            </button>\n          </div>\n\n          {error && (\n            <div className=\"error-message\">\n              {error}\n            </div>\n          )}\n\n          {loading && (\n            <div className=\"loading-message\">\n              검색 중...\n            </div>\n          )}\n\n          {!loading && searchTerm && users.length === 0 && (\n            <div className=\"no-results\">\n              고객 중 검색 결과가 없습니다.\n            </div>\n          )}\n\n          {!loading && users.length > 0 && (\n            <div className=\"user-list\">\n              {users.map(user => (\n                <div \n                  key={user.userID} \n                  className=\"user-item\"\n                  onClick={() => handleUserSelect(user)}\n                >\n                  <div className=\"user-info\">\n                    <div className=\"user-name\">{user.name}</div>\n                    <div className=\"user-company\">{user.companyName}</div>\n                    <div className=\"user-email\">{user.email}</div>\n                  </div>\n                  <div className=\"user-role\">\n                    {user.roleID === 3 ? '고객' : '기타'}\n                  </div>\n                </div>\n              ))}\n            </div>\n          )}\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default CustomerSearchModal; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}